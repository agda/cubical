<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Reflection.RecordEquiv</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-

  Reflection-based tools for converting between iterated record types, particularly between
  record types and iterated Σ-types.

  The main functions are `declareRecordIsoΣ` and `declareRecordIsoΣ`. See end of file for
  example usage.

-}</a>
<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--no-exact-split</a> <a id="275" class="Pragma">--safe</a> <a id="282" class="Symbol">#-}</a>
<a id="286" class="Keyword">module</a> <a id="293" href="Cubical.Reflection.RecordEquiv.html" class="Module">Cubical.Reflection.RecordEquiv</a> <a id="324" class="Keyword">where</a>

<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Cubical.Foundations.Isomorphism.html" class="Module">Cubical.Foundations.Isomorphism</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Cubical.Foundations.Equiv.html" class="Module">Cubical.Foundations.Equiv</a>
<a id="453" class="Keyword">open</a> <a id="458" class="Keyword">import</a> <a id="465" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a> <a id="483" class="Symbol">as</a> <a id="486" class="Module">List</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Cubical.Data.Maybe.html" class="Module">Cubical.Data.Maybe</a> <a id="551" class="Symbol">as</a> <a id="554" class="Module">Maybe</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>

<a id="592" class="Keyword">open</a> <a id="597" class="Keyword">import</a> <a id="604" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="624" class="Keyword">import</a> <a id="631" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="655" class="Symbol">as</a> <a id="658" class="Module">R</a>
<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>

<a id="697" class="Comment">-- Intended to represent a (possibly nested) field of a record type. For example, the list</a>
<a id="788" class="Comment">-- &quot;snd&quot; ∷ fst&quot; ∷ []` would represent the field `.fst .snd`.</a>
<a id="Projections"></a><a id="849" href="Cubical.Reflection.RecordEquiv.html#849" class="Function">Projections</a> <a id="861" class="Symbol">=</a> <a id="863" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="868" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a>

<a id="876" class="Comment">-- Intended to represent a bijection between two record types by an association list</a>
<a id="961" class="Comment">-- between (possibly nested) fields of the one and the other. The `Maybe`s are included to</a>
<a id="1052" class="Comment">-- allow dropping fields of Unit (or other definitionally unique) type.</a>
<a id="1124" class="Comment">--</a>
<a id="1127" class="Comment">-- For example, the correspondence</a>
<a id="1162" class="Comment">--</a>
<a id="1165" class="Comment">--   .fst .fst ↔ .snd</a>
<a id="1187" class="Comment">--   .fst .snd ↔ .fst</a>
<a id="1209" class="Comment">--   .snd ↔ ∅</a>
<a id="1223" class="Comment">--</a>
<a id="1226" class="Comment">-- between (A × B) × Unit and B × A would be represented by the list</a>
<a id="1295" class="Comment">--</a>
<a id="1298" class="Comment">--   [ (just [&quot;fst&quot;; &quot;fst&quot;] , just [&quot;snd&quot;])</a>
<a id="1342" class="Comment">--   ; (just [&quot;snd&quot;; &quot;fst&quot;] , just [&quot;fst&quot;])</a>
<a id="1386" class="Comment">--   ; (just [&quot;snd&quot;] , nothing)</a>
<a id="1418" class="Comment">--   ]</a>
<a id="RecordAssoc"></a><a id="1425" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="1437" class="Symbol">=</a> <a id="1439" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1444" class="Symbol">(</a><a id="1445" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="1451" href="Cubical.Reflection.RecordEquiv.html#849" class="Function">Projections</a> <a id="1463" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="1465" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="1471" href="Cubical.Reflection.RecordEquiv.html#849" class="Function">Projections</a><a id="1482" class="Symbol">)</a>

<a id="1485" class="Comment">-- Describes a correspondence between a non-nested record and an iterated Σ-type; more</a>
<a id="1572" class="Comment">-- convenient to work with than RecordAssoc in this special case, which is the most common</a>
<a id="1663" class="Comment">-- one. For example,</a>
<a id="1684" class="Comment">--</a>
<a id="1687" class="Comment">--   leaf &quot;a&quot; , (leaf &quot;b&quot; , leaf &quot;c&quot;)</a>
<a id="1725" class="Comment">--</a>
<a id="1728" class="Comment">-- describes the following RecordAssoc:</a>
<a id="1768" class="Comment">--</a>
<a id="1771" class="Comment">--   .fst ↔ .a</a>
<a id="1786" class="Comment">--   .snd .fst ↔ .b</a>
<a id="1806" class="Comment">--   .snd .snd ↔ .c</a>
<a id="1826" class="Comment">--</a>
<a id="1829" class="Comment">-- The `unit` constructor is the correspondence between Unit (&quot;nullary Σ&quot;) and the empty</a>
<a id="1918" class="Comment">-- record.</a>
<a id="1929" class="Keyword">data</a> <a id="ΣFormat"></a><a id="1934" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="1942" class="Symbol">:</a> <a id="1944" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1949" class="Keyword">where</a>
  <a id="ΣFormat.leaf"></a><a id="1957" href="Cubical.Reflection.RecordEquiv.html#1957" class="InductiveConstructor">leaf</a> <a id="1962" class="Symbol">:</a> <a id="1964" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a>
  <a id="ΣFormat._,_"></a><a id="1983" href="Cubical.Reflection.RecordEquiv.html#1983" class="InductiveConstructor Operator">_,_</a> <a id="1987" class="Symbol">:</a> <a id="1989" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="1997" class="Symbol">→</a> <a id="1999" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="2007" class="Symbol">→</a> <a id="2009" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a>
  <a id="ΣFormat.unit"></a><a id="2019" href="Cubical.Reflection.RecordEquiv.html#2019" class="InductiveConstructor">unit</a> <a id="2024" class="Symbol">:</a> <a id="2026" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a>

<a id="2035" class="Keyword">infixr</a> <a id="2042" class="Number">4</a> <a id="2044" href="Cubical.Reflection.RecordEquiv.html#1983" class="InductiveConstructor Operator">_,_</a>

<a id="2049" class="Comment">-- Inverse of a correspondence between record types</a>
<a id="flipRecordAssoc"></a><a id="2101" href="Cubical.Reflection.RecordEquiv.html#2101" class="Function">flipRecordAssoc</a> <a id="2117" class="Symbol">:</a> <a id="2119" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="2131" class="Symbol">→</a> <a id="2133" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a>
<a id="2145" href="Cubical.Reflection.RecordEquiv.html#2101" class="Function">flipRecordAssoc</a> <a id="2161" class="Symbol">=</a> <a id="2163" href="Cubical.Data.List.Base.html#600" class="Function">List.map</a> <a id="2172" class="Symbol">λ</a> <a id="2174" class="Symbol">{</a><a id="2175" href="Cubical.Reflection.RecordEquiv.html#2175" class="Bound">p</a> <a id="2177" class="Symbol">.</a><a id="2178" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="2182" class="Symbol">→</a> <a id="2184" href="Cubical.Reflection.RecordEquiv.html#2175" class="Bound">p</a> <a id="2186" class="Symbol">.</a><a id="2187" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a><a id="2190" class="Symbol">;</a> <a id="2192" href="Cubical.Reflection.RecordEquiv.html#2192" class="Bound">p</a> <a id="2194" class="Symbol">.</a><a id="2195" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2199" class="Symbol">→</a> <a id="2201" href="Cubical.Reflection.RecordEquiv.html#2192" class="Bound">p</a> <a id="2203" class="Symbol">.</a><a id="2204" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2207" class="Symbol">}</a>

<a id="2210" class="Comment">-- The identity correspondence on the domain of a given correspondence</a>
<a id="fstIdRecordAssoc"></a><a id="2281" href="Cubical.Reflection.RecordEquiv.html#2281" class="Function">fstIdRecordAssoc</a> <a id="2298" class="Symbol">:</a> <a id="2300" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a>
<a id="2326" href="Cubical.Reflection.RecordEquiv.html#2281" class="Function">fstIdRecordAssoc</a> <a id="2343" class="Symbol">=</a> <a id="2345" href="Cubical.Data.List.Base.html#600" class="Function">List.map</a> <a id="2354" class="Symbol">λ</a> <a id="2356" class="Symbol">{</a><a id="2357" href="Cubical.Reflection.RecordEquiv.html#2357" class="Bound">p</a> <a id="2359" class="Symbol">.</a><a id="2360" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="2364" class="Symbol">→</a> <a id="2366" href="Cubical.Reflection.RecordEquiv.html#2357" class="Bound">p</a> <a id="2368" class="Symbol">.</a><a id="2369" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2372" class="Symbol">;</a> <a id="2374" href="Cubical.Reflection.RecordEquiv.html#2374" class="Bound">p</a> <a id="2376" class="Symbol">.</a><a id="2377" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2381" class="Symbol">→</a> <a id="2383" href="Cubical.Reflection.RecordEquiv.html#2374" class="Bound">p</a> <a id="2385" class="Symbol">.</a><a id="2386" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2389" class="Symbol">}</a>

<a id="2392" class="Comment">-- Constructs a ΣFormat from a list of fields meant to represent a right-associated Σ-type</a>
<a id="List→ΣFormat"></a><a id="2483" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="2496" class="Symbol">:</a> <a id="2498" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2503" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="2510" class="Symbol">→</a> <a id="2512" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a>
<a id="2520" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="2533" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2536" class="Symbol">=</a> <a id="2538" href="Cubical.Reflection.RecordEquiv.html#2019" class="InductiveConstructor">unit</a>
<a id="2543" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="2556" class="Symbol">(</a><a id="2557" href="Cubical.Reflection.RecordEquiv.html#2557" class="Bound">x</a> <a id="2559" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2561" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2563" class="Symbol">)</a> <a id="2565" class="Symbol">=</a> <a id="2567" href="Cubical.Reflection.RecordEquiv.html#1957" class="InductiveConstructor">leaf</a> <a id="2572" href="Cubical.Reflection.RecordEquiv.html#2557" class="Bound">x</a>
<a id="2574" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="2587" class="Symbol">(</a><a id="2588" href="Cubical.Reflection.RecordEquiv.html#2588" class="Bound">x</a> <a id="2590" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2592" href="Cubical.Reflection.RecordEquiv.html#2592" class="Bound">y</a> <a id="2594" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2596" href="Cubical.Reflection.RecordEquiv.html#2596" class="Bound">xs</a><a id="2598" class="Symbol">)</a> <a id="2600" class="Symbol">=</a> <a id="2602" href="Cubical.Reflection.RecordEquiv.html#1957" class="InductiveConstructor">leaf</a> <a id="2607" href="Cubical.Reflection.RecordEquiv.html#2588" class="Bound">x</a> <a id="2609" href="Cubical.Reflection.RecordEquiv.html#1983" class="InductiveConstructor Operator">,</a> <a id="2611" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Cubical.Reflection.RecordEquiv.html#2592" class="Bound">y</a> <a id="2627" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2629" href="Cubical.Reflection.RecordEquiv.html#2596" class="Bound">xs</a><a id="2631" class="Symbol">)</a>

<a id="2634" class="Comment">-- Converts a ΣFormat to an association list as described above.</a>
<a id="2699" class="Comment">-- The domain of the RecordAssoc is the record type, the codomain is the Σ-type.</a>
<a id="ΣFormat→RecordAssoc"></a><a id="2780" href="Cubical.Reflection.RecordEquiv.html#2780" class="Function">ΣFormat→RecordAssoc</a> <a id="2800" class="Symbol">:</a> <a id="2802" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="2810" class="Symbol">→</a> <a id="2812" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a>
<a id="2824" href="Cubical.Reflection.RecordEquiv.html#2780" class="Function">ΣFormat→RecordAssoc</a> <a id="2844" class="Symbol">=</a> <a id="2846" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="2849" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2854" class="Keyword">where</a>
  <a id="2862" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="2865" class="Symbol">:</a> <a id="2867" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2872" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="2879" class="Symbol">→</a> <a id="2881" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="2889" class="Symbol">→</a> <a id="2891" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a>
  <a id="2905" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="2908" href="Cubical.Reflection.RecordEquiv.html#2908" class="Bound">prefix</a> <a id="2915" href="Cubical.Reflection.RecordEquiv.html#2019" class="InductiveConstructor">unit</a> <a id="2920" class="Symbol">=</a> <a id="2922" href="Cubical.Data.List.Base.html#282" class="Function Operator">[</a> <a id="2924" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a> <a id="2932" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2934" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="2939" href="Cubical.Reflection.RecordEquiv.html#2908" class="Bound">prefix</a> <a id="2946" href="Cubical.Data.List.Base.html#282" class="Function Operator">]</a>
  <a id="2950" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="2953" href="Cubical.Reflection.RecordEquiv.html#2953" class="Bound">prefix</a> <a id="2960" class="Symbol">(</a><a id="2961" href="Cubical.Reflection.RecordEquiv.html#1957" class="InductiveConstructor">leaf</a> <a id="2966" href="Cubical.Reflection.RecordEquiv.html#2966" class="Bound">fieldName</a><a id="2975" class="Symbol">)</a> <a id="2977" class="Symbol">=</a> <a id="2979" href="Cubical.Data.List.Base.html#282" class="Function Operator">[</a> <a id="2981" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="2986" href="Cubical.Data.List.Base.html#282" class="Function Operator">[</a> <a id="2988" href="Cubical.Reflection.RecordEquiv.html#2966" class="Bound">fieldName</a> <a id="2998" href="Cubical.Data.List.Base.html#282" class="Function Operator">]</a> <a id="3000" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3002" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="3007" href="Cubical.Reflection.RecordEquiv.html#2953" class="Bound">prefix</a> <a id="3014" href="Cubical.Data.List.Base.html#282" class="Function Operator">]</a>
  <a id="3018" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="3021" href="Cubical.Reflection.RecordEquiv.html#3021" class="Bound">prefix</a> <a id="3028" class="Symbol">(</a><a id="3029" href="Cubical.Reflection.RecordEquiv.html#3029" class="Bound">sig₁</a> <a id="3034" href="Cubical.Reflection.RecordEquiv.html#1983" class="InductiveConstructor Operator">,</a> <a id="3036" href="Cubical.Reflection.RecordEquiv.html#3036" class="Bound">sig₂</a><a id="3040" class="Symbol">)</a> <a id="3042" class="Symbol">=</a>
    <a id="3048" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="3051" class="Symbol">(</a><a id="3052" class="Keyword">quote</a> <a id="3058" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="3062" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3064" href="Cubical.Reflection.RecordEquiv.html#3021" class="Bound">prefix</a><a id="3070" class="Symbol">)</a> <a id="3072" href="Cubical.Reflection.RecordEquiv.html#3029" class="Bound">sig₁</a> <a id="3077" href="Cubical.Data.List.Base.html#319" class="Function Operator">++</a> <a id="3080" href="Cubical.Reflection.RecordEquiv.html#2862" class="Function">go</a> <a id="3083" class="Symbol">(</a><a id="3084" class="Keyword">quote</a> <a id="3090" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="3094" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3096" href="Cubical.Reflection.RecordEquiv.html#3021" class="Bound">prefix</a><a id="3102" class="Symbol">)</a> <a id="3104" href="Cubical.Reflection.RecordEquiv.html#3036" class="Bound">sig₂</a>

<a id="3110" class="Comment">-- Define a reflected type with the shape of the Σ-type described by a ΣFormat.</a>
<a id="3190" class="Comment">-- The type arguments to the Σ are filled in with unsolved metavariables.</a>
<a id="ΣFormat→Ty"></a><a id="3264" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3275" class="Symbol">:</a> <a id="3277" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="3285" class="Symbol">→</a> <a id="3287" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a>
<a id="3294" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3305" href="Cubical.Reflection.RecordEquiv.html#2019" class="InductiveConstructor">unit</a> <a id="3310" class="Symbol">=</a> <a id="3312" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3318" class="Symbol">(</a><a id="3319" class="Keyword">quote</a> <a id="3325" href="Cubical.Data.Unit.Base.html#172" class="Record">Unit</a><a id="3329" class="Symbol">)</a> <a id="3331" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3334" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3345" class="Symbol">(</a><a id="3346" href="Cubical.Reflection.RecordEquiv.html#1957" class="InductiveConstructor">leaf</a> <a id="3351" class="Symbol">_)</a> <a id="3354" class="Symbol">=</a> <a id="3356" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a>
<a id="3366" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3377" class="Symbol">(</a><a id="3378" href="Cubical.Reflection.RecordEquiv.html#3378" class="Bound">sig₁</a> <a id="3383" href="Cubical.Reflection.RecordEquiv.html#1983" class="InductiveConstructor Operator">,</a> <a id="3385" href="Cubical.Reflection.RecordEquiv.html#3385" class="Bound">sig₂</a><a id="3389" class="Symbol">)</a> <a id="3391" class="Symbol">=</a>
  <a id="3395" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3401" class="Symbol">(</a><a id="3402" class="Keyword">quote</a> <a id="3408" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="3409" class="Symbol">)</a> <a id="3411" class="Symbol">(</a><a id="3412" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3423" href="Cubical.Reflection.RecordEquiv.html#3378" class="Bound">sig₁</a> <a id="3428" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="3431" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">R.lam</a> <a id="3437" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">R.visible</a> <a id="3447" class="Symbol">(</a><a id="3448" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="3454" class="String">&quot;_&quot;</a> <a id="3458" class="Symbol">(</a><a id="3459" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="3470" href="Cubical.Reflection.RecordEquiv.html#3385" class="Bound">sig₂</a><a id="3474" class="Symbol">))</a> <a id="3477" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="3480" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3482" class="Symbol">)</a>

<a id="3485" class="Comment">-- Given the name of a record type and a ΣFormat describing an isomorphism between this</a>
<a id="3573" class="Comment">-- type and a Σ-type, constructs a reflected type of isomorphisms between the record and</a>
<a id="3662" class="Comment">-- Σ-type. If the record type takes parameters or indices, then the result is a similarly</a>
<a id="3752" class="Comment">-- parameterized family of isomorphisms. All parameters to the isomorphism are made</a>
<a id="3836" class="Comment">-- implicit.</a>
<a id="recordName→isoTy"></a><a id="3849" href="Cubical.Reflection.RecordEquiv.html#3849" class="Function">recordName→isoTy</a> <a id="3866" class="Symbol">:</a> <a id="3868" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="3875" class="Symbol">→</a> <a id="3877" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="3885" class="Symbol">→</a> <a id="3887" href="Agda.Builtin.Reflection.html#8602" class="Postulate">R.TC</a> <a id="3892" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
<a id="3899" href="Cubical.Reflection.RecordEquiv.html#3849" class="Function">recordName→isoTy</a> <a id="3916" href="Cubical.Reflection.RecordEquiv.html#3916" class="Bound">name</a> <a id="3921" href="Cubical.Reflection.RecordEquiv.html#3921" class="Bound">σ</a> <a id="3923" class="Symbol">=</a>
  <a id="3927" href="Agda.Builtin.Reflection.html#8878" class="Postulate">R.inferType</a> <a id="3939" class="Symbol">(</a><a id="3940" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3946" href="Cubical.Reflection.RecordEquiv.html#3916" class="Bound">name</a> <a id="3951" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3953" class="Symbol">)</a> <a id="3955" href="Cubical.Reflection.Base.html#302" class="Function Operator">&gt;&gt;=</a> <a id="3959" href="Agda.Builtin.Reflection.html#8957" class="Postulate">R.normalise</a> <a id="3971" href="Cubical.Reflection.Base.html#302" class="Function Operator">&gt;&gt;=</a> <a id="3975" href="Cubical.Reflection.RecordEquiv.html#4064" class="Function">go</a> <a id="3978" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="3983" class="Keyword">where</a>
  <a id="3991" href="Cubical.Reflection.RecordEquiv.html#3991" class="Function">σTy</a> <a id="3995" class="Symbol">=</a> <a id="3997" href="Cubical.Reflection.RecordEquiv.html#3264" class="Function">ΣFormat→Ty</a> <a id="4008" href="Cubical.Reflection.RecordEquiv.html#3921" class="Bound">σ</a>

  <a id="4013" class="Comment">-- Recurses on the type of the named record type</a>
  <a id="4064" href="Cubical.Reflection.RecordEquiv.html#4064" class="Function">go</a> <a id="4067" class="Symbol">:</a> <a id="4069" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4074" href="Agda.Builtin.Reflection.html#3615" class="Datatype">R.ArgInfo</a> <a id="4084" class="Symbol">→</a> <a id="4086" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a> <a id="4093" class="Symbol">→</a> <a id="4095" href="Agda.Builtin.Reflection.html#8602" class="Postulate">R.TC</a> <a id="4100" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
  <a id="4109" href="Cubical.Reflection.RecordEquiv.html#4064" class="Function">go</a> <a id="4112" href="Cubical.Reflection.RecordEquiv.html#4112" class="Bound">acc</a> <a id="4116" class="Symbol">(</a><a id="4117" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">R.pi</a> <a id="4122" class="Symbol">(</a><a id="4123" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4129" href="Cubical.Reflection.RecordEquiv.html#4129" class="Bound">i</a> <a id="4131" href="Cubical.Reflection.RecordEquiv.html#4131" class="Bound">argTy</a><a id="4136" class="Symbol">)</a> <a id="4138" class="Symbol">(</a><a id="4139" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="4145" href="Cubical.Reflection.RecordEquiv.html#4145" class="Bound">s</a> <a id="4147" href="Cubical.Reflection.RecordEquiv.html#4147" class="Bound">ty</a><a id="4149" class="Symbol">))</a> <a id="4152" class="Symbol">=</a>
    <a id="4158" class="Comment">-- If the record takes a parameter, the returned isomorphism is likewise parameterized</a>
    <a id="4249" href="Cubical.Reflection.Base.html#459" class="Function">liftTC</a> <a id="4256" class="Symbol">(λ</a> <a id="4259" href="Cubical.Reflection.RecordEquiv.html#4259" class="Bound">t</a> <a id="4261" class="Symbol">→</a> <a id="4263" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">R.pi</a> <a id="4268" class="Symbol">(</a><a id="4269" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4275" href="Cubical.Reflection.RecordEquiv.html#4330" class="Function">i&#39;</a> <a id="4278" href="Cubical.Reflection.RecordEquiv.html#4131" class="Bound">argTy</a><a id="4283" class="Symbol">)</a> <a id="4285" class="Symbol">(</a><a id="4286" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="4292" href="Cubical.Reflection.RecordEquiv.html#4145" class="Bound">s</a> <a id="4294" href="Cubical.Reflection.RecordEquiv.html#4259" class="Bound">t</a><a id="4295" class="Symbol">))</a> <a id="4298" class="Symbol">(</a><a id="4299" href="Cubical.Reflection.RecordEquiv.html#4064" class="Function">go</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Cubical.Reflection.RecordEquiv.html#4129" class="Bound">i</a> <a id="4305" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4307" href="Cubical.Reflection.RecordEquiv.html#4112" class="Bound">acc</a><a id="4310" class="Symbol">)</a> <a id="4312" href="Cubical.Reflection.RecordEquiv.html#4147" class="Bound">ty</a><a id="4314" class="Symbol">)</a>
    <a id="4320" class="Keyword">where</a>
    <a id="4330" href="Cubical.Reflection.RecordEquiv.html#4330" class="Function">i&#39;</a> <a id="4333" class="Symbol">=</a> <a id="4335" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">R.arg-info</a> <a id="4346" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">R.hidden</a> <a id="4355" class="Symbol">(</a><a id="4356" href="Agda.Builtin.Reflection.html#3463" class="InductiveConstructor">R.modality</a> <a id="4367" href="Agda.Builtin.Reflection.html#3019" class="InductiveConstructor">R.relevant</a> <a id="4378" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">R.quantity-ω</a><a id="4390" class="Symbol">)</a>
  <a id="4394" href="Cubical.Reflection.RecordEquiv.html#4064" class="Function">go</a> <a id="4397" href="Cubical.Reflection.RecordEquiv.html#4397" class="Bound">acc</a> <a id="4401" class="Symbol">(</a><a id="4402" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">R.agda-sort</a> <a id="4414" class="Symbol">_)</a> <a id="4417" class="Symbol">=</a>
    <a id="4423" class="Comment">-- Main case, constructs isomorphism type</a>
    <a id="4469" href="Agda.Builtin.Reflection.html#8645" class="Postulate">R.returnTC</a> <a id="4480" class="Symbol">(</a><a id="4481" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="4487" class="Symbol">(</a><a id="4488" class="Keyword">quote</a> <a id="4494" href="Cubical.Foundations.Isomorphism.html#773" class="Record">Iso</a><a id="4497" class="Symbol">)</a> <a id="4499" class="Symbol">(</a><a id="4500" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="4506" href="Cubical.Reflection.RecordEquiv.html#3916" class="Bound">name</a> <a id="4511" class="Symbol">(</a><a id="4512" href="Cubical.Reflection.RecordEquiv.html#4560" class="Function">makeArgs</a> <a id="4521" class="Number">0</a> <a id="4523" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4526" href="Cubical.Reflection.RecordEquiv.html#4397" class="Bound">acc</a><a id="4529" class="Symbol">)</a> <a id="4531" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="4534" href="Cubical.Reflection.RecordEquiv.html#3991" class="Function">σTy</a> <a id="4538" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="4541" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4543" class="Symbol">))</a>
    <a id="4550" class="Keyword">where</a>
    <a id="4560" href="Cubical.Reflection.RecordEquiv.html#4560" class="Function">makeArgs</a> <a id="4569" class="Symbol">:</a> <a id="4571" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4573" class="Symbol">→</a> <a id="4575" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4580" class="Symbol">(</a><a id="4581" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="4587" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a><a id="4593" class="Symbol">)</a> <a id="4595" class="Symbol">→</a> <a id="4597" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4602" href="Agda.Builtin.Reflection.html#3615" class="Datatype">R.ArgInfo</a> <a id="4612" class="Symbol">→</a> <a id="4614" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4619" class="Symbol">(</a><a id="4620" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="4626" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a><a id="4632" class="Symbol">)</a>
    <a id="4638" href="Cubical.Reflection.RecordEquiv.html#4560" class="Function">makeArgs</a> <a id="4647" href="Cubical.Reflection.RecordEquiv.html#4647" class="Bound">n</a> <a id="4649" href="Cubical.Reflection.RecordEquiv.html#4649" class="Bound">acc</a> <a id="4653" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4656" class="Symbol">=</a> <a id="4658" href="Cubical.Reflection.RecordEquiv.html#4649" class="Bound">acc</a>
    <a id="4666" href="Cubical.Reflection.RecordEquiv.html#4560" class="Function">makeArgs</a> <a id="4675" href="Cubical.Reflection.RecordEquiv.html#4675" class="Bound">n</a> <a id="4677" href="Cubical.Reflection.RecordEquiv.html#4677" class="Bound">acc</a> <a id="4681" class="Symbol">(</a><a id="4682" href="Cubical.Reflection.RecordEquiv.html#4682" class="Bound">i</a> <a id="4684" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4686" href="Cubical.Reflection.RecordEquiv.html#4686" class="Bound">infos</a><a id="4691" class="Symbol">)</a> <a id="4693" class="Symbol">=</a> <a id="4695" href="Cubical.Reflection.RecordEquiv.html#4560" class="Function">makeArgs</a> <a id="4704" class="Symbol">(</a><a id="4705" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4709" href="Cubical.Reflection.RecordEquiv.html#4675" class="Bound">n</a><a id="4710" class="Symbol">)</a> <a id="4712" class="Symbol">(</a><a id="4713" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4719" href="Cubical.Reflection.RecordEquiv.html#4682" class="Bound">i</a> <a id="4721" class="Symbol">(</a><a id="4722" href="Cubical.Reflection.Base.html#577" class="Function">v</a> <a id="4724" href="Cubical.Reflection.RecordEquiv.html#4675" class="Bound">n</a><a id="4725" class="Symbol">)</a> <a id="4727" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4729" href="Cubical.Reflection.RecordEquiv.html#4677" class="Bound">acc</a><a id="4732" class="Symbol">)</a> <a id="4734" href="Cubical.Reflection.RecordEquiv.html#4686" class="Bound">infos</a>
  <a id="4742" href="Cubical.Reflection.RecordEquiv.html#4064" class="CatchallClause Function">go</a><a id="4744" class="CatchallClause"> </a><a id="4745" class="CatchallClause Symbol">_</a><a id="4746" class="CatchallClause"> </a><a id="4747" class="CatchallClause Symbol">_</a> <a id="4749" class="Symbol">=</a> <a id="4751" href="Agda.Builtin.Reflection.html#8815" class="Postulate">R.typeError</a> <a id="4763" class="Symbol">(</a><a id="4764" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">R.strErr</a> <a id="4773" class="String">&quot;Not a record type name: &quot;</a> <a id="4800" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4802" href="Agda.Builtin.Reflection.html#8315" class="InductiveConstructor">R.nameErr</a> <a id="4812" href="Cubical.Reflection.RecordEquiv.html#3916" class="Bound">name</a> <a id="4817" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4819" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4821" class="Symbol">)</a>

<a id="4824" class="Comment">-- Given an association list `al` defining a correspondence between record types (say R</a>
<a id="4912" class="Comment">-- and S) and a `term` belonging to R, produces clauses defining an element of S, with</a>
<a id="4999" class="Comment">-- each field of S instantiated with a field of `term` according to `al`.  For example,</a>
<a id="5087" class="Comment">-- the correspondence</a>
<a id="5109" class="Comment">--</a>
<a id="5112" class="Comment">--   .fst ↔ .a</a>
<a id="5127" class="Comment">--   .snd .fst ↔ .b</a>
<a id="5147" class="Comment">--   .snd .snd ↔ ∅</a>
<a id="5166" class="Comment">--   ∅ ↔ .c</a>
<a id="5178" class="Comment">--</a>
<a id="5181" class="Comment">-- would produce the clauses</a>
<a id="5210" class="Comment">--</a>
<a id="5213" class="Comment">-- ... .a = term .fst</a>
<a id="5235" class="Comment">-- ... .b = term .snd</a>
<a id="5257" class="Comment">-- ... .c = _</a>
<a id="5271" class="Comment">--</a>
<a id="5274" class="Comment">-- Here the type of .c should have a definitionally unique element, so</a>
<a id="5345" class="Comment">-- we can safely fill it with an unsolved metavariable.</a>
<a id="convertClauses"></a><a id="5401" href="Cubical.Reflection.RecordEquiv.html#5401" class="Function">convertClauses</a> <a id="5416" class="Symbol">:</a> <a id="5418" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="5430" class="Symbol">→</a> <a id="5432" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a> <a id="5439" class="Symbol">→</a> <a id="5441" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5446" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
<a id="5455" href="Cubical.Reflection.RecordEquiv.html#5401" class="Function">convertClauses</a> <a id="5470" href="Cubical.Reflection.RecordEquiv.html#5470" class="Bound">al</a> <a id="5473" href="Cubical.Reflection.RecordEquiv.html#5473" class="Bound">term</a> <a id="5478" class="Symbol">=</a> <a id="5480" href="Cubical.Reflection.RecordEquiv.html#6199" class="Function">fixIfEmpty</a> <a id="5491" class="Symbol">(</a><a id="5492" href="Cubical.Data.List.Base.html#891" class="Function">List.filterMap</a> <a id="5507" href="Cubical.Reflection.RecordEquiv.html#5532" class="Function">makeClause</a> <a id="5518" href="Cubical.Reflection.RecordEquiv.html#5470" class="Bound">al</a><a id="5520" class="Symbol">)</a>
  <a id="5524" class="Keyword">where</a>
  <a id="5532" href="Cubical.Reflection.RecordEquiv.html#5532" class="Function">makeClause</a> <a id="5543" class="Symbol">:</a> <a id="5545" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="5551" href="Cubical.Reflection.RecordEquiv.html#849" class="Function">Projections</a> <a id="5563" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="5565" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="5571" href="Cubical.Reflection.RecordEquiv.html#849" class="Function">Projections</a> <a id="5583" class="Symbol">→</a> <a id="5585" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="5591" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="5602" href="Cubical.Reflection.RecordEquiv.html#5532" class="Function">makeClause</a> <a id="5613" class="Symbol">(</a><a id="5614" href="Cubical.Reflection.RecordEquiv.html#5614" class="Bound">projl</a> <a id="5620" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5622" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5627" href="Cubical.Reflection.RecordEquiv.html#5627" class="Bound">projr</a><a id="5632" class="Symbol">)</a> <a id="5634" class="Symbol">=</a>
    <a id="5640" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5645" class="Symbol">(</a><a id="5646" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="5655" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5658" class="Symbol">(</a><a id="5659" href="Cubical.Reflection.RecordEquiv.html#5723" class="Function">goPat</a> <a id="5665" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5668" href="Cubical.Reflection.RecordEquiv.html#5627" class="Bound">projr</a><a id="5673" class="Symbol">)</a> <a id="5675" class="Symbol">(</a><a id="5676" href="Cubical.Data.Maybe.Base.html#452" class="Function">Maybe.rec</a> <a id="5686" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a> <a id="5696" href="Cubical.Reflection.RecordEquiv.html#5885" class="Function">goTm</a> <a id="5701" href="Cubical.Reflection.RecordEquiv.html#5614" class="Bound">projl</a><a id="5706" class="Symbol">))</a>
    <a id="5713" class="Keyword">where</a>
    <a id="5723" href="Cubical.Reflection.RecordEquiv.html#5723" class="Function">goPat</a> <a id="5729" class="Symbol">:</a> <a id="5731" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5736" class="Symbol">(</a><a id="5737" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="5743" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="5752" class="Symbol">)</a> <a id="5754" class="Symbol">→</a> <a id="5756" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5761" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="5768" class="Symbol">→</a> <a id="5770" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5775" class="Symbol">(</a><a id="5776" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="5782" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="5791" class="Symbol">)</a>
    <a id="5797" href="Cubical.Reflection.RecordEquiv.html#5723" class="Function">goPat</a> <a id="5803" href="Cubical.Reflection.RecordEquiv.html#5803" class="Bound">acc</a> <a id="5807" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5810" class="Symbol">=</a> <a id="5812" href="Cubical.Reflection.RecordEquiv.html#5803" class="Bound">acc</a>
    <a id="5820" href="Cubical.Reflection.RecordEquiv.html#5723" class="Function">goPat</a> <a id="5826" href="Cubical.Reflection.RecordEquiv.html#5826" class="Bound">acc</a> <a id="5830" class="Symbol">(</a><a id="5831" href="Cubical.Reflection.RecordEquiv.html#5831" class="Bound">π</a> <a id="5833" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5835" href="Cubical.Reflection.RecordEquiv.html#5835" class="Bound">projs</a><a id="5840" class="Symbol">)</a> <a id="5842" class="Symbol">=</a> <a id="5844" href="Cubical.Reflection.RecordEquiv.html#5723" class="Function">goPat</a> <a id="5850" class="Symbol">(</a><a id="5851" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="5856" class="Symbol">(</a><a id="5857" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="5864" href="Cubical.Reflection.RecordEquiv.html#5831" class="Bound">π</a><a id="5865" class="Symbol">)</a> <a id="5867" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5869" href="Cubical.Reflection.RecordEquiv.html#5826" class="Bound">acc</a><a id="5872" class="Symbol">)</a> <a id="5874" href="Cubical.Reflection.RecordEquiv.html#5835" class="Bound">projs</a>

    <a id="5885" href="Cubical.Reflection.RecordEquiv.html#5885" class="Function">goTm</a> <a id="5890" class="Symbol">:</a> <a id="5892" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5897" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="5904" class="Symbol">→</a> <a id="5906" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
    <a id="5917" href="Cubical.Reflection.RecordEquiv.html#5885" class="Function">goTm</a> <a id="5922" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5925" class="Symbol">=</a> <a id="5927" href="Cubical.Reflection.RecordEquiv.html#5473" class="Bound">term</a>
    <a id="5936" href="Cubical.Reflection.RecordEquiv.html#5885" class="Function">goTm</a> <a id="5941" class="Symbol">(</a><a id="5942" href="Cubical.Reflection.RecordEquiv.html#5942" class="Bound">π</a> <a id="5944" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5946" href="Cubical.Reflection.RecordEquiv.html#5946" class="Bound">projs</a><a id="5951" class="Symbol">)</a> <a id="5953" class="Symbol">=</a> <a id="5955" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="5961" href="Cubical.Reflection.RecordEquiv.html#5942" class="Bound">π</a> <a id="5963" href="Cubical.Data.List.Base.html#282" class="Function Operator">[</a> <a id="5965" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="5970" class="Symbol">(</a><a id="5971" href="Cubical.Reflection.RecordEquiv.html#5885" class="Function">goTm</a> <a id="5976" href="Cubical.Reflection.RecordEquiv.html#5946" class="Bound">projs</a><a id="5981" class="Symbol">)</a> <a id="5983" href="Cubical.Data.List.Base.html#282" class="Function Operator">]</a>
  <a id="5987" href="Cubical.Reflection.RecordEquiv.html#5532" class="Function">makeClause</a> <a id="5998" class="Symbol">(_</a> <a id="6001" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6003" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a><a id="6010" class="Symbol">)</a> <a id="6012" class="Symbol">=</a> <a id="6014" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>

  <a id="6025" class="Comment">-- If there end up being zero clauses, then S should be a type with a definitionally</a>
  <a id="6112" class="Comment">-- unique element, so we return a single clause defined by an unsolved metavariable.</a>
  <a id="6199" href="Cubical.Reflection.RecordEquiv.html#6199" class="Function">fixIfEmpty</a> <a id="6210" class="Symbol">:</a> <a id="6212" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6217" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a> <a id="6226" class="Symbol">→</a> <a id="6228" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6233" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="6244" href="Cubical.Reflection.RecordEquiv.html#6199" class="Function">fixIfEmpty</a> <a id="6255" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6258" class="Symbol">=</a> <a id="6260" href="Cubical.Data.List.Base.html#282" class="Function Operator">[</a> <a id="6262" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6271" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6274" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6277" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a> <a id="6287" href="Cubical.Data.List.Base.html#282" class="Function Operator">]</a>
  <a id="6291" href="Cubical.Reflection.RecordEquiv.html#6199" class="Function">fixIfEmpty</a> <a id="6302" class="Symbol">(</a><a id="6303" href="Cubical.Reflection.RecordEquiv.html#6303" class="Bound">c</a> <a id="6305" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6307" href="Cubical.Reflection.RecordEquiv.html#6307" class="Bound">cs</a><a id="6309" class="Symbol">)</a> <a id="6311" class="Symbol">=</a> <a id="6313" href="Cubical.Reflection.RecordEquiv.html#6303" class="Bound">c</a> <a id="6315" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6317" href="Cubical.Reflection.RecordEquiv.html#6307" class="Bound">cs</a>

<a id="6321" class="Comment">-- Apply functions to the telescope and pattern parts of a clause</a>
<a id="mapClause"></a><a id="6387" href="Cubical.Reflection.RecordEquiv.html#6387" class="Function">mapClause</a> <a id="6397" class="Symbol">:</a>
  <a id="6401" class="Symbol">(</a><a id="6402" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6407" class="Symbol">(</a><a id="6408" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="6415" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="6417" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6423" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a><a id="6429" class="Symbol">)</a> <a id="6431" class="Symbol">→</a> <a id="6433" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6438" class="Symbol">(</a><a id="6439" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="6446" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="6448" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6454" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a><a id="6460" class="Symbol">))</a>
  <a id="6465" class="Symbol">→</a> <a id="6467" class="Symbol">(</a><a id="6468" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6473" class="Symbol">(</a><a id="6474" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6480" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="6489" class="Symbol">)</a> <a id="6491" class="Symbol">→</a> <a id="6493" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6498" class="Symbol">(</a><a id="6499" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6505" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="6514" class="Symbol">))</a>
  <a id="6519" class="Symbol">→</a> <a id="6521" class="Symbol">(</a><a id="6522" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a> <a id="6531" class="Symbol">→</a> <a id="6533" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a><a id="6541" class="Symbol">)</a>
<a id="6543" href="Cubical.Reflection.RecordEquiv.html#6387" class="Function">mapClause</a> <a id="6553" href="Cubical.Reflection.RecordEquiv.html#6553" class="Bound">f</a> <a id="6555" href="Cubical.Reflection.RecordEquiv.html#6555" class="Bound">g</a> <a id="6557" class="Symbol">(</a><a id="6558" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6567" href="Cubical.Reflection.RecordEquiv.html#6567" class="Bound">tel</a> <a id="6571" href="Cubical.Reflection.RecordEquiv.html#6571" class="Bound">ps</a> <a id="6574" href="Cubical.Reflection.RecordEquiv.html#6574" class="Bound">t</a><a id="6575" class="Symbol">)</a> <a id="6577" class="Symbol">=</a> <a id="6579" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6588" class="Symbol">(</a><a id="6589" href="Cubical.Reflection.RecordEquiv.html#6553" class="Bound">f</a> <a id="6591" href="Cubical.Reflection.RecordEquiv.html#6567" class="Bound">tel</a><a id="6594" class="Symbol">)</a> <a id="6596" class="Symbol">(</a><a id="6597" href="Cubical.Reflection.RecordEquiv.html#6555" class="Bound">g</a> <a id="6599" href="Cubical.Reflection.RecordEquiv.html#6571" class="Bound">ps</a><a id="6601" class="Symbol">)</a> <a id="6603" href="Cubical.Reflection.RecordEquiv.html#6574" class="Bound">t</a>
<a id="6605" href="Cubical.Reflection.RecordEquiv.html#6387" class="Function">mapClause</a> <a id="6615" href="Cubical.Reflection.RecordEquiv.html#6615" class="Bound">f</a> <a id="6617" href="Cubical.Reflection.RecordEquiv.html#6617" class="Bound">g</a> <a id="6619" class="Symbol">(</a><a id="6620" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">R.absurd-clause</a> <a id="6636" href="Cubical.Reflection.RecordEquiv.html#6636" class="Bound">tel</a> <a id="6640" href="Cubical.Reflection.RecordEquiv.html#6640" class="Bound">ps</a><a id="6642" class="Symbol">)</a> <a id="6644" class="Symbol">=</a> <a id="6646" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">R.absurd-clause</a> <a id="6662" class="Symbol">(</a><a id="6663" href="Cubical.Reflection.RecordEquiv.html#6615" class="Bound">f</a> <a id="6665" href="Cubical.Reflection.RecordEquiv.html#6636" class="Bound">tel</a><a id="6668" class="Symbol">)</a> <a id="6670" class="Symbol">(</a><a id="6671" href="Cubical.Reflection.RecordEquiv.html#6617" class="Bound">g</a> <a id="6673" href="Cubical.Reflection.RecordEquiv.html#6640" class="Bound">ps</a><a id="6675" class="Symbol">)</a>

<a id="6678" class="Comment">-- Given a ΣFormat `σ` relating a record type R and Σ-type S, returns</a>
<a id="6748" class="Comment">-- a list of clauses defining an isomorphism between R and S.</a>
<a id="recordIsoΣClauses"></a><a id="6810" href="Cubical.Reflection.RecordEquiv.html#6810" class="Function">recordIsoΣClauses</a> <a id="6828" class="Symbol">:</a> <a id="6830" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="6838" class="Symbol">→</a> <a id="6840" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6845" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
<a id="6854" href="Cubical.Reflection.RecordEquiv.html#6810" class="Function">recordIsoΣClauses</a> <a id="6872" href="Cubical.Reflection.RecordEquiv.html#6872" class="Bound">σ</a> <a id="6874" class="Symbol">=</a>
  <a id="6878" href="Cubical.Reflection.RecordEquiv.html#7346" class="Function">funClauses</a> <a id="6889" class="Symbol">(</a><a id="6890" class="Keyword">quote</a> <a id="6896" href="Cubical.Foundations.Isomorphism.html#885" class="Field">Iso.fun</a><a id="6903" class="Symbol">)</a> <a id="6905" href="Cubical.Reflection.RecordEquiv.html#7099" class="Function">R↔Σ</a> <a id="6909" href="Cubical.Data.List.Base.html#319" class="Function Operator">++</a>
  <a id="6914" href="Cubical.Reflection.RecordEquiv.html#7346" class="Function">funClauses</a> <a id="6925" class="Symbol">(</a><a id="6926" class="Keyword">quote</a> <a id="6932" href="Cubical.Foundations.Isomorphism.html#901" class="Field">Iso.inv</a><a id="6939" class="Symbol">)</a> <a id="6941" href="Cubical.Reflection.RecordEquiv.html#7129" class="Function">Σ↔R</a> <a id="6945" href="Cubical.Data.List.Base.html#319" class="Function Operator">++</a>
  <a id="6950" class="Comment">-- Clauses for the forward and backward inverse conditions</a>
  <a id="7011" href="Cubical.Reflection.RecordEquiv.html#7910" class="Function">pathClauses</a> <a id="7023" class="Symbol">(</a><a id="7024" class="Keyword">quote</a> <a id="7030" href="Cubical.Foundations.Isomorphism.html#917" class="Field">Iso.rightInv</a><a id="7042" class="Symbol">)</a> <a id="7044" href="Cubical.Reflection.RecordEquiv.html#7129" class="Function">Σ↔R</a> <a id="7048" href="Cubical.Data.List.Base.html#319" class="Function Operator">++</a>
  <a id="7053" href="Cubical.Reflection.RecordEquiv.html#7910" class="Function">pathClauses</a> <a id="7065" class="Symbol">(</a><a id="7066" class="Keyword">quote</a> <a id="7072" href="Cubical.Foundations.Isomorphism.html#948" class="Field">Iso.leftInv</a><a id="7083" class="Symbol">)</a> <a id="7085" href="Cubical.Reflection.RecordEquiv.html#7099" class="Function">R↔Σ</a>
  <a id="7091" class="Keyword">where</a>
  <a id="7099" href="Cubical.Reflection.RecordEquiv.html#7099" class="Function">R↔Σ</a> <a id="7103" class="Symbol">=</a> <a id="7105" href="Cubical.Reflection.RecordEquiv.html#2780" class="Function">ΣFormat→RecordAssoc</a> <a id="7125" href="Cubical.Reflection.RecordEquiv.html#6872" class="Bound">σ</a>
  <a id="7129" href="Cubical.Reflection.RecordEquiv.html#7129" class="Function">Σ↔R</a> <a id="7133" class="Symbol">=</a> <a id="7135" href="Cubical.Reflection.RecordEquiv.html#2101" class="Function">flipRecordAssoc</a> <a id="7151" href="Cubical.Reflection.RecordEquiv.html#7099" class="Function">R↔Σ</a>

  <a id="7158" class="Comment">-- Given an association list `al` for a correspondence R ↔ S, produces the list of</a>
  <a id="7243" class="Comment">-- clauses defining a function from R to S.</a>
  <a id="7289" class="Comment">-- The `prefix` will be either `Iso.fun` or `Iso.inv`.</a>
  <a id="7346" href="Cubical.Reflection.RecordEquiv.html#7346" class="Function">funClauses</a> <a id="7357" class="Symbol">:</a> <a id="7359" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="7366" class="Symbol">→</a> <a id="7368" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="7380" class="Symbol">→</a> <a id="7382" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7387" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="7398" href="Cubical.Reflection.RecordEquiv.html#7346" class="Function">funClauses</a> <a id="7409" href="Cubical.Reflection.RecordEquiv.html#7409" class="Bound">prefix</a> <a id="7416" href="Cubical.Reflection.RecordEquiv.html#7416" class="Bound">al</a> <a id="7419" class="Symbol">=</a>
    <a id="7425" href="Cubical.Data.List.Base.html#600" class="Function">List.map</a>
      <a id="7440" class="Comment">-- Introduce a new variable of the input type</a>
      <a id="7492" class="Symbol">(</a><a id="7493" href="Cubical.Reflection.RecordEquiv.html#6387" class="Function">mapClause</a>
        <a id="7511" class="Symbol">((</a><a id="7513" class="String">&quot;_&quot;</a> <a id="7517" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7519" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="7524" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a><a id="7533" class="Symbol">)</a> <a id="7535" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷_</a><a id="7537" class="Symbol">)</a>
        <a id="7547" class="Symbol">(λ</a> <a id="7550" href="Cubical.Reflection.RecordEquiv.html#7550" class="Bound">ps</a> <a id="7553" class="Symbol">→</a> <a id="7555" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="7562" href="Cubical.Reflection.RecordEquiv.html#7409" class="Bound">prefix</a> <a id="7569" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="7572" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="7578" class="Number">0</a> <a id="7580" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="7583" href="Cubical.Reflection.RecordEquiv.html#7550" class="Bound">ps</a><a id="7585" class="Symbol">))</a>
      <a id="7594" class="Comment">-- Each clause is a projection applied to the input variable</a>
      <a id="7661" class="Symbol">(</a><a id="7662" href="Cubical.Reflection.RecordEquiv.html#5401" class="Function">convertClauses</a> <a id="7677" href="Cubical.Reflection.RecordEquiv.html#7416" class="Bound">al</a> <a id="7680" class="Symbol">(</a><a id="7681" href="Cubical.Reflection.Base.html#577" class="Function">v</a> <a id="7683" class="Number">0</a><a id="7684" class="Symbol">))</a>

  <a id="7690" class="Comment">-- Given an association list `al` for a correspondence R ↔ S, produces the list of</a>
  <a id="7775" class="Comment">-- clauses defining the inverse path for the round-trip R → S → R.</a>
  <a id="7844" class="Comment">-- The `prefix` will be either `Iso.rightInv` or `Iso.leftInv`.</a>
  <a id="7910" href="Cubical.Reflection.RecordEquiv.html#7910" class="Function">pathClauses</a> <a id="7922" class="Symbol">:</a> <a id="7924" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="7931" class="Symbol">→</a> <a id="7933" href="Cubical.Reflection.RecordEquiv.html#1425" class="Function">RecordAssoc</a> <a id="7945" class="Symbol">→</a> <a id="7947" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7952" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="7963" href="Cubical.Reflection.RecordEquiv.html#7910" class="Function">pathClauses</a> <a id="7975" href="Cubical.Reflection.RecordEquiv.html#7975" class="Bound">prefix</a> <a id="7982" href="Cubical.Reflection.RecordEquiv.html#7982" class="Bound">al</a> <a id="7985" class="Symbol">=</a>
    <a id="7991" href="Cubical.Data.List.Base.html#600" class="Function">List.map</a>
      <a id="8006" class="Comment">-- Introduce a variable of the input type and an interval variable</a>
      <a id="8079" class="Symbol">(</a><a id="8080" href="Cubical.Reflection.RecordEquiv.html#6387" class="Function">mapClause</a>
        <a id="8098" class="Symbol">(λ</a> <a id="8101" href="Cubical.Reflection.RecordEquiv.html#8101" class="Bound">vs</a> <a id="8104" class="Symbol">→</a> <a id="8106" class="Symbol">(</a><a id="8107" class="String">&quot;_&quot;</a> <a id="8111" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8113" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="8118" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a><a id="8127" class="Symbol">)</a> <a id="8129" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8131" class="Symbol">(</a><a id="8132" class="String">&quot;_&quot;</a> <a id="8136" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8138" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="8143" class="Symbol">(</a><a id="8144" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="8150" class="Symbol">(</a><a id="8151" class="Keyword">quote</a> <a id="8157" href="Agda.Primitive.Cubical.html#150" class="Datatype">I</a><a id="8158" class="Symbol">)</a> <a id="8160" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8162" class="Symbol">))</a> <a id="8165" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8167" href="Cubical.Reflection.RecordEquiv.html#8101" class="Bound">vs</a><a id="8169" class="Symbol">)</a>
        <a id="8179" class="Symbol">(λ</a> <a id="8182" href="Cubical.Reflection.RecordEquiv.html#8182" class="Bound">ps</a> <a id="8185" class="Symbol">→</a> <a id="8187" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="8194" href="Cubical.Reflection.RecordEquiv.html#7975" class="Bound">prefix</a> <a id="8201" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="8204" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="8210" class="Number">1</a> <a id="8212" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="8215" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="8221" class="Number">0</a> <a id="8223" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="8226" href="Cubical.Reflection.RecordEquiv.html#8182" class="Bound">ps</a><a id="8228" class="Symbol">))</a>
      <a id="8237" class="Comment">-- The inverse condition at each clause holds by reflexivity</a>
      <a id="8304" class="Symbol">(</a><a id="8305" href="Cubical.Reflection.RecordEquiv.html#5401" class="Function">convertClauses</a> <a id="8320" class="Symbol">(</a><a id="8321" href="Cubical.Reflection.RecordEquiv.html#2281" class="Function">fstIdRecordAssoc</a> <a id="8338" href="Cubical.Reflection.RecordEquiv.html#7982" class="Bound">al</a><a id="8340" class="Symbol">)</a> <a id="8342" class="Symbol">(</a><a id="8343" href="Cubical.Reflection.Base.html#577" class="Function">v</a> <a id="8345" class="Number">1</a><a id="8346" class="Symbol">))</a>

<a id="8350" class="Comment">------------------------------------------------------------------------------------------</a>
<a id="8441" class="Comment">-- Main functions</a>
<a id="8459" class="Comment">------------------------------------------------------------------------------------------</a>

<a id="8551" class="Comment">-- Given a ΣFormat describing a correspondence between a record and nested Σ-type,</a>
<a id="8634" class="Comment">-- constructs an isomorphism between them as a term.</a>
<a id="8687" class="Comment">--</a>
<a id="8690" class="Comment">-- Because this term is a large pattern-matching lambda, it is better to use the</a>
<a id="8771" class="Comment">-- declare* functions below, which declare a named function.</a>
<a id="recordIsoΣTerm"></a><a id="8832" href="Cubical.Reflection.RecordEquiv.html#8832" class="Function">recordIsoΣTerm</a> <a id="8847" class="Symbol">:</a> <a id="8849" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="8857" class="Symbol">→</a> <a id="8859" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
<a id="8866" href="Cubical.Reflection.RecordEquiv.html#8832" class="Function">recordIsoΣTerm</a> <a id="8881" href="Cubical.Reflection.RecordEquiv.html#8881" class="Bound">σ</a> <a id="8883" class="Symbol">=</a> <a id="8885" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">R.pat-lam</a> <a id="8895" class="Symbol">(</a><a id="8896" href="Cubical.Reflection.RecordEquiv.html#6810" class="Function">recordIsoΣClauses</a> <a id="8914" href="Cubical.Reflection.RecordEquiv.html#8881" class="Bound">σ</a><a id="8915" class="Symbol">)</a> <a id="8917" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="8921" class="Comment">-- Given a name `idName`, a ΣFormat `σ` describing a correspondence between a record and</a>
<a id="9010" class="Comment">-- nested Σ-type, and the name `recordName` of the record type, declares a function with</a>
<a id="9099" class="Comment">-- name `idName` defining an isomorphism between the two types (with implicit parameters</a>
<a id="9188" class="Comment">-- corresponding to the parameters and indices of the record type).</a>
<a id="declareRecordIsoΣ&#39;"></a><a id="9256" href="Cubical.Reflection.RecordEquiv.html#9256" class="Function">declareRecordIsoΣ&#39;</a> <a id="9275" class="Symbol">:</a> <a id="9277" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9284" class="Symbol">→</a> <a id="9286" href="Cubical.Reflection.RecordEquiv.html#1934" class="Datatype">ΣFormat</a> <a id="9294" class="Symbol">→</a> <a id="9296" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9303" class="Symbol">→</a> <a id="9305" href="Agda.Builtin.Reflection.html#8602" class="Postulate">R.TC</a> <a id="9310" href="Cubical.Data.Unit.Base.html#172" class="Record">Unit</a>
<a id="9315" href="Cubical.Reflection.RecordEquiv.html#9256" class="Function">declareRecordIsoΣ&#39;</a> <a id="9334" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">idName</a> <a id="9341" href="Cubical.Reflection.RecordEquiv.html#9341" class="Bound">σ</a> <a id="9343" href="Cubical.Reflection.RecordEquiv.html#9343" class="Bound">recordName</a> <a id="9354" class="Symbol">=</a>
  <a id="9358" href="Cubical.Reflection.RecordEquiv.html#3849" class="Function">recordName→isoTy</a> <a id="9375" href="Cubical.Reflection.RecordEquiv.html#9343" class="Bound">recordName</a> <a id="9386" href="Cubical.Reflection.RecordEquiv.html#9341" class="Bound">σ</a> <a id="9388" href="Cubical.Reflection.Base.html#302" class="Function Operator">&gt;&gt;=</a> <a id="9392" class="Symbol">λ</a> <a id="9394" href="Cubical.Reflection.RecordEquiv.html#9394" class="Bound">isoTy</a> <a id="9400" class="Symbol">→</a>
  <a id="9404" href="Agda.Builtin.Reflection.html#9453" class="Postulate">R.declareDef</a> <a id="9417" class="Symbol">(</a><a id="9418" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="9423" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">idName</a><a id="9429" class="Symbol">)</a> <a id="9431" href="Cubical.Reflection.RecordEquiv.html#9394" class="Bound">isoTy</a> <a id="9437" href="Cubical.Reflection.Base.html#338" class="Function Operator">&gt;&gt;</a>
  <a id="9442" href="Agda.Builtin.Reflection.html#9649" class="Postulate">R.defineFun</a> <a id="9454" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">idName</a> <a id="9461" class="Symbol">(</a><a id="9462" href="Cubical.Reflection.RecordEquiv.html#6810" class="Function">recordIsoΣClauses</a> <a id="9480" href="Cubical.Reflection.RecordEquiv.html#9341" class="Bound">σ</a><a id="9481" class="Symbol">)</a>

<a id="9484" class="Comment">-- Given a name `idName` and the name `recordName` of a record type, declares a function</a>
<a id="9573" class="Comment">-- with name `idName` defining an isomorphism from the record type to the right-associated</a>
<a id="9664" class="Comment">-- Σ-type corresponding to its list of fields (with implicit parameters corresponding to</a>
<a id="9753" class="Comment">-- the parameters and indices of the record type).</a>
<a id="declareRecordIsoΣ"></a><a id="9804" href="Cubical.Reflection.RecordEquiv.html#9804" class="Function">declareRecordIsoΣ</a> <a id="9822" class="Symbol">:</a> <a id="9824" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9831" class="Symbol">→</a> <a id="9833" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9840" class="Symbol">→</a> <a id="9842" href="Agda.Builtin.Reflection.html#8602" class="Postulate">R.TC</a> <a id="9847" href="Cubical.Data.Unit.Base.html#172" class="Record">Unit</a>
<a id="9852" href="Cubical.Reflection.RecordEquiv.html#9804" class="Function">declareRecordIsoΣ</a> <a id="9870" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">idName</a> <a id="9877" href="Cubical.Reflection.RecordEquiv.html#9877" class="Bound">recordName</a> <a id="9888" class="Symbol">=</a>
  <a id="9892" href="Agda.Builtin.Reflection.html#9732" class="Postulate">R.getDefinition</a> <a id="9908" href="Cubical.Reflection.RecordEquiv.html#9877" class="Bound">recordName</a> <a id="9919" href="Cubical.Reflection.Base.html#302" class="Function Operator">&gt;&gt;=</a> <a id="9923" class="Symbol">λ</a> <a id="9925" class="Keyword">where</a>
  <a id="9933" class="Symbol">(</a><a id="9934" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">R.record-type</a> <a id="9948" class="Symbol">_</a> <a id="9950" href="Cubical.Reflection.RecordEquiv.html#9950" class="Bound">fs</a><a id="9952" class="Symbol">)</a> <a id="9954" class="Symbol">→</a>
    <a id="9960" class="Keyword">let</a> <a id="9964" href="Cubical.Reflection.RecordEquiv.html#9964" class="Bound">σ</a> <a id="9966" class="Symbol">=</a> <a id="9968" href="Cubical.Reflection.RecordEquiv.html#2483" class="Function">List→ΣFormat</a> <a id="9981" class="Symbol">(</a><a id="9982" href="Cubical.Data.List.Base.html#600" class="Function">List.map</a> <a id="9991" class="Symbol">(λ</a> <a id="9994" class="Symbol">{(</a><a id="9996" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="10002" class="Symbol">_</a> <a id="10004" href="Cubical.Reflection.RecordEquiv.html#10004" class="Bound">n</a><a id="10005" class="Symbol">)</a> <a id="10007" class="Symbol">→</a> <a id="10009" href="Cubical.Reflection.RecordEquiv.html#10004" class="Bound">n</a><a id="10010" class="Symbol">})</a> <a id="10013" href="Cubical.Reflection.RecordEquiv.html#9950" class="Bound">fs</a><a id="10015" class="Symbol">)</a> <a id="10017" class="Keyword">in</a>
    <a id="10024" href="Cubical.Reflection.RecordEquiv.html#9256" class="Function">declareRecordIsoΣ&#39;</a> <a id="10043" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">idName</a> <a id="10050" href="Cubical.Reflection.RecordEquiv.html#9964" class="Bound">σ</a> <a id="10052" href="Cubical.Reflection.RecordEquiv.html#9877" class="Bound">recordName</a>
  <a id="10065" class="CatchallClause Symbol">_</a> <a id="10067" class="Symbol">→</a>
    <a id="10073" href="Agda.Builtin.Reflection.html#8815" class="Postulate">R.typeError</a> <a id="10085" class="Symbol">(</a><a id="10086" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">R.strErr</a> <a id="10095" class="String">&quot;Not a record type name:&quot;</a> <a id="10121" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10123" href="Agda.Builtin.Reflection.html#8315" class="InductiveConstructor">R.nameErr</a> <a id="10133" href="Cubical.Reflection.RecordEquiv.html#9877" class="Bound">recordName</a> <a id="10144" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10146" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10148" class="Symbol">)</a>


<a id="10152" class="Comment">------------------------------------------------------------------------------------------</a>
<a id="10243" class="Comment">-- Examples</a>
<a id="10255" class="Comment">------------------------------------------------------------------------------------------</a>

<a id="10347" class="Keyword">private</a>
  <a id="10357" class="Keyword">module</a> <a id="Example"></a><a id="10364" href="Cubical.Reflection.RecordEquiv.html#10364" class="Module">Example</a> <a id="10372" class="Keyword">where</a>
    <a id="10382" class="Keyword">variable</a>
      <a id="10397" href="Cubical.Reflection.RecordEquiv.html#10397" class="Generalizable">ℓ</a> <a id="10399" href="Cubical.Reflection.RecordEquiv.html#10399" class="Generalizable">ℓ&#39;</a> <a id="10402" class="Symbol">:</a> <a id="10404" href="Agda.Primitive.html#742" class="Postulate">Level</a>
      <a id="10416" href="Cubical.Reflection.RecordEquiv.html#10416" class="Generalizable">A</a> <a id="10418" class="Symbol">:</a> <a id="10420" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10425" href="Cubical.Reflection.RecordEquiv.html#10397" class="Generalizable">ℓ</a>
      <a id="10433" href="Cubical.Reflection.RecordEquiv.html#10433" class="Generalizable">B</a> <a id="10435" class="Symbol">:</a> <a id="10437" href="Cubical.Reflection.RecordEquiv.html#10416" class="Generalizable">A</a> <a id="10439" class="Symbol">→</a> <a id="10441" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10446" href="Cubical.Reflection.RecordEquiv.html#10399" class="Generalizable">ℓ&#39;</a>

    <a id="10454" class="Keyword">record</a> <a id="Example.Example0"></a><a id="10461" href="Cubical.Reflection.RecordEquiv.html#10461" class="Record">Example0</a> <a id="10470" class="Symbol">{</a><a id="10471" href="Cubical.Reflection.RecordEquiv.html#10471" class="Bound">A</a> <a id="10473" class="Symbol">:</a> <a id="10475" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10480" href="Cubical.Reflection.RecordEquiv.html#10397" class="Generalizable">ℓ</a><a id="10481" class="Symbol">}</a> <a id="10483" class="Symbol">(</a><a id="10484" href="Cubical.Reflection.RecordEquiv.html#10484" class="Bound">B</a> <a id="10486" class="Symbol">:</a> <a id="10488" href="Cubical.Reflection.RecordEquiv.html#10471" class="Bound">A</a> <a id="10490" class="Symbol">→</a> <a id="10492" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10497" href="Cubical.Reflection.RecordEquiv.html#10399" class="Generalizable">ℓ&#39;</a><a id="10499" class="Symbol">)</a> <a id="10501" class="Symbol">:</a> <a id="10503" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10508" class="Symbol">(</a><a id="10509" href="Agda.Primitive.html#961" class="Primitive">ℓ-max</a> <a id="10515" href="Cubical.Reflection.RecordEquiv.html#10480" class="Bound">ℓ</a> <a id="10517" href="Cubical.Reflection.RecordEquiv.html#10497" class="Bound">ℓ&#39;</a><a id="10519" class="Symbol">)</a> <a id="10521" class="Keyword">where</a>
      <a id="10533" class="Keyword">no-eta-equality</a> <a id="10549" class="Comment">-- works with or without eta equality</a>
      <a id="10593" class="Keyword">field</a>
        <a id="Example.Example0.cool"></a><a id="10607" href="Cubical.Reflection.RecordEquiv.html#10607" class="Field">cool</a> <a id="10612" class="Symbol">:</a> <a id="10614" href="Cubical.Reflection.RecordEquiv.html#10471" class="Bound">A</a>
        <a id="Example.Example0.fun"></a><a id="10624" href="Cubical.Reflection.RecordEquiv.html#10624" class="Field">fun</a> <a id="10628" class="Symbol">:</a> <a id="10630" href="Cubical.Reflection.RecordEquiv.html#10471" class="Bound">A</a>
        <a id="Example.Example0.wow"></a><a id="10640" href="Cubical.Reflection.RecordEquiv.html#10640" class="Field">wow</a> <a id="10644" class="Symbol">:</a> <a id="10646" href="Cubical.Reflection.RecordEquiv.html#10484" class="Bound">B</a> <a id="10648" href="Cubical.Reflection.RecordEquiv.html#10607" class="Field">cool</a>

    <a id="10658" class="Comment">-- Declares a function `Example0IsoΣ` that gives an isomorphism between the record type and a</a>
    <a id="10756" class="Comment">-- right-associated nested Σ-type (with the parameters to Example0 as implict arguments).</a>
    <a id="10850" class="Keyword">unquoteDecl</a> <a id="Example.Example0IsoΣ"></a><a id="10862" href="Cubical.Reflection.RecordEquiv.html#10862" class="Function">Example0IsoΣ</a> <a id="10875" class="Symbol">=</a> <a id="10877" href="Cubical.Reflection.RecordEquiv.html#9804" class="Function">declareRecordIsoΣ</a> <a id="10895" href="Cubical.Reflection.RecordEquiv.html#10862" class="Function">Example0IsoΣ</a> <a id="10908" class="Symbol">(</a><a id="10909" class="Keyword">quote</a> <a id="10915" href="Cubical.Reflection.RecordEquiv.html#10461" class="Record">Example0</a><a id="10923" class="Symbol">)</a>

    <a id="10930" class="Comment">-- `Example0IsoΣ` has the type we expect</a>
    <a id="Example.test0"></a><a id="10975" href="Cubical.Reflection.RecordEquiv.html#10975" class="Function">test0</a> <a id="10981" class="Symbol">:</a> <a id="10983" href="Cubical.Foundations.Isomorphism.html#773" class="Record">Iso</a> <a id="10987" class="Symbol">(</a><a id="10988" href="Cubical.Reflection.RecordEquiv.html#10461" class="Record">Example0</a> <a id="10997" href="Cubical.Reflection.RecordEquiv.html#10433" class="Generalizable">B</a><a id="10998" class="Symbol">)</a> <a id="11000" class="Symbol">(</a><a id="11001" href="Cubical.Core.Primitives.html#6268" class="Function">Σ[</a> <a id="11004" href="Cubical.Reflection.RecordEquiv.html#11004" class="Bound">a</a> <a id="11006" href="Cubical.Core.Primitives.html#6268" class="Function">∈</a> <a id="11008" href="Cubical.Reflection.RecordEquiv.html#10416" class="Generalizable">A</a> <a id="11010" href="Cubical.Core.Primitives.html#6268" class="Function">]</a> <a id="11012" class="Symbol">(</a><a id="11013" href="Cubical.Core.Primitives.html#6268" class="Function">Σ[</a> <a id="11016" href="Cubical.Reflection.RecordEquiv.html#11016" class="Symbol">_</a> <a id="11018" href="Cubical.Core.Primitives.html#6268" class="Function">∈</a> <a id="11020" href="Cubical.Reflection.RecordEquiv.html#10416" class="Generalizable">A</a> <a id="11022" href="Cubical.Core.Primitives.html#6268" class="Function">]</a> <a id="11024" href="Cubical.Reflection.RecordEquiv.html#10433" class="Generalizable">B</a> <a id="11026" href="Cubical.Reflection.RecordEquiv.html#11004" class="Bound">a</a><a id="11027" class="Symbol">))</a>
    <a id="11034" href="Cubical.Reflection.RecordEquiv.html#10975" class="Function">test0</a> <a id="11040" class="Symbol">=</a> <a id="11042" href="Cubical.Reflection.RecordEquiv.html#10862" class="Function">Example0IsoΣ</a>

    <a id="11060" class="Comment">-- A record with no fields is isomorphic to Unit</a>

    <a id="11114" class="Keyword">record</a> <a id="Example.Example1"></a><a id="11121" href="Cubical.Reflection.RecordEquiv.html#11121" class="Record">Example1</a> <a id="11130" class="Symbol">:</a> <a id="11132" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="11137" class="Keyword">where</a>

    <a id="11148" class="Keyword">unquoteDecl</a> <a id="Example.Example1IsoΣ"></a><a id="11160" href="Cubical.Reflection.RecordEquiv.html#11160" class="Function">Example1IsoΣ</a> <a id="11173" class="Symbol">=</a> <a id="11175" href="Cubical.Reflection.RecordEquiv.html#9804" class="Function">declareRecordIsoΣ</a> <a id="11193" href="Cubical.Reflection.RecordEquiv.html#11160" class="Function">Example1IsoΣ</a> <a id="11206" class="Symbol">(</a><a id="11207" class="Keyword">quote</a> <a id="11213" href="Cubical.Reflection.RecordEquiv.html#11121" class="Record">Example1</a><a id="11221" class="Symbol">)</a>

    <a id="Example.test1"></a><a id="11228" href="Cubical.Reflection.RecordEquiv.html#11228" class="Function">test1</a> <a id="11234" class="Symbol">:</a> <a id="11236" href="Cubical.Foundations.Isomorphism.html#773" class="Record">Iso</a> <a id="11240" href="Cubical.Reflection.RecordEquiv.html#11121" class="Record">Example1</a> <a id="11249" href="Cubical.Data.Unit.Base.html#172" class="Record">Unit</a>
    <a id="11258" href="Cubical.Reflection.RecordEquiv.html#11228" class="Function">test1</a> <a id="11264" class="Symbol">=</a> <a id="11266" href="Cubical.Reflection.RecordEquiv.html#11160" class="Function">Example1IsoΣ</a>
</pre></body></html>