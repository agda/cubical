<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Reflection.RecordEquiv</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-

  Reflection-based tools for converting between iterated record types, particularly between
  record types and iterated Σ-types.

  The main functions are `declareRecordIsoΣ` and `declareRecordIsoΣ`. See end of file for
  example usage.

-}</a>
<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--no-exact-split</a> <a id="275" class="Symbol">#-}</a>
<a id="279" class="Keyword">module</a> <a id="286" href="Cubical.Reflection.RecordEquiv.html" class="Module">Cubical.Reflection.RecordEquiv</a> <a id="317" class="Keyword">where</a>

<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Cubical.Foundations.Isomorphism.html" class="Module">Cubical.Foundations.Isomorphism</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Cubical.Foundations.Equiv.html" class="Module">Cubical.Foundations.Equiv</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a> <a id="476" class="Symbol">as</a> <a id="479" class="Module">List</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Cubical.Data.Maybe.html" class="Module">Cubical.Data.Maybe</a> <a id="544" class="Symbol">as</a> <a id="547" class="Module">Maybe</a>
<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>

<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="617" class="Keyword">import</a> <a id="624" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="648" class="Symbol">as</a> <a id="651" class="Module">R</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>

<a id="690" class="Comment">-- Intended to represent a (possibly nested) field of a record type. For example, the list</a>
<a id="781" class="Comment">-- &quot;snd&quot; ∷ fst&quot; ∷ []` would represent the field `.fst .snd`.</a>
<a id="Projections"></a><a id="842" href="Cubical.Reflection.RecordEquiv.html#842" class="Function">Projections</a> <a id="854" class="Symbol">=</a> <a id="856" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="861" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a>

<a id="869" class="Comment">-- Intended to represent a bijection between two record types by an association list</a>
<a id="954" class="Comment">-- between (possibly nested) fields of the one and the other. The `Maybe`s are included to</a>
<a id="1045" class="Comment">-- allow dropping fields of Unit (or other definitionally unique) type.</a>
<a id="1117" class="Comment">--</a>
<a id="1120" class="Comment">-- For example, the correspondence</a>
<a id="1155" class="Comment">--</a>
<a id="1158" class="Comment">--   .fst .fst ↔ .snd</a>
<a id="1180" class="Comment">--   .fst .snd ↔ .fst</a>
<a id="1202" class="Comment">--   .snd ↔ ∅</a>
<a id="1216" class="Comment">--</a>
<a id="1219" class="Comment">-- between (A × B) × Unit and B × A would be represented by the list</a>
<a id="1288" class="Comment">--</a>
<a id="1291" class="Comment">--   [ (just [&quot;fst&quot;; &quot;fst&quot;] , just [&quot;snd&quot;])</a>
<a id="1335" class="Comment">--   ; (just [&quot;snd&quot;; &quot;fst&quot;] , just [&quot;fst&quot;])</a>
<a id="1379" class="Comment">--   ; (just [&quot;snd&quot;] , nothing)</a>
<a id="1411" class="Comment">--   ]</a>
<a id="RecordAssoc"></a><a id="1418" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="1430" class="Symbol">=</a> <a id="1432" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="1444" href="Cubical.Reflection.RecordEquiv.html#842" class="Function">Projections</a> <a id="1456" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="1458" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="1464" href="Cubical.Reflection.RecordEquiv.html#842" class="Function">Projections</a><a id="1475" class="Symbol">)</a>

<a id="1478" class="Comment">-- Describes a correspondence between a non-nested record and an iterated Σ-type; more</a>
<a id="1565" class="Comment">-- convenient to work with than RecordAssoc in this special case, which is the most common</a>
<a id="1656" class="Comment">-- one. For example,</a>
<a id="1677" class="Comment">--</a>
<a id="1680" class="Comment">--   leaf &quot;a&quot; , (leaf &quot;b&quot; , leaf &quot;c&quot;)</a>
<a id="1718" class="Comment">--</a>
<a id="1721" class="Comment">-- describes the following RecordAssoc:</a>
<a id="1761" class="Comment">--</a>
<a id="1764" class="Comment">--   .fst ↔ .a</a>
<a id="1779" class="Comment">--   .snd .fst ↔ .b</a>
<a id="1799" class="Comment">--   .snd .snd ↔ .c</a>
<a id="1819" class="Comment">--</a>
<a id="1822" class="Comment">-- The `unit` constructor is the correspondence between Unit (&quot;nullary Σ&quot;) and the empty</a>
<a id="1911" class="Comment">-- record.</a>
<a id="1922" class="Keyword">data</a> <a id="ΣFormat"></a><a id="1927" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="1935" class="Symbol">:</a> <a id="1937" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1942" class="Keyword">where</a>
  <a id="ΣFormat.leaf"></a><a id="1950" href="Cubical.Reflection.RecordEquiv.html#1950" class="InductiveConstructor">leaf</a> <a id="1955" class="Symbol">:</a> <a id="1957" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="1964" class="Symbol">→</a> <a id="1966" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a>
  <a id="ΣFormat._,_"></a><a id="1976" href="Cubical.Reflection.RecordEquiv.html#1976" class="InductiveConstructor Operator">_,_</a> <a id="1980" class="Symbol">:</a> <a id="1982" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="1990" class="Symbol">→</a> <a id="1992" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="2000" class="Symbol">→</a> <a id="2002" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a>
  <a id="ΣFormat.unit"></a><a id="2012" href="Cubical.Reflection.RecordEquiv.html#2012" class="InductiveConstructor">unit</a> <a id="2017" class="Symbol">:</a> <a id="2019" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a>

<a id="2028" class="Keyword">infixr</a> <a id="2035" class="Number">4</a> <a id="2037" href="Cubical.Reflection.RecordEquiv.html#1976" class="InductiveConstructor Operator">_,_</a>

<a id="2042" class="Comment">-- Inverse of a correspondence between record types</a>
<a id="flipRecordAssoc"></a><a id="2094" href="Cubical.Reflection.RecordEquiv.html#2094" class="Function">flipRecordAssoc</a> <a id="2110" class="Symbol">:</a> <a id="2112" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="2124" class="Symbol">→</a> <a id="2126" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a>
<a id="2138" href="Cubical.Reflection.RecordEquiv.html#2094" class="Function">flipRecordAssoc</a> <a id="2154" class="Symbol">=</a> <a id="2156" href="Cubical.Data.List.Base.html#617" class="Function">List.map</a> <a id="2165" class="Symbol">λ</a> <a id="2167" class="Symbol">{</a><a id="2168" href="Cubical.Reflection.RecordEquiv.html#2168" class="Bound">p</a> <a id="2170" class="Symbol">.</a><a id="2171" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="2175" class="Symbol">→</a> <a id="2177" href="Cubical.Reflection.RecordEquiv.html#2168" class="Bound">p</a> <a id="2179" class="Symbol">.</a><a id="2180" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a><a id="2183" class="Symbol">;</a> <a id="2185" href="Cubical.Reflection.RecordEquiv.html#2185" class="Bound">p</a> <a id="2187" class="Symbol">.</a><a id="2188" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2192" class="Symbol">→</a> <a id="2194" href="Cubical.Reflection.RecordEquiv.html#2185" class="Bound">p</a> <a id="2196" class="Symbol">.</a><a id="2197" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2200" class="Symbol">}</a>

<a id="2203" class="Comment">-- The identity correspondence on the domain of a given correspondence</a>
<a id="fstIdRecordAssoc"></a><a id="2274" href="Cubical.Reflection.RecordEquiv.html#2274" class="Function">fstIdRecordAssoc</a> <a id="2291" class="Symbol">:</a> <a id="2293" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="2305" class="Symbol">→</a> <a id="2307" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a>
<a id="2319" href="Cubical.Reflection.RecordEquiv.html#2274" class="Function">fstIdRecordAssoc</a> <a id="2336" class="Symbol">=</a> <a id="2338" href="Cubical.Data.List.Base.html#617" class="Function">List.map</a> <a id="2347" class="Symbol">λ</a> <a id="2349" class="Symbol">{</a><a id="2350" href="Cubical.Reflection.RecordEquiv.html#2350" class="Bound">p</a> <a id="2352" class="Symbol">.</a><a id="2353" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="2357" class="Symbol">→</a> <a id="2359" href="Cubical.Reflection.RecordEquiv.html#2350" class="Bound">p</a> <a id="2361" class="Symbol">.</a><a id="2362" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2365" class="Symbol">;</a> <a id="2367" href="Cubical.Reflection.RecordEquiv.html#2367" class="Bound">p</a> <a id="2369" class="Symbol">.</a><a id="2370" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2374" class="Symbol">→</a> <a id="2376" href="Cubical.Reflection.RecordEquiv.html#2367" class="Bound">p</a> <a id="2378" class="Symbol">.</a><a id="2379" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2382" class="Symbol">}</a>

<a id="2385" class="Comment">-- Constructs a ΣFormat from a list of fields meant to represent a right-associated Σ-type</a>
<a id="List→ΣFormat"></a><a id="2476" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="2489" class="Symbol">:</a> <a id="2491" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2496" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="2503" class="Symbol">→</a> <a id="2505" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a>
<a id="2513" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="2526" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2529" class="Symbol">=</a> <a id="2531" href="Cubical.Reflection.RecordEquiv.html#2012" class="InductiveConstructor">unit</a>
<a id="2536" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="2549" class="Symbol">(</a><a id="2550" href="Cubical.Reflection.RecordEquiv.html#2550" class="Bound">x</a> <a id="2552" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2554" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2556" class="Symbol">)</a> <a id="2558" class="Symbol">=</a> <a id="2560" href="Cubical.Reflection.RecordEquiv.html#1950" class="InductiveConstructor">leaf</a> <a id="2565" href="Cubical.Reflection.RecordEquiv.html#2550" class="Bound">x</a>
<a id="2567" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="2580" class="Symbol">(</a><a id="2581" href="Cubical.Reflection.RecordEquiv.html#2581" class="Bound">x</a> <a id="2583" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2585" href="Cubical.Reflection.RecordEquiv.html#2585" class="Bound">y</a> <a id="2587" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2589" href="Cubical.Reflection.RecordEquiv.html#2589" class="Bound">xs</a><a id="2591" class="Symbol">)</a> <a id="2593" class="Symbol">=</a> <a id="2595" href="Cubical.Reflection.RecordEquiv.html#1950" class="InductiveConstructor">leaf</a> <a id="2600" href="Cubical.Reflection.RecordEquiv.html#2581" class="Bound">x</a> <a id="2602" href="Cubical.Reflection.RecordEquiv.html#1976" class="InductiveConstructor Operator">,</a> <a id="2604" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="2617" class="Symbol">(</a><a id="2618" href="Cubical.Reflection.RecordEquiv.html#2585" class="Bound">y</a> <a id="2620" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2622" href="Cubical.Reflection.RecordEquiv.html#2589" class="Bound">xs</a><a id="2624" class="Symbol">)</a>

<a id="2627" class="Comment">-- Converts a ΣFormat to an association list as described above.</a>
<a id="2692" class="Comment">-- The domain of the RecordAssoc is the record type, the codomain is the Σ-type.</a>
<a id="ΣFormat→RecordAssoc"></a><a id="2773" href="Cubical.Reflection.RecordEquiv.html#2773" class="Function">ΣFormat→RecordAssoc</a> <a id="2793" class="Symbol">:</a> <a id="2795" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="2803" class="Symbol">→</a> <a id="2805" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a>
<a id="2817" href="Cubical.Reflection.RecordEquiv.html#2773" class="Function">ΣFormat→RecordAssoc</a> <a id="2837" class="Symbol">=</a> <a id="2839" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="2842" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2847" class="Keyword">where</a>
  <a id="2855" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="2858" class="Symbol">:</a> <a id="2860" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2865" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="2872" class="Symbol">→</a> <a id="2874" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="2882" class="Symbol">→</a> <a id="2884" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a>
  <a id="2898" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="2901" href="Cubical.Reflection.RecordEquiv.html#2901" class="Bound">prefix</a> <a id="2908" href="Cubical.Reflection.RecordEquiv.html#2012" class="InductiveConstructor">unit</a> <a id="2913" class="Symbol">=</a> <a id="2915" href="Cubical.Data.List.Base.html#299" class="Function Operator">[</a> <a id="2917" href="Cubical.Data.Maybe.Base.html#193" class="InductiveConstructor">nothing</a> <a id="2925" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2927" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="2932" href="Cubical.Reflection.RecordEquiv.html#2901" class="Bound">prefix</a> <a id="2939" href="Cubical.Data.List.Base.html#299" class="Function Operator">]</a>
  <a id="2943" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="2946" href="Cubical.Reflection.RecordEquiv.html#2946" class="Bound">prefix</a> <a id="2953" class="Symbol">(</a><a id="2954" href="Cubical.Reflection.RecordEquiv.html#1950" class="InductiveConstructor">leaf</a> <a id="2959" href="Cubical.Reflection.RecordEquiv.html#2959" class="Bound">fieldName</a><a id="2968" class="Symbol">)</a> <a id="2970" class="Symbol">=</a> <a id="2972" href="Cubical.Data.List.Base.html#299" class="Function Operator">[</a> <a id="2974" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="2979" href="Cubical.Data.List.Base.html#299" class="Function Operator">[</a> <a id="2981" href="Cubical.Reflection.RecordEquiv.html#2959" class="Bound">fieldName</a> <a id="2991" href="Cubical.Data.List.Base.html#299" class="Function Operator">]</a> <a id="2993" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2995" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="3000" href="Cubical.Reflection.RecordEquiv.html#2946" class="Bound">prefix</a> <a id="3007" href="Cubical.Data.List.Base.html#299" class="Function Operator">]</a>
  <a id="3011" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="3014" href="Cubical.Reflection.RecordEquiv.html#3014" class="Bound">prefix</a> <a id="3021" class="Symbol">(</a><a id="3022" href="Cubical.Reflection.RecordEquiv.html#3022" class="Bound">sig₁</a> <a id="3027" href="Cubical.Reflection.RecordEquiv.html#1976" class="InductiveConstructor Operator">,</a> <a id="3029" href="Cubical.Reflection.RecordEquiv.html#3029" class="Bound">sig₂</a><a id="3033" class="Symbol">)</a> <a id="3035" class="Symbol">=</a>
    <a id="3041" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="3044" class="Symbol">(</a><a id="3045" class="Keyword">quote</a> <a id="3051" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="3055" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3057" href="Cubical.Reflection.RecordEquiv.html#3014" class="Bound">prefix</a><a id="3063" class="Symbol">)</a> <a id="3065" href="Cubical.Reflection.RecordEquiv.html#3022" class="Bound">sig₁</a> <a id="3070" href="Cubical.Data.List.Base.html#336" class="Function Operator">++</a> <a id="3073" href="Cubical.Reflection.RecordEquiv.html#2855" class="Function">go</a> <a id="3076" class="Symbol">(</a><a id="3077" class="Keyword">quote</a> <a id="3083" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="3087" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3089" href="Cubical.Reflection.RecordEquiv.html#3014" class="Bound">prefix</a><a id="3095" class="Symbol">)</a> <a id="3097" href="Cubical.Reflection.RecordEquiv.html#3029" class="Bound">sig₂</a>

<a id="3103" class="Comment">-- Define a reflected type with the shape of the Σ-type described by a ΣFormat.</a>
<a id="3183" class="Comment">-- The type arguments to the Σ are filled in with unsolved metavariables.</a>
<a id="ΣFormat→Ty"></a><a id="3257" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3268" class="Symbol">:</a> <a id="3270" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="3278" class="Symbol">→</a> <a id="3280" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a>
<a id="3287" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3298" href="Cubical.Reflection.RecordEquiv.html#2012" class="InductiveConstructor">unit</a> <a id="3303" class="Symbol">=</a> <a id="3305" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3311" class="Symbol">(</a><a id="3312" class="Keyword">quote</a> <a id="3318" href="Cubical.Data.Unit.Base.html#149" class="Record">Unit</a><a id="3322" class="Symbol">)</a> <a id="3324" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3327" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Cubical.Reflection.RecordEquiv.html#1950" class="InductiveConstructor">leaf</a> <a id="3344" class="Symbol">_)</a> <a id="3347" class="Symbol">=</a> <a id="3349" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a>
<a id="3359" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3370" class="Symbol">(</a><a id="3371" href="Cubical.Reflection.RecordEquiv.html#3371" class="Bound">sig₁</a> <a id="3376" href="Cubical.Reflection.RecordEquiv.html#1976" class="InductiveConstructor Operator">,</a> <a id="3378" href="Cubical.Reflection.RecordEquiv.html#3378" class="Bound">sig₂</a><a id="3382" class="Symbol">)</a> <a id="3384" class="Symbol">=</a>
  <a id="3388" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3394" class="Symbol">(</a><a id="3395" class="Keyword">quote</a> <a id="3401" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="3402" class="Symbol">)</a> <a id="3404" class="Symbol">(</a><a id="3405" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3416" href="Cubical.Reflection.RecordEquiv.html#3371" class="Bound">sig₁</a> <a id="3421" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="3424" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">R.lam</a> <a id="3430" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">R.visible</a> <a id="3440" class="Symbol">(</a><a id="3441" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="3447" class="String">&quot;_&quot;</a> <a id="3451" class="Symbol">(</a><a id="3452" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="3463" href="Cubical.Reflection.RecordEquiv.html#3378" class="Bound">sig₂</a><a id="3467" class="Symbol">))</a> <a id="3470" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="3473" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3475" class="Symbol">)</a>

<a id="3478" class="Comment">-- Given the name of a record type and a ΣFormat describing an isomorphism between this</a>
<a id="3566" class="Comment">-- type and a Σ-type, constructs a reflected type of isomorphisms between the record and</a>
<a id="3655" class="Comment">-- Σ-type. If the record type takes parameters or indices, then the result is a similarly</a>
<a id="3745" class="Comment">-- parameterized family of isomorphisms. All parameters to the isomorphism are made</a>
<a id="3829" class="Comment">-- implicit.</a>
<a id="recordName→isoTy"></a><a id="3842" href="Cubical.Reflection.RecordEquiv.html#3842" class="Function">recordName→isoTy</a> <a id="3859" class="Symbol">:</a> <a id="3861" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="3868" class="Symbol">→</a> <a id="3870" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="3878" class="Symbol">→</a> <a id="3880" href="Agda.Builtin.Reflection.html#8617" class="Postulate">R.TC</a> <a id="3885" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
<a id="3892" href="Cubical.Reflection.RecordEquiv.html#3842" class="Function">recordName→isoTy</a> <a id="3909" href="Cubical.Reflection.RecordEquiv.html#3909" class="Bound">name</a> <a id="3914" href="Cubical.Reflection.RecordEquiv.html#3914" class="Bound">σ</a> <a id="3916" class="Symbol">=</a>
  <a id="3920" href="Agda.Builtin.Reflection.html#8893" class="Postulate">R.inferType</a> <a id="3932" class="Symbol">(</a><a id="3933" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="3939" href="Cubical.Reflection.RecordEquiv.html#3909" class="Bound">name</a> <a id="3944" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3946" class="Symbol">)</a> <a id="3948" href="Cubical.Reflection.Base.html#295" class="Function Operator">&gt;&gt;=</a> <a id="3952" href="Agda.Builtin.Reflection.html#8972" class="Postulate">R.normalise</a> <a id="3964" href="Cubical.Reflection.Base.html#295" class="Function Operator">&gt;&gt;=</a> <a id="3968" href="Cubical.Reflection.RecordEquiv.html#4057" class="Function">go</a> <a id="3971" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="3976" class="Keyword">where</a>
  <a id="3984" href="Cubical.Reflection.RecordEquiv.html#3984" class="Function">σTy</a> <a id="3988" class="Symbol">=</a> <a id="3990" href="Cubical.Reflection.RecordEquiv.html#3257" class="Function">ΣFormat→Ty</a> <a id="4001" href="Cubical.Reflection.RecordEquiv.html#3914" class="Bound">σ</a>

  <a id="4006" class="Comment">-- Recurses on the type of the named record type</a>
  <a id="4057" href="Cubical.Reflection.RecordEquiv.html#4057" class="Function">go</a> <a id="4060" class="Symbol">:</a> <a id="4062" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4067" href="Agda.Builtin.Reflection.html#3615" class="Datatype">R.ArgInfo</a> <a id="4077" class="Symbol">→</a> <a id="4079" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a> <a id="4086" class="Symbol">→</a> <a id="4088" href="Agda.Builtin.Reflection.html#8617" class="Postulate">R.TC</a> <a id="4093" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
  <a id="4102" href="Cubical.Reflection.RecordEquiv.html#4057" class="Function">go</a> <a id="4105" href="Cubical.Reflection.RecordEquiv.html#4105" class="Bound">acc</a> <a id="4109" class="Symbol">(</a><a id="4110" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">R.pi</a> <a id="4115" class="Symbol">(</a><a id="4116" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4122" href="Cubical.Reflection.RecordEquiv.html#4122" class="Bound">i</a> <a id="4124" href="Cubical.Reflection.RecordEquiv.html#4124" class="Bound">argTy</a><a id="4129" class="Symbol">)</a> <a id="4131" class="Symbol">(</a><a id="4132" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="4138" href="Cubical.Reflection.RecordEquiv.html#4138" class="Bound">s</a> <a id="4140" href="Cubical.Reflection.RecordEquiv.html#4140" class="Bound">ty</a><a id="4142" class="Symbol">))</a> <a id="4145" class="Symbol">=</a>
    <a id="4151" class="Comment">-- If the record takes a parameter, the returned isomorphism is likewise parameterized</a>
    <a id="4242" href="Cubical.Reflection.Base.html#452" class="Function">liftTC</a> <a id="4249" class="Symbol">(λ</a> <a id="4252" href="Cubical.Reflection.RecordEquiv.html#4252" class="Bound">t</a> <a id="4254" class="Symbol">→</a> <a id="4256" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">R.pi</a> <a id="4261" class="Symbol">(</a><a id="4262" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4268" href="Cubical.Reflection.RecordEquiv.html#4323" class="Function">i&#39;</a> <a id="4271" href="Cubical.Reflection.RecordEquiv.html#4124" class="Bound">argTy</a><a id="4276" class="Symbol">)</a> <a id="4278" class="Symbol">(</a><a id="4279" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">R.abs</a> <a id="4285" href="Cubical.Reflection.RecordEquiv.html#4138" class="Bound">s</a> <a id="4287" href="Cubical.Reflection.RecordEquiv.html#4252" class="Bound">t</a><a id="4288" class="Symbol">))</a> <a id="4291" class="Symbol">(</a><a id="4292" href="Cubical.Reflection.RecordEquiv.html#4057" class="Function">go</a> <a id="4295" class="Symbol">(</a><a id="4296" href="Cubical.Reflection.RecordEquiv.html#4122" class="Bound">i</a> <a id="4298" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4300" href="Cubical.Reflection.RecordEquiv.html#4105" class="Bound">acc</a><a id="4303" class="Symbol">)</a> <a id="4305" href="Cubical.Reflection.RecordEquiv.html#4140" class="Bound">ty</a><a id="4307" class="Symbol">)</a>
    <a id="4313" class="Keyword">where</a>
    <a id="4323" href="Cubical.Reflection.RecordEquiv.html#4323" class="Function">i&#39;</a> <a id="4326" class="Symbol">=</a> <a id="4328" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">R.arg-info</a> <a id="4339" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">R.hidden</a> <a id="4348" class="Symbol">(</a><a id="4349" href="Agda.Builtin.Reflection.html#3463" class="InductiveConstructor">R.modality</a> <a id="4360" href="Agda.Builtin.Reflection.html#3019" class="InductiveConstructor">R.relevant</a> <a id="4371" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">R.quantity-ω</a><a id="4383" class="Symbol">)</a>
  <a id="4387" href="Cubical.Reflection.RecordEquiv.html#4057" class="Function">go</a> <a id="4390" href="Cubical.Reflection.RecordEquiv.html#4390" class="Bound">acc</a> <a id="4394" class="Symbol">(</a><a id="4395" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">R.agda-sort</a> <a id="4407" class="Symbol">_)</a> <a id="4410" class="Symbol">=</a>
    <a id="4416" class="Comment">-- Main case, constructs isomorphism type</a>
    <a id="4462" href="Agda.Builtin.Reflection.html#8660" class="Postulate">R.returnTC</a> <a id="4473" class="Symbol">(</a><a id="4474" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="4480" class="Symbol">(</a><a id="4481" class="Keyword">quote</a> <a id="4487" href="Cubical.Foundations.Isomorphism.html#744" class="Record">Iso</a><a id="4490" class="Symbol">)</a> <a id="4492" class="Symbol">(</a><a id="4493" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="4499" href="Cubical.Reflection.RecordEquiv.html#3909" class="Bound">name</a> <a id="4504" class="Symbol">(</a><a id="4505" href="Cubical.Reflection.RecordEquiv.html#4553" class="Function">makeArgs</a> <a id="4514" class="Number">0</a> <a id="4516" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4519" href="Cubical.Reflection.RecordEquiv.html#4390" class="Bound">acc</a><a id="4522" class="Symbol">)</a> <a id="4524" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="4527" href="Cubical.Reflection.RecordEquiv.html#3984" class="Function">σTy</a> <a id="4531" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="4534" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4536" class="Symbol">))</a>
    <a id="4543" class="Keyword">where</a>
    <a id="4553" href="Cubical.Reflection.RecordEquiv.html#4553" class="Function">makeArgs</a> <a id="4562" class="Symbol">:</a> <a id="4564" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4566" class="Symbol">→</a> <a id="4568" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4573" class="Symbol">(</a><a id="4574" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="4580" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a><a id="4586" class="Symbol">)</a> <a id="4588" class="Symbol">→</a> <a id="4590" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4595" href="Agda.Builtin.Reflection.html#3615" class="Datatype">R.ArgInfo</a> <a id="4605" class="Symbol">→</a> <a id="4607" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4612" class="Symbol">(</a><a id="4613" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="4619" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a><a id="4625" class="Symbol">)</a>
    <a id="4631" href="Cubical.Reflection.RecordEquiv.html#4553" class="Function">makeArgs</a> <a id="4640" href="Cubical.Reflection.RecordEquiv.html#4640" class="Bound">n</a> <a id="4642" href="Cubical.Reflection.RecordEquiv.html#4642" class="Bound">acc</a> <a id="4646" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4649" class="Symbol">=</a> <a id="4651" href="Cubical.Reflection.RecordEquiv.html#4642" class="Bound">acc</a>
    <a id="4659" href="Cubical.Reflection.RecordEquiv.html#4553" class="Function">makeArgs</a> <a id="4668" href="Cubical.Reflection.RecordEquiv.html#4668" class="Bound">n</a> <a id="4670" href="Cubical.Reflection.RecordEquiv.html#4670" class="Bound">acc</a> <a id="4674" class="Symbol">(</a><a id="4675" href="Cubical.Reflection.RecordEquiv.html#4675" class="Bound">i</a> <a id="4677" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4679" href="Cubical.Reflection.RecordEquiv.html#4679" class="Bound">infos</a><a id="4684" class="Symbol">)</a> <a id="4686" class="Symbol">=</a> <a id="4688" href="Cubical.Reflection.RecordEquiv.html#4553" class="Function">makeArgs</a> <a id="4697" class="Symbol">(</a><a id="4698" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4702" href="Cubical.Reflection.RecordEquiv.html#4668" class="Bound">n</a><a id="4703" class="Symbol">)</a> <a id="4705" class="Symbol">(</a><a id="4706" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="4712" href="Cubical.Reflection.RecordEquiv.html#4675" class="Bound">i</a> <a id="4714" class="Symbol">(</a><a id="4715" href="Cubical.Reflection.Base.html#570" class="Function">v</a> <a id="4717" href="Cubical.Reflection.RecordEquiv.html#4668" class="Bound">n</a><a id="4718" class="Symbol">)</a> <a id="4720" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4722" href="Cubical.Reflection.RecordEquiv.html#4670" class="Bound">acc</a><a id="4725" class="Symbol">)</a> <a id="4727" href="Cubical.Reflection.RecordEquiv.html#4679" class="Bound">infos</a>
  <a id="4735" href="Cubical.Reflection.RecordEquiv.html#4057" class="CatchallClause Function">go</a><a id="4737" class="CatchallClause"> </a><a id="4738" class="CatchallClause Symbol">_</a><a id="4739" class="CatchallClause"> </a><a id="4740" class="CatchallClause Symbol">_</a> <a id="4742" class="Symbol">=</a> <a id="4744" href="Agda.Builtin.Reflection.html#8830" class="Postulate">R.typeError</a> <a id="4756" class="Symbol">(</a><a id="4757" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">R.strErr</a> <a id="4766" class="String">&quot;Not a record type name: &quot;</a> <a id="4793" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4795" href="Agda.Builtin.Reflection.html#8330" class="InductiveConstructor">R.nameErr</a> <a id="4805" href="Cubical.Reflection.RecordEquiv.html#3909" class="Bound">name</a> <a id="4810" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4812" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4814" class="Symbol">)</a>

<a id="4817" class="Comment">-- Given an association list `al` defining a correspondence between record types (say R</a>
<a id="4905" class="Comment">-- and S) and a `term` belonging to R, produces clauses defining an element of S, with</a>
<a id="4992" class="Comment">-- each field of S instantiated with a field of `term` according to `al`.  For example,</a>
<a id="5080" class="Comment">-- the correspondence</a>
<a id="5102" class="Comment">--</a>
<a id="5105" class="Comment">--   .fst ↔ .a</a>
<a id="5120" class="Comment">--   .snd .fst ↔ .b</a>
<a id="5140" class="Comment">--   .snd .snd ↔ ∅</a>
<a id="5159" class="Comment">--   ∅ ↔ .c</a>
<a id="5171" class="Comment">--</a>
<a id="5174" class="Comment">-- would produce the clauses</a>
<a id="5203" class="Comment">--</a>
<a id="5206" class="Comment">-- ... .a = term .fst</a>
<a id="5228" class="Comment">-- ... .b = term .snd</a>
<a id="5250" class="Comment">-- ... .c = _</a>
<a id="5264" class="Comment">--</a>
<a id="5267" class="Comment">-- Here the type of .c should have a definitionally unique element, so</a>
<a id="5338" class="Comment">-- we can safely fill it with an unsolved metavariable.</a>
<a id="convertClauses"></a><a id="5394" href="Cubical.Reflection.RecordEquiv.html#5394" class="Function">convertClauses</a> <a id="5409" class="Symbol">:</a> <a id="5411" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="5423" class="Symbol">→</a> <a id="5425" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a> <a id="5432" class="Symbol">→</a> <a id="5434" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5439" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
<a id="5448" href="Cubical.Reflection.RecordEquiv.html#5394" class="Function">convertClauses</a> <a id="5463" href="Cubical.Reflection.RecordEquiv.html#5463" class="Bound">al</a> <a id="5466" href="Cubical.Reflection.RecordEquiv.html#5466" class="Bound">term</a> <a id="5471" class="Symbol">=</a> <a id="5473" href="Cubical.Reflection.RecordEquiv.html#6192" class="Function">fixIfEmpty</a> <a id="5484" class="Symbol">(</a><a id="5485" href="Cubical.Data.List.Base.html#908" class="Function">List.filterMap</a> <a id="5500" href="Cubical.Reflection.RecordEquiv.html#5525" class="Function">makeClause</a> <a id="5511" href="Cubical.Reflection.RecordEquiv.html#5463" class="Bound">al</a><a id="5513" class="Symbol">)</a>
  <a id="5517" class="Keyword">where</a>
  <a id="5525" href="Cubical.Reflection.RecordEquiv.html#5525" class="Function">makeClause</a> <a id="5536" class="Symbol">:</a> <a id="5538" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="5544" href="Cubical.Reflection.RecordEquiv.html#842" class="Function">Projections</a> <a id="5556" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="5558" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="5564" href="Cubical.Reflection.RecordEquiv.html#842" class="Function">Projections</a> <a id="5576" class="Symbol">→</a> <a id="5578" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="5584" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="5595" href="Cubical.Reflection.RecordEquiv.html#5525" class="Function">makeClause</a> <a id="5606" class="Symbol">(</a><a id="5607" href="Cubical.Reflection.RecordEquiv.html#5607" class="Bound">projl</a> <a id="5613" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5615" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="5620" href="Cubical.Reflection.RecordEquiv.html#5620" class="Bound">projr</a><a id="5625" class="Symbol">)</a> <a id="5627" class="Symbol">=</a>
    <a id="5633" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="5638" class="Symbol">(</a><a id="5639" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="5648" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5651" class="Symbol">(</a><a id="5652" href="Cubical.Reflection.RecordEquiv.html#5716" class="Function">goPat</a> <a id="5658" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5661" href="Cubical.Reflection.RecordEquiv.html#5620" class="Bound">projr</a><a id="5666" class="Symbol">)</a> <a id="5668" class="Symbol">(</a><a id="5669" href="Cubical.Data.Maybe.Base.html#433" class="Function">Maybe.rec</a> <a id="5679" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a> <a id="5689" href="Cubical.Reflection.RecordEquiv.html#5878" class="Function">goTm</a> <a id="5694" href="Cubical.Reflection.RecordEquiv.html#5607" class="Bound">projl</a><a id="5699" class="Symbol">))</a>
    <a id="5706" class="Keyword">where</a>
    <a id="5716" href="Cubical.Reflection.RecordEquiv.html#5716" class="Function">goPat</a> <a id="5722" class="Symbol">:</a> <a id="5724" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5729" class="Symbol">(</a><a id="5730" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="5736" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="5745" class="Symbol">)</a> <a id="5747" class="Symbol">→</a> <a id="5749" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5754" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="5761" class="Symbol">→</a> <a id="5763" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5768" class="Symbol">(</a><a id="5769" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="5775" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="5784" class="Symbol">)</a>
    <a id="5790" href="Cubical.Reflection.RecordEquiv.html#5716" class="Function">goPat</a> <a id="5796" href="Cubical.Reflection.RecordEquiv.html#5796" class="Bound">acc</a> <a id="5800" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5803" class="Symbol">=</a> <a id="5805" href="Cubical.Reflection.RecordEquiv.html#5796" class="Bound">acc</a>
    <a id="5813" href="Cubical.Reflection.RecordEquiv.html#5716" class="Function">goPat</a> <a id="5819" href="Cubical.Reflection.RecordEquiv.html#5819" class="Bound">acc</a> <a id="5823" class="Symbol">(</a><a id="5824" href="Cubical.Reflection.RecordEquiv.html#5824" class="Bound">π</a> <a id="5826" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5828" href="Cubical.Reflection.RecordEquiv.html#5828" class="Bound">projs</a><a id="5833" class="Symbol">)</a> <a id="5835" class="Symbol">=</a> <a id="5837" href="Cubical.Reflection.RecordEquiv.html#5716" class="Function">goPat</a> <a id="5843" class="Symbol">(</a><a id="5844" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="5849" class="Symbol">(</a><a id="5850" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="5857" href="Cubical.Reflection.RecordEquiv.html#5824" class="Bound">π</a><a id="5858" class="Symbol">)</a> <a id="5860" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5862" href="Cubical.Reflection.RecordEquiv.html#5819" class="Bound">acc</a><a id="5865" class="Symbol">)</a> <a id="5867" href="Cubical.Reflection.RecordEquiv.html#5828" class="Bound">projs</a>

    <a id="5878" href="Cubical.Reflection.RecordEquiv.html#5878" class="Function">goTm</a> <a id="5883" class="Symbol">:</a> <a id="5885" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5890" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="5897" class="Symbol">→</a> <a id="5899" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
    <a id="5910" href="Cubical.Reflection.RecordEquiv.html#5878" class="Function">goTm</a> <a id="5915" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5918" class="Symbol">=</a> <a id="5920" href="Cubical.Reflection.RecordEquiv.html#5466" class="Bound">term</a>
    <a id="5929" href="Cubical.Reflection.RecordEquiv.html#5878" class="Function">goTm</a> <a id="5934" class="Symbol">(</a><a id="5935" href="Cubical.Reflection.RecordEquiv.html#5935" class="Bound">π</a> <a id="5937" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5939" href="Cubical.Reflection.RecordEquiv.html#5939" class="Bound">projs</a><a id="5944" class="Symbol">)</a> <a id="5946" class="Symbol">=</a> <a id="5948" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="5954" href="Cubical.Reflection.RecordEquiv.html#5935" class="Bound">π</a> <a id="5956" href="Cubical.Data.List.Base.html#299" class="Function Operator">[</a> <a id="5958" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="5963" class="Symbol">(</a><a id="5964" href="Cubical.Reflection.RecordEquiv.html#5878" class="Function">goTm</a> <a id="5969" href="Cubical.Reflection.RecordEquiv.html#5939" class="Bound">projs</a><a id="5974" class="Symbol">)</a> <a id="5976" href="Cubical.Data.List.Base.html#299" class="Function Operator">]</a>
  <a id="5980" href="Cubical.Reflection.RecordEquiv.html#5525" class="Function">makeClause</a> <a id="5991" class="Symbol">(_</a> <a id="5994" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5996" href="Cubical.Data.Maybe.Base.html#193" class="InductiveConstructor">nothing</a><a id="6003" class="Symbol">)</a> <a id="6005" class="Symbol">=</a> <a id="6007" href="Cubical.Data.Maybe.Base.html#193" class="InductiveConstructor">nothing</a>

  <a id="6018" class="Comment">-- If there end up being zero clauses, then S should be a type with a definitionally</a>
  <a id="6105" class="Comment">-- unique element, so we return a single clause defined by an unsolved metavariable.</a>
  <a id="6192" href="Cubical.Reflection.RecordEquiv.html#6192" class="Function">fixIfEmpty</a> <a id="6203" class="Symbol">:</a> <a id="6205" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6210" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a> <a id="6219" class="Symbol">→</a> <a id="6221" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6226" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="6237" href="Cubical.Reflection.RecordEquiv.html#6192" class="Function">fixIfEmpty</a> <a id="6248" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6251" class="Symbol">=</a> <a id="6253" href="Cubical.Data.List.Base.html#299" class="Function Operator">[</a> <a id="6255" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6264" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6267" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6270" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a> <a id="6280" href="Cubical.Data.List.Base.html#299" class="Function Operator">]</a>
  <a id="6284" href="Cubical.Reflection.RecordEquiv.html#6192" class="Function">fixIfEmpty</a> <a id="6295" class="Symbol">(</a><a id="6296" href="Cubical.Reflection.RecordEquiv.html#6296" class="Bound">c</a> <a id="6298" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6300" href="Cubical.Reflection.RecordEquiv.html#6300" class="Bound">cs</a><a id="6302" class="Symbol">)</a> <a id="6304" class="Symbol">=</a> <a id="6306" href="Cubical.Reflection.RecordEquiv.html#6296" class="Bound">c</a> <a id="6308" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6310" href="Cubical.Reflection.RecordEquiv.html#6300" class="Bound">cs</a>

<a id="6314" class="Comment">-- Apply functions to the telescope and pattern parts of a clause</a>
<a id="mapClause"></a><a id="6380" href="Cubical.Reflection.RecordEquiv.html#6380" class="Function">mapClause</a> <a id="6390" class="Symbol">:</a>
  <a id="6394" class="Symbol">(</a><a id="6395" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6400" class="Symbol">(</a><a id="6401" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="6408" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="6410" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6416" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a><a id="6422" class="Symbol">)</a> <a id="6424" class="Symbol">→</a> <a id="6426" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6431" class="Symbol">(</a><a id="6432" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="6439" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="6441" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6447" href="Agda.Builtin.Reflection.html#5064" class="Function">R.Type</a><a id="6453" class="Symbol">))</a>
  <a id="6458" class="Symbol">→</a> <a id="6460" class="Symbol">(</a><a id="6461" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6466" class="Symbol">(</a><a id="6467" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6473" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="6482" class="Symbol">)</a> <a id="6484" class="Symbol">→</a> <a id="6486" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6491" class="Symbol">(</a><a id="6492" href="Agda.Builtin.Reflection.html#3696" class="Datatype">R.Arg</a> <a id="6498" href="Agda.Builtin.Reflection.html#5031" class="Datatype">R.Pattern</a><a id="6507" class="Symbol">))</a>
  <a id="6512" class="Symbol">→</a> <a id="6514" class="Symbol">(</a><a id="6515" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a> <a id="6524" class="Symbol">→</a> <a id="6526" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a><a id="6534" class="Symbol">)</a>
<a id="6536" href="Cubical.Reflection.RecordEquiv.html#6380" class="Function">mapClause</a> <a id="6546" href="Cubical.Reflection.RecordEquiv.html#6546" class="Bound">f</a> <a id="6548" href="Cubical.Reflection.RecordEquiv.html#6548" class="Bound">g</a> <a id="6550" class="Symbol">(</a><a id="6551" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6560" href="Cubical.Reflection.RecordEquiv.html#6560" class="Bound">tel</a> <a id="6564" href="Cubical.Reflection.RecordEquiv.html#6564" class="Bound">ps</a> <a id="6567" href="Cubical.Reflection.RecordEquiv.html#6567" class="Bound">t</a><a id="6568" class="Symbol">)</a> <a id="6570" class="Symbol">=</a> <a id="6572" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">R.clause</a> <a id="6581" class="Symbol">(</a><a id="6582" href="Cubical.Reflection.RecordEquiv.html#6546" class="Bound">f</a> <a id="6584" href="Cubical.Reflection.RecordEquiv.html#6560" class="Bound">tel</a><a id="6587" class="Symbol">)</a> <a id="6589" class="Symbol">(</a><a id="6590" href="Cubical.Reflection.RecordEquiv.html#6548" class="Bound">g</a> <a id="6592" href="Cubical.Reflection.RecordEquiv.html#6564" class="Bound">ps</a><a id="6594" class="Symbol">)</a> <a id="6596" href="Cubical.Reflection.RecordEquiv.html#6567" class="Bound">t</a>
<a id="6598" href="Cubical.Reflection.RecordEquiv.html#6380" class="Function">mapClause</a> <a id="6608" href="Cubical.Reflection.RecordEquiv.html#6608" class="Bound">f</a> <a id="6610" href="Cubical.Reflection.RecordEquiv.html#6610" class="Bound">g</a> <a id="6612" class="Symbol">(</a><a id="6613" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">R.absurd-clause</a> <a id="6629" href="Cubical.Reflection.RecordEquiv.html#6629" class="Bound">tel</a> <a id="6633" href="Cubical.Reflection.RecordEquiv.html#6633" class="Bound">ps</a><a id="6635" class="Symbol">)</a> <a id="6637" class="Symbol">=</a> <a id="6639" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">R.absurd-clause</a> <a id="6655" class="Symbol">(</a><a id="6656" href="Cubical.Reflection.RecordEquiv.html#6608" class="Bound">f</a> <a id="6658" href="Cubical.Reflection.RecordEquiv.html#6629" class="Bound">tel</a><a id="6661" class="Symbol">)</a> <a id="6663" class="Symbol">(</a><a id="6664" href="Cubical.Reflection.RecordEquiv.html#6610" class="Bound">g</a> <a id="6666" href="Cubical.Reflection.RecordEquiv.html#6633" class="Bound">ps</a><a id="6668" class="Symbol">)</a>

<a id="6671" class="Comment">-- Given a ΣFormat `σ` relating a record type R and Σ-type S, returns</a>
<a id="6741" class="Comment">-- a list of clauses defining an isomorphism between R and S.</a>
<a id="recordIsoΣClauses"></a><a id="6803" href="Cubical.Reflection.RecordEquiv.html#6803" class="Function">recordIsoΣClauses</a> <a id="6821" class="Symbol">:</a> <a id="6823" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="6831" class="Symbol">→</a> <a id="6833" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6838" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
<a id="6847" href="Cubical.Reflection.RecordEquiv.html#6803" class="Function">recordIsoΣClauses</a> <a id="6865" href="Cubical.Reflection.RecordEquiv.html#6865" class="Bound">σ</a> <a id="6867" class="Symbol">=</a>
  <a id="6871" href="Cubical.Reflection.RecordEquiv.html#7339" class="Function">funClauses</a> <a id="6882" class="Symbol">(</a><a id="6883" class="Keyword">quote</a> <a id="6889" href="Cubical.Foundations.Isomorphism.html#856" class="Field">Iso.fun</a><a id="6896" class="Symbol">)</a> <a id="6898" href="Cubical.Reflection.RecordEquiv.html#7092" class="Function">R↔Σ</a> <a id="6902" href="Cubical.Data.List.Base.html#336" class="Function Operator">++</a>
  <a id="6907" href="Cubical.Reflection.RecordEquiv.html#7339" class="Function">funClauses</a> <a id="6918" class="Symbol">(</a><a id="6919" class="Keyword">quote</a> <a id="6925" href="Cubical.Foundations.Isomorphism.html#872" class="Field">Iso.inv</a><a id="6932" class="Symbol">)</a> <a id="6934" href="Cubical.Reflection.RecordEquiv.html#7122" class="Function">Σ↔R</a> <a id="6938" href="Cubical.Data.List.Base.html#336" class="Function Operator">++</a>
  <a id="6943" class="Comment">-- Clauses for the forward and backward inverse conditions</a>
  <a id="7004" href="Cubical.Reflection.RecordEquiv.html#7903" class="Function">pathClauses</a> <a id="7016" class="Symbol">(</a><a id="7017" class="Keyword">quote</a> <a id="7023" href="Cubical.Foundations.Isomorphism.html#888" class="Field">Iso.rightInv</a><a id="7035" class="Symbol">)</a> <a id="7037" href="Cubical.Reflection.RecordEquiv.html#7122" class="Function">Σ↔R</a> <a id="7041" href="Cubical.Data.List.Base.html#336" class="Function Operator">++</a>
  <a id="7046" href="Cubical.Reflection.RecordEquiv.html#7903" class="Function">pathClauses</a> <a id="7058" class="Symbol">(</a><a id="7059" class="Keyword">quote</a> <a id="7065" href="Cubical.Foundations.Isomorphism.html#919" class="Field">Iso.leftInv</a><a id="7076" class="Symbol">)</a> <a id="7078" href="Cubical.Reflection.RecordEquiv.html#7092" class="Function">R↔Σ</a>
  <a id="7084" class="Keyword">where</a>
  <a id="7092" href="Cubical.Reflection.RecordEquiv.html#7092" class="Function">R↔Σ</a> <a id="7096" class="Symbol">=</a> <a id="7098" href="Cubical.Reflection.RecordEquiv.html#2773" class="Function">ΣFormat→RecordAssoc</a> <a id="7118" href="Cubical.Reflection.RecordEquiv.html#6865" class="Bound">σ</a>
  <a id="7122" href="Cubical.Reflection.RecordEquiv.html#7122" class="Function">Σ↔R</a> <a id="7126" class="Symbol">=</a> <a id="7128" href="Cubical.Reflection.RecordEquiv.html#2094" class="Function">flipRecordAssoc</a> <a id="7144" href="Cubical.Reflection.RecordEquiv.html#7092" class="Function">R↔Σ</a>

  <a id="7151" class="Comment">-- Given an association list `al` for a correspondence R ↔ S, produces the list of</a>
  <a id="7236" class="Comment">-- clauses defining a function from R to S.</a>
  <a id="7282" class="Comment">-- The `prefix` will be either `Iso.fun` or `Iso.inv`.</a>
  <a id="7339" href="Cubical.Reflection.RecordEquiv.html#7339" class="Function">funClauses</a> <a id="7350" class="Symbol">:</a> <a id="7352" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="7359" class="Symbol">→</a> <a id="7361" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="7373" class="Symbol">→</a> <a id="7375" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7380" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="7391" href="Cubical.Reflection.RecordEquiv.html#7339" class="Function">funClauses</a> <a id="7402" href="Cubical.Reflection.RecordEquiv.html#7402" class="Bound">prefix</a> <a id="7409" href="Cubical.Reflection.RecordEquiv.html#7409" class="Bound">al</a> <a id="7412" class="Symbol">=</a>
    <a id="7418" href="Cubical.Data.List.Base.html#617" class="Function">List.map</a>
      <a id="7433" class="Comment">-- Introduce a new variable of the input type</a>
      <a id="7485" class="Symbol">(</a><a id="7486" href="Cubical.Reflection.RecordEquiv.html#6380" class="Function">mapClause</a>
        <a id="7504" class="Symbol">((</a><a id="7506" class="String">&quot;_&quot;</a> <a id="7510" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7512" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="7517" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a><a id="7526" class="Symbol">)</a> <a id="7528" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷_</a><a id="7530" class="Symbol">)</a>
        <a id="7540" class="Symbol">(λ</a> <a id="7543" href="Cubical.Reflection.RecordEquiv.html#7543" class="Bound">ps</a> <a id="7546" class="Symbol">→</a> <a id="7548" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="7555" href="Cubical.Reflection.RecordEquiv.html#7402" class="Bound">prefix</a> <a id="7562" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="7565" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="7571" class="Number">0</a> <a id="7573" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="7576" href="Cubical.Reflection.RecordEquiv.html#7543" class="Bound">ps</a><a id="7578" class="Symbol">))</a>
      <a id="7587" class="Comment">-- Each clause is a projection applied to the input variable</a>
      <a id="7654" class="Symbol">(</a><a id="7655" href="Cubical.Reflection.RecordEquiv.html#5394" class="Function">convertClauses</a> <a id="7670" href="Cubical.Reflection.RecordEquiv.html#7409" class="Bound">al</a> <a id="7673" class="Symbol">(</a><a id="7674" href="Cubical.Reflection.Base.html#570" class="Function">v</a> <a id="7676" class="Number">0</a><a id="7677" class="Symbol">))</a>

  <a id="7683" class="Comment">-- Given an association list `al` for a correspondence R ↔ S, produces the list of</a>
  <a id="7768" class="Comment">-- clauses defining the inverse path for the round-trip R → S → R.</a>
  <a id="7837" class="Comment">-- The `prefix` will be either `Iso.rightInv` or `Iso.leftInv`.</a>
  <a id="7903" href="Cubical.Reflection.RecordEquiv.html#7903" class="Function">pathClauses</a> <a id="7915" class="Symbol">:</a> <a id="7917" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="7924" class="Symbol">→</a> <a id="7926" href="Cubical.Reflection.RecordEquiv.html#1418" class="Function">RecordAssoc</a> <a id="7938" class="Symbol">→</a> <a id="7940" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7945" href="Agda.Builtin.Reflection.html#5050" class="Datatype">R.Clause</a>
  <a id="7956" href="Cubical.Reflection.RecordEquiv.html#7903" class="Function">pathClauses</a> <a id="7968" href="Cubical.Reflection.RecordEquiv.html#7968" class="Bound">prefix</a> <a id="7975" href="Cubical.Reflection.RecordEquiv.html#7975" class="Bound">al</a> <a id="7978" class="Symbol">=</a>
    <a id="7984" href="Cubical.Data.List.Base.html#617" class="Function">List.map</a>
      <a id="7999" class="Comment">-- Introduce a variable of the input type and an interval variable</a>
      <a id="8072" class="Symbol">(</a><a id="8073" href="Cubical.Reflection.RecordEquiv.html#6380" class="Function">mapClause</a>
        <a id="8091" class="Symbol">(λ</a> <a id="8094" href="Cubical.Reflection.RecordEquiv.html#8094" class="Bound">vs</a> <a id="8097" class="Symbol">→</a> <a id="8099" class="Symbol">(</a><a id="8100" class="String">&quot;_&quot;</a> <a id="8104" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8106" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="8111" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">R.unknown</a><a id="8120" class="Symbol">)</a> <a id="8122" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8124" class="Symbol">(</a><a id="8125" class="String">&quot;_&quot;</a> <a id="8129" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8131" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="8136" class="Symbol">(</a><a id="8137" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">R.def</a> <a id="8143" class="Symbol">(</a><a id="8144" class="Keyword">quote</a> <a id="8150" href="Agda.Primitive.Cubical.html#150" class="Datatype">I</a><a id="8151" class="Symbol">)</a> <a id="8153" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8155" class="Symbol">))</a> <a id="8158" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8160" href="Cubical.Reflection.RecordEquiv.html#8094" class="Bound">vs</a><a id="8162" class="Symbol">)</a>
        <a id="8172" class="Symbol">(λ</a> <a id="8175" href="Cubical.Reflection.RecordEquiv.html#8175" class="Bound">ps</a> <a id="8178" class="Symbol">→</a> <a id="8180" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">R.proj</a> <a id="8187" href="Cubical.Reflection.RecordEquiv.html#7968" class="Bound">prefix</a> <a id="8194" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="8197" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="8203" class="Number">1</a> <a id="8205" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="8208" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">R.var</a> <a id="8214" class="Number">0</a> <a id="8216" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="8219" href="Cubical.Reflection.RecordEquiv.html#8175" class="Bound">ps</a><a id="8221" class="Symbol">))</a>
      <a id="8230" class="Comment">-- The inverse condition at each clause holds by reflexivity</a>
      <a id="8297" class="Symbol">(</a><a id="8298" href="Cubical.Reflection.RecordEquiv.html#5394" class="Function">convertClauses</a> <a id="8313" class="Symbol">(</a><a id="8314" href="Cubical.Reflection.RecordEquiv.html#2274" class="Function">fstIdRecordAssoc</a> <a id="8331" href="Cubical.Reflection.RecordEquiv.html#7975" class="Bound">al</a><a id="8333" class="Symbol">)</a> <a id="8335" class="Symbol">(</a><a id="8336" href="Cubical.Reflection.Base.html#570" class="Function">v</a> <a id="8338" class="Number">1</a><a id="8339" class="Symbol">))</a>

<a id="8343" class="Comment">------------------------------------------------------------------------------------------</a>
<a id="8434" class="Comment">-- Main functions</a>
<a id="8452" class="Comment">------------------------------------------------------------------------------------------</a>

<a id="8544" class="Comment">-- Given a ΣFormat describing a correspondence between a record and nested Σ-type,</a>
<a id="8627" class="Comment">-- constructs an isomorphism between them as a term.</a>
<a id="8680" class="Comment">--</a>
<a id="8683" class="Comment">-- Because this term is a large pattern-matching lambda, it is better to use the</a>
<a id="8764" class="Comment">-- declare* functions below, which declare a named function.</a>
<a id="recordIsoΣTerm"></a><a id="8825" href="Cubical.Reflection.RecordEquiv.html#8825" class="Function">recordIsoΣTerm</a> <a id="8840" class="Symbol">:</a> <a id="8842" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="8850" class="Symbol">→</a> <a id="8852" href="Agda.Builtin.Reflection.html#4993" class="Datatype">R.Term</a>
<a id="8859" href="Cubical.Reflection.RecordEquiv.html#8825" class="Function">recordIsoΣTerm</a> <a id="8874" href="Cubical.Reflection.RecordEquiv.html#8874" class="Bound">σ</a> <a id="8876" class="Symbol">=</a> <a id="8878" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">R.pat-lam</a> <a id="8888" class="Symbol">(</a><a id="8889" href="Cubical.Reflection.RecordEquiv.html#6803" class="Function">recordIsoΣClauses</a> <a id="8907" href="Cubical.Reflection.RecordEquiv.html#8874" class="Bound">σ</a><a id="8908" class="Symbol">)</a> <a id="8910" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="8914" class="Comment">-- Given a name `idName`, a ΣFormat `σ` describing a correspondence between a record and</a>
<a id="9003" class="Comment">-- nested Σ-type, and the name `recordName` of the record type, declares a function with</a>
<a id="9092" class="Comment">-- name `idName` defining an isomorphism between the two types (with implicit parameters</a>
<a id="9181" class="Comment">-- corresponding to the parameters and indices of the record type).</a>
<a id="declareRecordIsoΣ&#39;"></a><a id="9249" href="Cubical.Reflection.RecordEquiv.html#9249" class="Function">declareRecordIsoΣ&#39;</a> <a id="9268" class="Symbol">:</a> <a id="9270" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9277" class="Symbol">→</a> <a id="9279" href="Cubical.Reflection.RecordEquiv.html#1927" class="Datatype">ΣFormat</a> <a id="9287" class="Symbol">→</a> <a id="9289" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9296" class="Symbol">→</a> <a id="9298" href="Agda.Builtin.Reflection.html#8617" class="Postulate">R.TC</a> <a id="9303" href="Cubical.Data.Unit.Base.html#149" class="Record">Unit</a>
<a id="9308" href="Cubical.Reflection.RecordEquiv.html#9249" class="Function">declareRecordIsoΣ&#39;</a> <a id="9327" href="Cubical.Reflection.RecordEquiv.html#9327" class="Bound">idName</a> <a id="9334" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">σ</a> <a id="9336" href="Cubical.Reflection.RecordEquiv.html#9336" class="Bound">recordName</a> <a id="9347" class="Symbol">=</a>
  <a id="9351" href="Cubical.Reflection.RecordEquiv.html#3842" class="Function">recordName→isoTy</a> <a id="9368" href="Cubical.Reflection.RecordEquiv.html#9336" class="Bound">recordName</a> <a id="9379" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">σ</a> <a id="9381" href="Cubical.Reflection.Base.html#295" class="Function Operator">&gt;&gt;=</a> <a id="9385" class="Symbol">λ</a> <a id="9387" href="Cubical.Reflection.RecordEquiv.html#9387" class="Bound">isoTy</a> <a id="9393" class="Symbol">→</a>
  <a id="9397" href="Agda.Builtin.Reflection.html#9468" class="Postulate">R.declareDef</a> <a id="9410" class="Symbol">(</a><a id="9411" href="Cubical.Reflection.Base.html#611" class="InductiveConstructor">varg</a> <a id="9416" href="Cubical.Reflection.RecordEquiv.html#9327" class="Bound">idName</a><a id="9422" class="Symbol">)</a> <a id="9424" href="Cubical.Reflection.RecordEquiv.html#9387" class="Bound">isoTy</a> <a id="9430" href="Cubical.Reflection.Base.html#331" class="Function Operator">&gt;&gt;</a>
  <a id="9435" href="Agda.Builtin.Reflection.html#9683" class="Postulate">R.defineFun</a> <a id="9447" href="Cubical.Reflection.RecordEquiv.html#9327" class="Bound">idName</a> <a id="9454" class="Symbol">(</a><a id="9455" href="Cubical.Reflection.RecordEquiv.html#6803" class="Function">recordIsoΣClauses</a> <a id="9473" href="Cubical.Reflection.RecordEquiv.html#9334" class="Bound">σ</a><a id="9474" class="Symbol">)</a>

<a id="9477" class="Comment">-- Given a name `idName` and the name `recordName` of a record type, declares a function</a>
<a id="9566" class="Comment">-- with name `idName` defining an isomorphism from the record type to the right-associated</a>
<a id="9657" class="Comment">-- Σ-type corresponding to its list of fields (with implicit parameters corresponding to</a>
<a id="9746" class="Comment">-- the parameters and indices of the record type).</a>
<a id="declareRecordIsoΣ"></a><a id="9797" href="Cubical.Reflection.RecordEquiv.html#9797" class="Function">declareRecordIsoΣ</a> <a id="9815" class="Symbol">:</a> <a id="9817" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9824" class="Symbol">→</a> <a id="9826" href="Agda.Builtin.Reflection.html#488" class="Postulate">R.Name</a> <a id="9833" class="Symbol">→</a> <a id="9835" href="Agda.Builtin.Reflection.html#8617" class="Postulate">R.TC</a> <a id="9840" href="Cubical.Data.Unit.Base.html#149" class="Record">Unit</a>
<a id="9845" href="Cubical.Reflection.RecordEquiv.html#9797" class="Function">declareRecordIsoΣ</a> <a id="9863" href="Cubical.Reflection.RecordEquiv.html#9863" class="Bound">idName</a> <a id="9870" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">recordName</a> <a id="9881" class="Symbol">=</a>
  <a id="9885" href="Agda.Builtin.Reflection.html#9766" class="Postulate">R.getDefinition</a> <a id="9901" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">recordName</a> <a id="9912" href="Cubical.Reflection.Base.html#295" class="Function Operator">&gt;&gt;=</a> <a id="9916" class="Symbol">λ</a> <a id="9918" class="Keyword">where</a>
  <a id="9926" class="Symbol">(</a><a id="9927" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">R.record-type</a> <a id="9941" class="Symbol">_</a> <a id="9943" href="Cubical.Reflection.RecordEquiv.html#9943" class="Bound">fs</a><a id="9945" class="Symbol">)</a> <a id="9947" class="Symbol">→</a>
    <a id="9953" class="Keyword">let</a> <a id="9957" href="Cubical.Reflection.RecordEquiv.html#9957" class="Bound">σ</a> <a id="9959" class="Symbol">=</a> <a id="9961" href="Cubical.Reflection.RecordEquiv.html#2476" class="Function">List→ΣFormat</a> <a id="9974" class="Symbol">(</a><a id="9975" href="Cubical.Data.List.Base.html#617" class="Function">List.map</a> <a id="9984" class="Symbol">(λ</a> <a id="9987" class="Symbol">{(</a><a id="9989" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="9995" class="Symbol">_</a> <a id="9997" href="Cubical.Reflection.RecordEquiv.html#9997" class="Bound">n</a><a id="9998" class="Symbol">)</a> <a id="10000" class="Symbol">→</a> <a id="10002" href="Cubical.Reflection.RecordEquiv.html#9997" class="Bound">n</a><a id="10003" class="Symbol">})</a> <a id="10006" href="Cubical.Reflection.RecordEquiv.html#9943" class="Bound">fs</a><a id="10008" class="Symbol">)</a> <a id="10010" class="Keyword">in</a>
    <a id="10017" href="Cubical.Reflection.RecordEquiv.html#9249" class="Function">declareRecordIsoΣ&#39;</a> <a id="10036" href="Cubical.Reflection.RecordEquiv.html#9863" class="Bound">idName</a> <a id="10043" href="Cubical.Reflection.RecordEquiv.html#9957" class="Bound">σ</a> <a id="10045" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">recordName</a>
  <a id="10058" class="CatchallClause Symbol">_</a> <a id="10060" class="Symbol">→</a>
    <a id="10066" href="Agda.Builtin.Reflection.html#8830" class="Postulate">R.typeError</a> <a id="10078" class="Symbol">(</a><a id="10079" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">R.strErr</a> <a id="10088" class="String">&quot;Not a record type name:&quot;</a> <a id="10114" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10116" href="Agda.Builtin.Reflection.html#8330" class="InductiveConstructor">R.nameErr</a> <a id="10126" href="Cubical.Reflection.RecordEquiv.html#9870" class="Bound">recordName</a> <a id="10137" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10139" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10141" class="Symbol">)</a>


<a id="10145" class="Comment">------------------------------------------------------------------------------------------</a>
<a id="10236" class="Comment">-- Examples</a>
<a id="10248" class="Comment">------------------------------------------------------------------------------------------</a>

<a id="10340" class="Keyword">private</a>
  <a id="10350" class="Keyword">module</a> <a id="Example"></a><a id="10357" href="Cubical.Reflection.RecordEquiv.html#10357" class="Module">Example</a> <a id="10365" class="Keyword">where</a>
    <a id="10375" class="Keyword">variable</a>
      <a id="10390" href="Cubical.Reflection.RecordEquiv.html#10390" class="Generalizable">ℓ</a> <a id="10392" href="Cubical.Reflection.RecordEquiv.html#10392" class="Generalizable">ℓ&#39;</a> <a id="10395" class="Symbol">:</a> <a id="10397" href="Agda.Primitive.html#742" class="Postulate">Level</a>
      <a id="10409" href="Cubical.Reflection.RecordEquiv.html#10409" class="Generalizable">A</a> <a id="10411" class="Symbol">:</a> <a id="10413" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10418" href="Cubical.Reflection.RecordEquiv.html#10390" class="Generalizable">ℓ</a>
      <a id="10426" href="Cubical.Reflection.RecordEquiv.html#10426" class="Generalizable">B</a> <a id="10428" class="Symbol">:</a> <a id="10430" href="Cubical.Reflection.RecordEquiv.html#10409" class="Generalizable">A</a> <a id="10432" class="Symbol">→</a> <a id="10434" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10439" href="Cubical.Reflection.RecordEquiv.html#10392" class="Generalizable">ℓ&#39;</a>

    <a id="10447" class="Keyword">record</a> <a id="Example.Example0"></a><a id="10454" href="Cubical.Reflection.RecordEquiv.html#10454" class="Record">Example0</a> <a id="10463" class="Symbol">{</a><a id="10464" href="Cubical.Reflection.RecordEquiv.html#10464" class="Bound">A</a> <a id="10466" class="Symbol">:</a> <a id="10468" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10473" href="Cubical.Reflection.RecordEquiv.html#10390" class="Generalizable">ℓ</a><a id="10474" class="Symbol">}</a> <a id="10476" class="Symbol">(</a><a id="10477" href="Cubical.Reflection.RecordEquiv.html#10477" class="Bound">B</a> <a id="10479" class="Symbol">:</a> <a id="10481" href="Cubical.Reflection.RecordEquiv.html#10464" class="Bound">A</a> <a id="10483" class="Symbol">→</a> <a id="10485" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10490" href="Cubical.Reflection.RecordEquiv.html#10392" class="Generalizable">ℓ&#39;</a><a id="10492" class="Symbol">)</a> <a id="10494" class="Symbol">:</a> <a id="10496" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="10501" class="Symbol">(</a><a id="10502" href="Agda.Primitive.html#961" class="Primitive">ℓ-max</a> <a id="10508" href="Cubical.Reflection.RecordEquiv.html#10473" class="Bound">ℓ</a> <a id="10510" href="Cubical.Reflection.RecordEquiv.html#10490" class="Bound">ℓ&#39;</a><a id="10512" class="Symbol">)</a> <a id="10514" class="Keyword">where</a>
      <a id="10526" class="Keyword">no-eta-equality</a> <a id="10542" class="Comment">-- works with or without eta equality</a>
      <a id="10586" class="Keyword">field</a>
        <a id="Example.Example0.cool"></a><a id="10600" href="Cubical.Reflection.RecordEquiv.html#10600" class="Field">cool</a> <a id="10605" class="Symbol">:</a> <a id="10607" href="Cubical.Reflection.RecordEquiv.html#10464" class="Bound">A</a>
        <a id="Example.Example0.fun"></a><a id="10617" href="Cubical.Reflection.RecordEquiv.html#10617" class="Field">fun</a> <a id="10621" class="Symbol">:</a> <a id="10623" href="Cubical.Reflection.RecordEquiv.html#10464" class="Bound">A</a>
        <a id="Example.Example0.wow"></a><a id="10633" href="Cubical.Reflection.RecordEquiv.html#10633" class="Field">wow</a> <a id="10637" class="Symbol">:</a> <a id="10639" href="Cubical.Reflection.RecordEquiv.html#10477" class="Bound">B</a> <a id="10641" href="Cubical.Reflection.RecordEquiv.html#10600" class="Field">cool</a>

    <a id="10651" class="Comment">-- Declares a function `Example0IsoΣ` that gives an isomorphism between the record type and a</a>
    <a id="10749" class="Comment">-- right-associated nested Σ-type (with the parameters to Example0 as implict arguments).</a>
    <a id="10843" class="Keyword">unquoteDecl</a> <a id="Example.Example0IsoΣ"></a><a id="10855" href="Cubical.Reflection.RecordEquiv.html#10855" class="Function">Example0IsoΣ</a> <a id="10868" class="Symbol">=</a> <a id="10870" href="Cubical.Reflection.RecordEquiv.html#9797" class="Function">declareRecordIsoΣ</a> <a id="10888" href="Cubical.Reflection.RecordEquiv.html#10855" class="Function">Example0IsoΣ</a> <a id="10901" class="Symbol">(</a><a id="10902" class="Keyword">quote</a> <a id="10908" href="Cubical.Reflection.RecordEquiv.html#10454" class="Record">Example0</a><a id="10916" class="Symbol">)</a>

    <a id="10923" class="Comment">-- `Example0IsoΣ` has the type we expect</a>
    <a id="Example.test0"></a><a id="10968" href="Cubical.Reflection.RecordEquiv.html#10968" class="Function">test0</a> <a id="10974" class="Symbol">:</a> <a id="10976" href="Cubical.Foundations.Isomorphism.html#744" class="Record">Iso</a> <a id="10980" class="Symbol">(</a><a id="10981" href="Cubical.Reflection.RecordEquiv.html#10454" class="Record">Example0</a> <a id="10990" href="Cubical.Reflection.RecordEquiv.html#10426" class="Generalizable">B</a><a id="10991" class="Symbol">)</a> <a id="10993" class="Symbol">(</a><a id="10994" href="Cubical.Core.Primitives.html#6245" class="Function">Σ[</a> <a id="10997" href="Cubical.Reflection.RecordEquiv.html#10997" class="Bound">a</a> <a id="10999" href="Cubical.Core.Primitives.html#6245" class="Function">∈</a> <a id="11001" href="Cubical.Reflection.RecordEquiv.html#10409" class="Generalizable">A</a> <a id="11003" href="Cubical.Core.Primitives.html#6245" class="Function">]</a> <a id="11005" class="Symbol">(</a><a id="11006" href="Cubical.Core.Primitives.html#6245" class="Function">Σ[</a> <a id="11009" href="Cubical.Reflection.RecordEquiv.html#11009" class="Symbol">_</a> <a id="11011" href="Cubical.Core.Primitives.html#6245" class="Function">∈</a> <a id="11013" href="Cubical.Reflection.RecordEquiv.html#10409" class="Generalizable">A</a> <a id="11015" href="Cubical.Core.Primitives.html#6245" class="Function">]</a> <a id="11017" href="Cubical.Reflection.RecordEquiv.html#10426" class="Generalizable">B</a> <a id="11019" href="Cubical.Reflection.RecordEquiv.html#10997" class="Bound">a</a><a id="11020" class="Symbol">))</a>
    <a id="11027" href="Cubical.Reflection.RecordEquiv.html#10968" class="Function">test0</a> <a id="11033" class="Symbol">=</a> <a id="11035" href="Cubical.Reflection.RecordEquiv.html#10855" class="Function">Example0IsoΣ</a>

    <a id="11053" class="Comment">-- A record with no fields is isomorphic to Unit</a>

    <a id="11107" class="Keyword">record</a> <a id="Example.Example1"></a><a id="11114" href="Cubical.Reflection.RecordEquiv.html#11114" class="Record">Example1</a> <a id="11123" class="Symbol">:</a> <a id="11125" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="11130" class="Keyword">where</a>

    <a id="11141" class="Keyword">unquoteDecl</a> <a id="Example.Example1IsoΣ"></a><a id="11153" href="Cubical.Reflection.RecordEquiv.html#11153" class="Function">Example1IsoΣ</a> <a id="11166" class="Symbol">=</a> <a id="11168" href="Cubical.Reflection.RecordEquiv.html#9797" class="Function">declareRecordIsoΣ</a> <a id="11186" href="Cubical.Reflection.RecordEquiv.html#11153" class="Function">Example1IsoΣ</a> <a id="11199" class="Symbol">(</a><a id="11200" class="Keyword">quote</a> <a id="11206" href="Cubical.Reflection.RecordEquiv.html#11114" class="Record">Example1</a><a id="11214" class="Symbol">)</a>

    <a id="Example.test1"></a><a id="11221" href="Cubical.Reflection.RecordEquiv.html#11221" class="Function">test1</a> <a id="11227" class="Symbol">:</a> <a id="11229" href="Cubical.Foundations.Isomorphism.html#744" class="Record">Iso</a> <a id="11233" href="Cubical.Reflection.RecordEquiv.html#11114" class="Record">Example1</a> <a id="11242" href="Cubical.Data.Unit.Base.html#149" class="Record">Unit</a>
    <a id="11251" href="Cubical.Reflection.RecordEquiv.html#11221" class="Function">test1</a> <a id="11257" class="Symbol">=</a> <a id="11259" href="Cubical.Reflection.RecordEquiv.html#11153" class="Function">Example1IsoΣ</a>
</pre></body></html>