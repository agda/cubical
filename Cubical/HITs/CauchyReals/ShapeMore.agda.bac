{-# OPTIONS --safe #-}

module Cubical.HITs.CauchyReals.ShapeMore where

open import Cubical.Foundations.Prelude renaming (Cube to PreludeCube)
open import Cubical.Foundations.Equiv
open import Cubical.Foundations.Equiv.Properties
open import Cubical.Foundations.Isomorphism
open import Cubical.Foundations.HLevels
open import Cubical.Foundations.Function
open import Cubical.Foundations.GroupoidLaws
open import Cubical.Foundations.Transport
open import Cubical.Foundations.Structure
open import Cubical.Foundations.Powerset
open import Cubical.Foundations.Path
open import Cubical.Foundations.Univalence

import Cubical.Functions.Logic as L
open import Cubical.Functions.FunExtEquiv
open import Cubical.Functions.Surjection
open import Cubical.Functions.Embedding

open import Cubical.Data.Unit
open import Cubical.Data.Bool as ùüö hiding (_‚â§_)
open import Cubical.Data.Nat as ‚Ñï hiding (_¬∑_;_+_)
-- open import Cubical.Data.Fin

import Cubical.Data.Nat.Mod as ‚Ñï
import Cubical.Data.Vec as V
import Cubical.Data.Nat.Order as ‚Ñï
open import Cubical.Data.Empty as ‚ä•
open import Cubical.Data.Sum as ‚äé
open import Cubical.Data.Int as ‚Ñ§ using (pos;‚Ñ§)
import Cubical.Data.Int.Order as ‚Ñ§
open import Cubical.Data.Sigma

open import Cubical.HITs.PropositionalTruncation as PT
open import Cubical.HITs.PropositionalTruncation.Monad

open import Cubical.HITs.SetTruncation as ST
open import Cubical.HITs.GroupoidTruncation as GT

open import Cubical.Data.NatPlusOne

open import Cubical.Data.Rationals as ‚Ñö using (‚Ñö ; [_/_])
open import Cubical.Data.Rationals.Order as ‚Ñö using
  ( _‚Ñö‚Çä+_ ; 0<_ ; ‚Ñö‚Çä ; _‚Ñö‚Çä¬∑_ ; ‚Ñö‚Çä‚â°)
open import Cubical.Data.Rationals.Order.Properties as ‚Ñö
 using (inv‚Ñö‚Çä;/2‚Çä;/3‚Çä;/4‚Çä;x/2<x;inv‚Ñö;_‚Ñö^‚Åø_;_‚Ñö‚Çä^‚Åø_)


open import Cubical.HITs.CauchyReals.Base
open import Cubical.HITs.CauchyReals.Lems
open import Cubical.HITs.CauchyReals.Closeness
open import Cubical.HITs.CauchyReals.Lipschitz
open import Cubical.HITs.CauchyReals.Order
open import Cubical.HITs.CauchyReals.Continuous
open import Cubical.HITs.CauchyReals.Multiplication
open import Cubical.HITs.CauchyReals.Inverse
open import Cubical.HITs.CauchyReals.Sequence
open import Cubical.HITs.CauchyReals.Derivative
open import Cubical.HITs.CauchyReals.Integration
open import Cubical.HITs.CauchyReals.IntegrationMore
open import Cubical.HITs.CauchyReals.MeanValue
open import Cubical.HITs.CauchyReals.Exponentiation
open import Cubical.HITs.CauchyReals.ExponentiationDer
open import Cubical.HITs.CauchyReals.ExponentiationMore
open import Cubical.HITs.CauchyReals.Uniform
open import Cubical.HITs.CauchyReals.PiNumber
open import Cubical.HITs.CauchyReals.NthRoot
open import Cubical.HITs.CauchyReals.Summation

open import Cubical.Algebra.Ring.BigOps


open import Cubical.Algebra.CommRing.Properties
open import Cubical.Algebra.Group
open import Cubical.Algebra.Group.Properties
open import Cubical.Algebra.Group.Morphisms
open import Cubical.Algebra.Group.MorphismProperties
open import Cubical.Algebra.AbGroup
open import Cubical.Algebra.CommRing.Base
import Cubical.Data.FinData as FD

open import Cubical.HITs.CauchyReals.TrigonometricIdentities
open import Cubical.HITs.CauchyReals.ArcSin

open import Cubical.HITs.SetQuotients as SQ renaming ([_] to [_]/)
open import Cubical.HITs.GroupoidQuotients as GQ renaming ([_] to [_]//)
open import Cubical.Relation.Binary
open import Cubical.Relation.Nullary
open import Cubical.HITs.CauchyReals.Circle
open import Cubical.HITs.CauchyReals.CircleMore
open import Cubical.HITs.Sn
open import Cubical.HITs.S1 as S1
open import Cubical.HITs.Susp
open import Cubical.Tactics.CommRingSolver
open import Cubical.Algebra.Group.Instances.Int

-- open import Cubical.Categories.Category

-- open import Cubical.WildCat.Base

open import Cubical.Algebra.Group.ZAction

open import Cubical.Structures.Pointed
open import Cubical.Structures.Product

import Cubical.Homotopy.Loopspace as Lsp
import Cubical.Homotopy.Group.Base as HG

open import Cubical.HITs.SequentialColimit as Seq
open import Cubical.Data.Sequence
import Cubical.Foundations.Pointed as P

open import Cubical.Foundations.Cubes

-- open import Cubical.Categories.Category renaming (isIso to isCIso)
-- open import Cubical.Categories.Monoidal
-- open import Cubical.Categories.Functor

-- open import Cubical.HITs.CauchyReals.BoundaryHIT

open import Cubical.HITs.Truncation as T

open import Cubical.HITs.CauchyReals.Shape

open import Cubical.HITs.EilenbergMacLane1.Base

import Cubical.HITs.EilenbergMacLane1 as EM‚ÇÅ

open import Cubical.Homotopy.EilenbergMacLane.Base
open import Cubical.Homotopy.EilenbergMacLane.Properties


private
  variable
   ‚Ñì ‚Ñì' ‚Ñì'' : Level
   X : Type ‚Ñì
-- open TensorStr


-- module _ (A : P.Pointed‚ÇÄ) where


--  ‚â°QuotEquality : ‚àÄ n ‚Üí Path
--   (Œ£ Type (Œª x ‚Üí ((x √ó (x ‚Üí x ‚Üí x)) √ó (x ‚Üí x))))
   
--    (‚à• ‚ü®(Lsp.Œ©^ (suc n)) A ‚ü© ‚à•‚ÇÇ ,
--     (HG.1œÄ (suc n) , HG.¬∑œÄ n) , HG.-œÄ n)
--    ((‚ü®(Lsp.Œ©^ (suc n)) A ‚ü© SQ./ _‚â°_) ,
--      ([ refl ]/ ,
--            setQuotBinOp
--         (Œª _ ‚Üí refl) (Œª _ ‚Üí refl)
--         _‚àô_ Œª _ _  _ _ p q ‚Üí
--           cong (_‚àô _) p ‚àô cong (_ ‚àô_) q)
--            , (setQuotUnaryOp sym Œª _ _ ‚Üí cong sym))
--  ‚â°QuotEquality n = {!!}
--  -- Œ£PathP
--  --   ({!!} , {!!})

  
--  Œ©GSeq : GSeq (Œª n ‚Üí ‚ü® (Lsp.Œ©^ (suc n)) A ‚ü© ) _‚â°_  
--  Œ©GSeq .GSeq.isEquivRel‚âã n =
--   BinaryRelation.equivRel (Œª _ ‚Üí refl ) (Œª _ _ ‚Üí sym) Œª _ _ _ ‚Üí _‚àô_
--  Œ©GSeq .GSeq.obj-inv = sym
--  Œ©GSeq .GSeq.obj-inv-funct _ _ = cong sym
--  Œ©GSeq .GSeq._‚äô_ = _‚àô_
--  Œ©GSeq .GSeq.‚äô-sym n = Lsp.EH n
--  Œ©GSeq .GSeq.‚äô-functL _ _ _ _ = cong (_‚àô _)
--  Œ©GSeq .GSeq.‚äô-functR _ _ _ _ = cong (_ ‚àô_)
--  Œ©GSeq .GSeq.unit = refl
--  Œ©GSeq .GSeq.middleIso = Lsp.IsoŒ©√ó _
--  Œ©GSeq .GSeq.isGrp‚äô/‚ÇÄ =
--    subst (uncurry Œª x ‚Üí uncurry (uncurry (IsGroup {G = x})))
--     (‚â°QuotEquality zero)
--     (GroupStr.isGroup (snd (HG.œÄGr 0 A)))
--  Œ©GSeq .GSeq.isAbGrp‚äô/ n =
--    subst (uncurry Œª x ‚Üí uncurry (uncurry (IsAbGroup {A = x})))
--     (‚â°QuotEquality (suc n))
--     (isabgroup (GroupStr.isGroup (snd (HG.œÄGr (suc n) A)))
--       (ST.elim2 (Œª _ _ ‚Üí isProp‚ÜíisSet (ST.squash‚ÇÇ _ _)) Œª a b ‚Üí cong ‚à£_‚à£‚ÇÇ
--        (Lsp.EH {A = A} n a b)))

--  Œ©GSeq .GSeq.middle-‚äô = {!!}
--  Œ©GSeq .GSeq.reflOver‚âã n = {!!}
--  Œ©GSeq .GSeq.to-middle-‚âã = {!!}
--  Œ©GSeq .GSeq.from-middle-‚âã = {!!}

--  ‚â°QuotGroupIso : ‚àÄ n ‚Üí GroupIso (GSeq.objGroup Œ©GSeq n) (HG.œÄGr n A)
--  ‚â°QuotGroupIso = {!(Œ©GSeq (Shape.Shape‚àô Se))!}


-- open BinaryRelation

-- isOfHLevelSeqColim : (A : Sequence ‚Ñì) (h : HLevel)
--   ‚Üí (‚àÄ n ‚Üí isOfHLevel h (A .Sequence.obj n))
--   ‚Üí isOfHLevel h (SeqColim A)
-- isOfHLevelSeqColim A = {!!}

ColimTruncIso : {A : Sequence ‚Ñì} (h : HLevel)
   ‚Üí Iso (T.‚à• SeqColim A ‚à• h) (SeqColim (truncateSequence h A))
ColimTruncIso {A = A} h .Iso.fun =
 T.rec {!c!}
  (realiseSequenceMap (truncateMap h A))
ColimTruncIso {A = A} h .Iso.inv = {!!}
ColimTruncIso {A = A} h .Iso.rightInv = {!!}
ColimTruncIso {A = A} h .Iso.leftInv = {!!}

module Shape {obj : ‚Ñï ‚Üí Type}
         {_‚âã_ : ‚àÄ {n} ‚Üí Rel (obj n) (obj n) ‚Ñì-zero}
         (gSeq : GSeq obj _‚âã_) where
 open GSeq gSeq

 module Sh-more (n : ‚Ñï) (A : Type) (ptA : A)
            (evS‚Çä : obj n ‚Üí S‚Çä (suc n) ‚Üí A)
            (evS‚Çäpt : ‚àÄ x ‚Üí evS‚Çä x (ptSn (suc n)) ‚â° ptA )
             where
  open Sh n A ptA evS‚Çä evS‚Çäpt public


  module _ (x y : obj (suc n)) where
   opaque 
    evS‚Çä-suc-comp-sq : ‚àÄ (a : S‚Çä (suc n)) ‚Üí Square
      (cong (fst (HG.‚àôŒ† {A = (Sh , œÉ ptA)} {n = suc (suc n)}
        (evS‚Çä-suc x  , evS‚Çäpt-suc _)
        (evS‚Çä-suc y  , evS‚Çäpt-suc _))) (merid a))
      ((spoke (middle (x ‚äô y) .fst) (fst (snd (middle (x ‚äô y))))
           a
           ‚àô‚àô (Œª _ ‚Üí œÉ (evS‚Çä (middle (x ‚äô y) .fst) a)) ‚àô‚àô
           (Œª i‚ÇÅ ‚Üí
              spoke (middle (x ‚äô y) .fst) (snd (snd (middle (x ‚äô y)))) a (~ i‚ÇÅ))))
      (cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô' sym (spoke _ _ _))
      (cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô' sym (spoke _ _ _))
    evS‚Çä-suc-comp-sq a =

      compPathR‚ÜíPathP‚àô‚àô
        (     cong‚ÇÇ _‚àô_
             (evS‚Çä-suc-sq-hlp x a)
             (evS‚Çä-suc-sq-hlp y a) ‚àô
              (Œª j ‚Üí (Œª i ‚Üí evS‚Çä-suc-sq-hlp x a i1 (j ‚àß i))
                 ‚àô‚àô (Œª i ‚Üí evS‚Çä-suc-sq-hlp x a i1 (i ‚à® j))
                  ‚àô‚àô evS‚Çä-suc-sq-hlp y a i1 ) ‚óÅ

          hh ‚àô
         Œª j ‚Üí
           ((
           (cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô'
            sym
            (spoke (middle (x ‚äô y) .fst) (fst (snd (middle (x ‚äô y))))
             (ptSn (suc n))))
           )
        ‚àô‚àô
        (Œª i ‚Üí spoke (middle (x ‚äô y) .fst) (fst (snd (middle (x ‚äô y)))) a i) ‚àô‚àô
        (Œª _ ‚Üí œÉ (evS‚Çä (middle (x ‚äô y) .fst) a)) ‚àô‚àô
        (Œª i ‚Üí
           spoke (middle (x ‚äô y) .fst) (snd (snd (middle (x ‚äô y)))) a (~ i))
        ‚àô‚àô
        sym
        (
           (cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô'
            sym
            (spoke (middle (x ‚äô y) .fst) (snd (snd (middle (x ‚äô y))))
             (ptSn (suc n))))
           )))
       where
       hhh : ‚àÄ m r ‚Üí Square
               (sym (spoke-hub-spoke-pt m r a))
               ((cong œÉ (sym (evS‚Çäpt m))) ‚àô'
             (sym (spoke m r (ptSn (suc n)))))
               refl
               (sym (spoke m r a))
       hhh m r i j = 
         hcomp {œÜ = ~ i ‚à® ~ j ‚à® j}
           (Œª k ‚Üí
             Œª {(i = i0) ‚Üí spoke-hub-spoke-pt m r a (~ j)
               ;(j = i0) ‚Üí œÉ (evS‚Çäpt m (~ i ‚à® k))
               ;(j = i1) ‚Üí spoke m r a (~ i)
               })
           (spoke-hub-sq m r a i (~ j))

       hh : (evS‚Çä-suc-sq-hlp x a i1 ‚àô‚àô
             (refl {x = œÉ ptA}) ‚àô‚àô evS‚Çä-suc-sq-hlp y a i1)
             ‚â°
                ((((cong
                   œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst)))) ‚àô'
             (sym (spoke (middle (x ‚äô y) .fst)
                (fst (snd (middle (x ‚äô y))))
                    (ptSn (suc n)))))
            ‚àô‚àô
            ((spoke (middle (x ‚äô y) .fst)
                (fst (snd (middle (x ‚äô y)))) a)
            ‚àô‚àô refl ‚àô‚àô
            (sym
               (spoke
                (middle (x ‚äô y) .fst)
                 (snd (snd (middle (x ‚äô y)))) a)))
            ‚àô‚àô
            ((((
                   spoke (middle (x ‚äô y) .fst)
                    (snd (snd (middle (x ‚äô y))))
                   (ptSn (suc n))))
                   ‚àô (cong
                 œÉ ((evS‚Çäpt (middle (x ‚äô y) .fst))))))
               ))
       hh = {!!}
            ‚àô Œª j ‚Üí
               (hhh _ (fst (snd (middle (x ‚äô y)))) j
                 ‚àô‚àô doubleCompPath-filler
                  (spoke (middle (x ‚äô y) .fst)
                (fst (snd (middle (x ‚äô y)))) a)
                refl
                (sym
               (spoke
                (middle (x ‚äô y) .fst)
                 (snd (snd (middle (x ‚äô y)))) a)) j
                 ‚àô‚àô sym
                  (hhh _ (snd (snd (middle (x ‚äô y)))) j))
    evS‚Çä-suc-comp : ‚àÄ s ‚Üí
      fst (HG.‚àôŒ† {A = (Sh , œÉ ptA)}
        (evS‚Çä-suc x  , evS‚Çäpt-suc _)
        (evS‚Çä-suc y  , evS‚Çäpt-suc _)) s ‚â°
        (evS‚Çä-suc (x ‚äô y)) s
    evS‚Çä-suc-comp north = cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô' sym (spoke _ _ _)
    evS‚Çä-suc-comp south = cong œÉ (sym (evS‚Çäpt (middle (x ‚äô y) .fst))) ‚àô' sym (spoke _ _ _)
    evS‚Çä-suc-comp (merid a i) j = evS‚Çä-suc-comp-sq a j i


    evS‚Çä-suc-compPt : 

          PathP
            (Œª i ‚Üí
               funExt (evS‚Çä-suc-comp) i (S‚Çä‚àô (suc (suc n)) .snd) ‚â°
               Sh‚àô .snd)
               (¬∑Susp (S‚Çä‚àô (suc n))
                (evS‚Çä-suc x , evS‚Çäpt-suc x)
                (evS‚Çä-suc y , evS‚Çäpt-suc y) .snd)
            (evS‚Çäpt-suc (x ‚äô y))
    evS‚Çä-suc-compPt i j =
     evS‚Çäpt-suc (x ‚äô y) (~ i ‚à® j)




 Œ£Ty : ‚Ñï ‚Üí Type‚ÇÅ
 Œ£Ty n = Œ£[ X ‚àà Type ] ( (Œ£[ (ptX , ev) ‚àà (X √ó (obj n ‚Üí S‚Çä (suc n) ‚Üí X)) ]
         ((x : obj n) ‚Üí ev x (ptSn (suc n)) ‚â° ptX)))

 Œ£Ty-ev‚àô : ‚àÄ n ‚Üí (X : Œ£Ty n) ‚Üí
    obj n ‚Üí fst (S‚Çä‚àô (suc n) P.‚Üí‚àô (fst X , fst (fst (snd X))) ‚àô)
 Œ£Ty-ev‚àô n X o = snd (fst (snd X)) o , (snd (snd X)) o
 
--  Œ£Ty-inv : ‚àÄ n ‚Üí (X : Œ£Ty n) ‚Üí ‚àÄ x ‚Üí
--    ‚à£ Œ£Ty-ev‚àô n X (obj-inv x) ‚à£‚ÇÇ ‚â° HG.-œÄ' n ‚à£ (Œ£Ty-ev‚àô n X x) ‚à£‚ÇÇ  
--  Œ£Ty-inv = {!!}

--  -- Œ£Ty-1g : ‚àÄ n ‚Üí (X : Œ£Ty n) ‚Üí 
--  --   ‚à£ Œ£Ty-ev‚àô n X (unit) ‚à£‚ÇÇ ‚â°  HG.1œÄ' (suc n)  
--  -- Œ£Ty-1g = {!!}

 trunc : ‚Ñï ‚Üí ‚àÄ n ‚Üí Œ£Ty n
         ‚Üí Œ£Ty n
 trunc h n (X , ((ptX , ev) , (ev-pt))) = 
  hLevelTrunc h X ,
  (‚à£ ptX ‚à£‚Çï ,  (‚à£_‚à£‚Çï ‚àò_) ‚àò ev) , (cong ‚à£_‚à£‚Çï ‚àò ev-pt) 
   -- where
   --  ww : (x y : obj n) ‚Üí
   --        HG.‚àôŒ† ((Œª x‚ÇÅ ‚Üí ‚à£ ev x x‚ÇÅ ‚à£‚Çï) , (Œª i ‚Üí ‚à£ ev-pt x i ‚à£‚Çï))
   --        ((Œª x‚ÇÅ ‚Üí ‚à£ ev y x‚ÇÅ ‚à£‚Çï) , (Œª i ‚Üí ‚à£ ev-pt y i ‚à£‚Çï))
   --        ‚â° ((Œª x‚ÇÅ ‚Üí ‚à£ ev (x ‚äô y) x‚ÇÅ ‚à£‚Çï) , (Œª i ‚Üí ‚à£ ev-pt (x ‚äô y) i ‚à£‚Çï))
   --  ww x y = Œ£PathP (funExt ww‚ÇÅ , {!!})
   --   where
   --   ww‚ÇÅ : (x‚ÇÅ : S‚Çä‚àô (suc n) .fst) ‚Üí
   --         Path
   --         (hLevelTrunc h X)
   --          (fst
   --          (HG.‚àôŒ† ((Œª x‚ÇÇ ‚Üí ‚à£ ev x x‚ÇÇ ‚à£‚Çï) , (Œª i ‚Üí ‚à£ ev-pt x i ‚à£‚Çï))
   --           ((Œª x‚ÇÇ ‚Üí ‚à£ ev y x‚ÇÇ ‚à£‚Çï) , (Œª i ‚Üí ‚à£ ev-pt y i ‚à£‚Çï)))
   --          x‚ÇÅ)
   --           ‚à£ ev (x ‚äô y) x‚ÇÅ ‚à£‚Çï
   --   ww‚ÇÅ x‚ÇÅ = {!!} ‚àô cong ‚à£_‚à£‚Çï (cong fst (ev+ x y) ‚â°$ x‚ÇÅ)

 Sh‚ÇÄ : Œ£Ty zero
 Sh‚ÇÄ .fst = Unit // Œª _ _ _ ‚Üí _‚äô_ {zero} 
 Sh‚ÇÄ .snd .fst .fst = [ tt ]//
 Sh‚ÇÄ .snd .fst .snd o = S1.rec [ tt ]// (eq// o) 
 Sh‚ÇÄ .snd .snd _ = refl

-- EM‚ÇÅ (objGroup zero)
--   , (embase , Œª o ‚Üí S1.rec embase (emloop [ o ]/) )
--   , Œª _ ‚Üí refl

 Sh‚Çô : ‚àÄ n ‚Üí Œ£Ty n
 Sh‚Çô zero = Sh‚ÇÄ
 Sh‚Çô (suc n) = Sh , (œÉ (fst (fst (snd (Sh‚Çô-trunc)))) ,
     evS‚Çä-suc) , (evS‚Çäpt-suc)
  where
   Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
   open Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
    (snd (fst (snd (Sh‚Çô-trunc))))
    ((snd (snd (Sh‚Çô-trunc))))

 Sh‚Çô‚àô : ‚Ñï ‚Üí P.Pointed ‚Ñì-zero
 Sh‚Çô‚àô n = fst (Sh‚Çô n) , fst (fst (snd (Sh‚Çô n))) 
 
 œÉ‚àô : ‚àÄ n ‚Üí Sh‚Çô‚àô n P.‚Üí‚àô Sh‚Çô‚àô (suc n)
 œÉ‚àô n .fst = Sh.œÉ ‚àòS ‚à£_‚à£
 œÉ‚àô n .snd = refl

 Sh‚Çô-ev : ‚àÄ {n} ‚Üí obj n ‚Üí S‚Çä‚àô (suc n) P.‚Üí‚àô (Sh‚Çô‚àô n)
 Sh‚Çô-ev {n} = Œ£Ty-ev‚àô n (Sh‚Çô n) 
 
 Sh-comp : ‚àÄ n ‚Üí (o o' : obj n) ‚Üí
         
        (HG.‚àôŒ† {A = Sh‚Çô‚àô n} (Sh‚Çô-ev o) (Sh‚Çô-ev o'))
        ‚â° (Sh‚Çô-ev (o ‚äô o'))
 Sh-comp zero o o' =
   Œ£PathP ( (funExt (S1.elim _
       refl (flipSquare
         (cong‚ÇÇ _‚àô_ (sym (rUnit _)) (sym (rUnit _))
          ‚àô sym (comp'// Unit (Œª _ _ _ ‚Üí _‚äô_) o o'))))
      ) , refl)
 Sh-comp (suc n) o o' = Œ£PathP
   ((funExt (evS‚Çä-suc-comp o o'))
     , evS‚Çä-suc-compPt o o')

-- -- evS‚Çä-suc-comp
   where
   Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
   open Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
    (snd (fst (snd (Sh‚Çô-trunc))))
    ((snd (snd (Sh‚Çô-trunc))))
 
--  -- Sh‚Çô‚ÜíS‚Çä‚àôn‚Üí‚àô : ‚àÄ n ‚Üí obj n ‚Üí  (S‚Çä‚àô (suc n) P.‚Üí‚àô Sh‚Çô‚àô (suc n)) 
--  -- Sh‚Çô‚ÜíS‚Çä‚àôn‚Üí‚àô n o = œÉ ‚àò (snd (fst (snd (Sh‚Çô-trunc)))) o ,
--  --   cong œÉ ((fst (snd (snd (Sh‚Çô-trunc)))) _) 
--  --  where
--  --   Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
--  --   open Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
--  --    (snd (fst (snd (Sh‚Çô-trunc))))
--  --    (fst (snd (snd (Sh‚Çô-trunc))))


--  -- Sh‚Çô‚ÜíœÄ' : ‚àÄ n ‚Üí obj n ‚Üí ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü©
--  -- Sh‚Çô‚ÜíœÄ' n s = ‚à£ Sh‚Çô‚ÜíS‚Çä‚àôn‚Üí‚àô n s ‚à£‚ÇÇ 


 -- Sh-CODE : fst (Sh‚Çô 1) ‚Üí hSet ‚Ñì-zero 
 -- Sh-CODE = {!!}


 ShSequence : Sequence ‚Ñì-zero
 ShSequence .Sequence.obj n = fst (Sh‚Çô n)
 ShSequence .Sequence.map = fst (œÉ‚àô _)


 Shape : Type ‚Ñì-zero
 Shape = SeqColim ShSequence



 truncatedShConverges : (m : ‚Ñï) ‚Üí 
  converges (truncateSequence (2 ‚Ñï.+ m) ShSequence) m
 truncatedShConverges n zero =
   subst isEquiv (funExt (T.elim
    (Œª _ ‚Üí
      isOfHLevelPath (suc (suc n)) (isOfHLevelTrunc (suc (suc n))) _ _)
      (Œª _ ‚Üí refl)))
    (isoToIsEquiv (compIso (truncOfTruncIso (2 ‚Ñï.+ n) 2) Trunc-Sh))
  where

  Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
  open Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
   (snd (fst (snd (Sh‚Çô-trunc))))
   ((snd (snd (Sh‚Çô-trunc))))
 truncatedShConverges m k@(suc k') = zzz
  
  where
    n n' : ‚Ñï
    n = (k ‚Ñï.+ m)
    n' = k' ‚Ñï.+ m
    Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
    Sh‚Çô-trunc' = trunc (4 ‚Ñï.+ n') n' (Sh‚Çô n')
    module M = Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
     (snd (fst (snd (Sh‚Çô-trunc))))
     ((snd (snd (Sh‚Çô-trunc))))

    module M' = Sh-more n' (fst (Sh‚Çô-trunc')) (fst (fst (snd (Sh‚Çô-trunc'))))
     (snd (fst (snd (Sh‚Çô-trunc'))))
     ((snd (snd (Sh‚Çô-trunc'))))



    zzz' : isEquiv {A = T.‚à• fst (Sh‚Çô (k ‚Ñï.+ m)) ‚à•
                      (suc (suc m))}
                 {B = T.‚à•  fst (Sh‚Çô (suc (k ‚Ñï.+ m))) ‚à•
                     (suc (suc m))}
            _
    zzz' = isoToIsEquiv
      (compIso
      (compIso (compIso (truncOfTruncIso (2 ‚Ñï.+ m) (2 ‚Ñï.+ k))
         (T.mapCompIso
           (substIso (T.‚à• fst (Sh‚Çô (k ‚Ñï.+ m))  ‚à•_)
             (cong (suc ‚àò suc) (((‚Ñï.+-suc k (suc m))
               ‚àô (‚Ñï.+-suc (suc k) m)))))))
          (truncOfTruncIso (2 ‚Ñï.+ m) k))
       (compIso (T.mapCompIso {n = 2 ‚Ñï.+ m}
         ( (compIso (compIso
           (substIso (T.‚à• fst Sh‚Çô-trunc  ‚à•_)
            ((‚Ñï.+-suc k (suc m)) ‚àô (‚Ñï.+-suc (suc k) m))) M.Trunc-Sh)
           ((substIso
           (T.‚à• fst (Sh‚Çô (suc (k ‚Ñï.+ m))) ‚à•_)
           (sym (‚Ñï.+-suc (suc k) _) ‚àô
             sym (‚Ñï.+-suc k (suc m))))))))
         ((invIso (truncOfTruncIso (2 ‚Ñï.+ m) k)))))

    zzz : isEquiv {A = T.‚à• fst (Sh‚Çô (k ‚Ñï.+ m)) ‚à•
                      (suc (suc m))}
                 {B = T.‚à•  fst (Sh‚Çô (suc (k ‚Ñï.+ m))) ‚à•
                     (suc (suc m))}
            _
    zzz = subst isEquiv (funExt (T.elim {n = suc (suc m)} {B = _}
         (Œª _ ‚Üí isOfHLevelPath (suc (suc m))
           (isOfHLevelTrunc (suc (suc m)))
           _ _ )
         (cong (‚à£_‚à£ ‚àòS M.Sh.œÉ ‚àòS  ‚à£_‚à£) ‚àò
          Œª _ ‚Üí transportRefl _ ‚àô‚àô
            transportRefl _ ‚àô‚àô transportRefl _))) zzz'

 trunc-Sh‚Çô-Shape : ‚àÄ n ‚Üí Iso
   (T.‚à• fst (Sh‚Çô n) ‚à• suc (suc n))
   (T.‚à• Shape ‚à• suc (suc n))
 trunc-Sh‚Çô-Shape n =
  compIso (converges‚ÜíColimIso {seq = truncateSequence (2 ‚Ñï.+ n) ShSequence}
   n (truncatedShConverges n)) (invIso (ColimTruncIso (suc (suc n))))

 Shape‚àô : P.Pointed ‚Ñì-zero
 Shape‚àô = (Shape , incl {n = zero} ([ tt ]//))

 trunc-Sh‚Çô-Shape-‚âÉ‚àô : ‚àÄ n ‚Üí
      hLevelTrunc‚àô (suc (suc (suc n))) Shape‚àô P.‚âÉ‚àô
      hLevelTrunc‚àô (suc (suc (suc n))) (Sh‚Çô‚àô (suc n))
 trunc-Sh‚Çô-Shape-‚âÉ‚àô n .fst = isoToEquiv (invIso (trunc-Sh‚Çô-Shape (suc n)))
 trunc-Sh‚Çô-Shape-‚âÉ‚àô n .snd = {!c!}
 
--   -- (isoToEquiv (invIso (trunc-Sh‚Çô-Shape (suc n)))) ,
--   --  (elimShiftedŒ≤ (truncateSequence (suc (suc (suc n))) ShSequence) n
--   --   {!!} {!!} {!!} ‚â°$ ( ‚à£_‚à£ {n = suc (suc n)}
--   --    ( embase {‚Ñì = ‚Ñì-zero} {Group = {!!}} ) ) )
--   --    ‚àô {!!}
 
 œÄ-trunc-Sh‚Çô-Shape : ‚àÄ n ‚Üí GroupIso
    (HG.œÄGr n Shape‚àô)
    (HG.œÄGr n (Sh‚Çô‚àô (suc n)))
 œÄ-trunc-Sh‚Çô-Shape n = compGroupIso
   (HG.œÄTruncGroupIso n)
    (compGroupIso
    (GroupEquiv‚ÜíGroupIso
       (HG.œÄIso (trunc-Sh‚Çô-Shape-‚âÉ‚àô n) n))
    (invGroupIso (HG.œÄTruncGroupIso n)))


 Is‚àûGrp‚Çô : Type
 Is‚àûGrp‚Çô = ‚àÄ n ‚Üí GroupIso
   (objGroup n)
   (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))

 

 Is‚àûGrp‚â§ : ‚Ñï ‚Üí Type
 Is‚àûGrp‚â§ N = ‚àÄ n ‚Üí n ‚Ñï.‚â§ N ‚Üí GroupIso
   (objGroup n)
   (HG.œÄGr n Shape‚àô)

 Is‚àûGrp‚â§' : ‚Ñï ‚Üí Type
 Is‚àûGrp‚â§' N = ‚àÄ n ‚Üí n ‚Ñï.‚â§ N ‚Üí GroupIso
   (objGroup n)
   (HG.œÄGr n (Sh‚Çô‚àô (suc n)))

 CODE-Sh‚ÇÄ : fst (Sh‚Çô 0) ‚Üí hSet ‚Ñì-zero
 CODE-Sh‚ÇÄ = GQ.rec
  (Œª _ _ _ ‚Üí _‚äô_) isGroupoidHSet
   (Œª _ ‚Üí obj/ 0 , squash/)
   (Œª o ‚Üí TypeOfHLevel‚â° 2 (ua (rightEquiv (objGroup 0) [ o ]/)) )
   Œª r s ‚Üí Œ£SquareSet (Œª _ ‚Üí isProp‚ÜíisSet isPropIsSet)
     (symP (compPathR‚ÜíPathP‚àô‚àô
       (cong ua (equivEq (funExt
         Œª t ‚Üí GroupStr.¬∑Assoc (snd (objGroup 0)) t [ r ]/ [ s ]/))
         ‚àô uaCompEquiv _ _)))
 
 CODE-Sh‚ÇÅ : fst (Sh‚Çô 1) ‚Üí hSet ‚Ñì-zero
 CODE-Sh‚ÇÅ = Sh-more.ShRec-sn.go _ _ _ _ _ w
  where
  w : Sh-more.ShRec-sn 0
        _  _ _ _ (hSet ‚Ñì-zero)
  w .GSeq.Sh.ShRec-sn.œÉB =
   T.rec (isOfHLevelSuc 3 isGroupoidHSet )
    CODE-Sh‚ÇÄ 
  w .GSeq.Sh.ShRec-sn.hubB _ _ = CODE-Sh‚ÇÄ [ tt ]//
  w .GSeq.Sh.ShRec-sn.spokeB m r = 
    S1.elim _ refl
     (flipSquare (Œ£SquareSet (Œª _ ‚Üí isProp‚ÜíisSet isPropIsSet)
      (sym uaIdEquiv ‚àô cong ua (equivEq
        (funExt Œª x ‚Üí  sym (GroupStr.¬∑IdR 
              (snd (objGroup 0)) x) ‚àô
               cong (x ‚äô/_) (eq/ _ _ r) 
          )) )))

 sh-loop : obj/ 0 ‚Üí ‚ü® HG.œÄGr 0 (Sh‚Çô‚àô 1) ‚ü© 
 sh-loop = SQ.Rec.go w
  where
   w : Rec ‚ü® HG.œÄGr 0 (Sh‚Çô‚àô 1)  ‚ü©
   w .Rec.isSetB = squash‚ÇÇ
   w .Rec.f o = ‚à£  cong (Sh-more.œÉ ‚àòS ‚à£_‚à£) (eq// o) ‚à£‚ÇÇ
   w .Rec.f‚àº a a' a‚âãa' = {!!}
    where
    ww : {!!} ‚â° eq// a ‚àô eq// (obj-inv a')
    ww = {!!}
      ‚àô comp'// Unit (Œª _ _ _ ‚Üí _‚äô_ {zero}) a (obj-inv a')

 CODE-Sh‚Çô : ‚àÄ n ‚Üí T.hLevelTrunc (3 ‚Ñï.+ n) (fst (Sh‚Çô‚àô (suc n)))
    ‚Üí TypeOfHLevel ‚Ñì-zero (2 ‚Ñï.+ n)
 CODE-Sh‚Çô zero = T.rec (isOfHLevelTypeOfHLevel 2) CODE-Sh‚ÇÅ
 CODE-Sh‚Çô (suc n) =
   T.rec (isOfHLevelTypeOfHLevel (3 ‚Ñï.+ n))
     (Sh-more.ShRec-sn.go _ _ _ _ _ w)
  where

  Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
  module SS =
    Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
   (snd (fst (snd (Sh‚Çô-trunc))))
   ((snd (snd (Sh‚Çô-trunc))))


  wwC : T.hLevelTrunc (4 ‚Ñï.+ (suc n)) (fst (Sh‚Çô‚àô (suc n))) ‚Üí
         TypeOfHLevel ‚Ñì-zero (suc (suc (suc n)))
  wwC a = Path
       (T.hLevelTrunc (3 ‚Ñï.+ (suc n))
         (fst (Sh‚Çô‚àô (suc (suc n)))))
       ‚à£ (snd (Sh‚Çô‚àô (suc (suc n)))) ‚à£ ‚à£ Sh.œÉ a ‚à£

    , isOfHLevelPath' (3 ‚Ñï.+ n) (isOfHLevelTrunc (4 ‚Ñï.+ n)) _ _


  w : Sh-more.ShRec-sn (suc n)
        _  _ _ _ (TypeOfHLevel ‚Ñì-zero (2 ‚Ñï.+ suc n))
  w .GSeq.Sh.ShRec-sn.œÉB = wwC
  w .GSeq.Sh.ShRec-sn.hubB _ _ =
   wwC ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£
  w .GSeq.Sh.ShRec-sn.spokeB m r s =
   TypeOfHLevel‚â° (suc (suc (suc n)))
   (ua eee)
   where
   eee : (‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£ ‚â°
          ‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£) ‚âÉ
           (‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£ ‚â°
           _)
   eee = compPathrEquiv (cong ‚à£_‚à£
    (sym (Sh.spoke-hub-spoke-pt m r s) ))



--  CODE-Sh‚Çô' : ‚àÄ n ‚Üí
--   Œ£ ((Œ± : T.hLevelTrunc (3 ‚Ñï.+ n) (fst (Sh‚Çô‚àô (suc n))))
--     ‚Üí Œ£ (TypeOfHLevel ‚Ñì-zero (2 ‚Ñï.+ n))
--         Œª (X , _) ‚Üí X ‚Üí ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£ ‚â° Œ±)
--   (Œª CO ‚Üí fst (fst (CO ‚à£ snd (Sh‚Çô‚àô (suc n)) ‚à£)))
--  CODE-Sh‚Çô' zero = {!!}
--   -- T.rec (isOfHLevelTypeOfHLevel 2) CODE-Sh‚ÇÅ
--  CODE-Sh‚Çô' (suc n) = T.elim
--    (Œª _ ‚Üí isOfHLevelŒ£ (4 ‚Ñï.+ n)
--      ((isOfHLevelTypeOfHLevel (3 ‚Ñï.+ n)))
--       Œª _ ‚Üí isOfHLevelŒ† ((4 ‚Ñï.+ n)) Œª _ ‚Üí  {!!})
--        (Sh-more.ShElim.go _ _ _ _ _ w) , refl
-- --    T.rec (isOfHLevelTypeOfHLevel (3 ‚Ñï.+ n))
-- --      (Sh-more.ShRec-sn.go _ _ _ _ _ w)
--   where

--   Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
--   module SS =
--     Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
--    (snd (fst (snd (Sh‚Çô-trunc))))
--    ((snd (snd (Sh‚Çô-trunc))))


--   wwC : T.hLevelTrunc (4 ‚Ñï.+ (suc n)) (fst (Sh‚Çô‚àô (suc n))) ‚Üí
--          TypeOfHLevel ‚Ñì-zero (suc (suc (suc n)))
--   wwC a = Path
--        (T.hLevelTrunc (3 ‚Ñï.+ (suc n))
--          (fst (Sh‚Çô‚àô (suc (suc n)))))
--        ‚à£ (snd (Sh‚Çô‚àô (suc (suc n)))) ‚à£ ‚à£ Sh.œÉ a ‚à£

--     , isOfHLevelPath' (3 ‚Ñï.+ n) (isOfHLevelTrunc (4 ‚Ñï.+ n)) _ _

--   Œ£wwC : ‚àÄ x ‚Üí _ 
--   Œ£wwC a = wwC a , idfun _
--   w : Sh-more.ShElim (suc n) _ _ _ _ _
--   w .GSeq.Sh.ShElim.œÉB = Œ£wwC
--   w .GSeq.Sh.ShElim.hubB m r =
--     (_ ,
--      isOfHLevelPath' (3 ‚Ñï.+ n)
--       (isOfHLevelTrunc (4 ‚Ñï.+ n)) _ _) , Œª p ‚Üí p
--   w .GSeq.Sh.ShElim.spokeB m r s =
--    Œ£PathP (TypeOfHLevel‚â° (suc (suc (suc n)))
--      (ua eee)
--      , ua‚Üí Œª _ ‚Üí compPath-filler _ _)
--     where
--     eee : (_ ‚â° _) ‚âÉ (_ ‚â° _)
--     eee = compPathrEquiv (cong ‚à£_‚à£
--            (Sh.spoke m r s))
--   w .GSeq.Sh.ShElim.spoke-hub-spokeB = {!!}
--   w .GSeq.Sh.ShElim.spoke-hub-sqB = {!!}
  
  -- w : Sh-more.ShRec-sn (suc n)
  --       _  _ _ _ (TypeOfHLevel ‚Ñì-zero (2 ‚Ñï.+ suc n))
  -- w .GSeq.Sh.ShRec-sn.œÉB = wwC
  -- w .GSeq.Sh.ShRec-sn.hubB _ _ =
  --  wwC ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£
  -- w .GSeq.Sh.ShRec-sn.spokeB m r s =
  --  TypeOfHLevel‚â° (suc (suc (suc n)))
  --  (ua eee)
  --  where
  --  eee : (‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£ ‚â°
  --         ‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£) ‚âÉ
  --          (‚à£ snd (Sh‚Çô‚àô (suc (suc n))) ‚à£ ‚â°
  --          _)
  --  eee = compPathrEquiv (cong ‚à£_‚à£
  --   (sym (Sh.spoke-hub-spoke-pt m r s) ))


--   -- encode-Sh‚Çô : ‚àÄ n x ‚Üí ‚ü® CODE-Sh‚Çô n x ‚ü© ‚Üí
--   --   ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£ ‚â° x
--   -- encode-Sh‚Çô zero = {!!}
--   -- encode-Sh‚Çô (suc zero) = {!!}
--   -- encode-Sh‚Çô (suc (suc n)) = T.elim {!!}
--   --   (Sh-more.ShElim.go _ _ _ _ _  ww)
--   --  where
--   --  ww : Sh-more.ShElim
--   --        _ _ _ _ _
--   --        Œª z ‚Üí
--   --           ‚ü® CODE-Sh‚Çô (suc (suc n)) ‚à£ z ‚à£‚Çï ‚ü©
--   --            ‚Üí ‚à£ snd (Sh‚Çô‚àô (suc (suc (suc n)))) ‚à£ ‚â° ‚à£ z ‚à£‚Çï
--   --  ww .GSeq.Sh.ShElim.œÉB =
--   --   T.elim {!!} Œª a ‚Üí {!!}
     
--   --  ww .GSeq.Sh.ShElim.hubB m r x = {!!} ‚àô {!!}
--   --  ww .GSeq.Sh.ShElim.spokeB m r x = {!!}
--   --  ww .GSeq.Sh.ShElim.spoke-hub-spokeB = {!!}
--   --  ww .GSeq.Sh.ShElim.spoke-hub-sqB = {!!}


  -- CODE-pt : ‚àÄ n ‚Üí fst
  --  (fst (fst (CODE-Sh‚Çô' n ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£)))
  --     -- ‚ü® (fst (CODE-Sh'‚Çô n ‚à£ (snd (Sh‚Çô‚àô (suc n))))) ‚à£ ‚ü©
  -- CODE-pt n = {!!} 
  
  -- decode-Sh‚Çô : ‚àÄ n x ‚Üí ‚à£ (snd (Sh‚Çô‚àô (suc n))) ‚à£ ‚â° x
  --   ‚Üí ‚ü® (fst (fst (CODE-Sh‚Çô' n) x)) ‚ü©
  -- decode-Sh‚Çô n x p =
  --  subst (Œª x ‚Üí ‚ü® (fst (fst (CODE-Sh‚Çô' n) x)) ‚ü©) p
  --   (snd (CODE-Sh‚Çô' n))
   
 Is‚àûGrp‚ÇÄ-Iso : Iso ‚ü® objGroup zero ‚ü© ‚ü® HG.œÄGr 0 (Sh‚Çô‚àô 1) ‚ü©
 Is‚àûGrp‚ÇÄ-Iso .Iso.fun = sh-loop
 Is‚àûGrp‚ÇÄ-Iso .Iso.inv =
  ST.rec squash/ (flip (subst (fst ‚àò CODE-Sh‚ÇÅ)) [ unit ]/ )
 Is‚àûGrp‚ÇÄ-Iso .Iso.rightInv =
   ST.elim 
   (Œª _ ‚Üí isProp‚ÜíisSet (squash‚ÇÇ _ _))
    {!!}
   -- (J (Œª y p ‚Üí
   --    {!sh-loop ?!} ‚â° ‚à£ p ‚à£‚ÇÇ) {!!})
   --  -- (J (Œª y (p : _ ‚â° y) ‚Üí
   --  --   ‚à£ {!subst (fst ‚àò CODE-Sh‚ÇÅ) p ?!} ‚à£‚ÇÇ ‚â° ‚à£ {!!} ‚à£‚ÇÇ )
   --  --  {!!})

-- (a : typ ((Lsp.Œ©^ suc 0) (Sh‚Çô‚àô 1))) ‚Üí
--       Iso.fun Is‚àûGrp‚ÇÄ-Iso (Iso.inv Is‚àûGrp‚ÇÄ-Iso ‚à£ a ‚à£‚ÇÇ) ‚â° ‚à£ a ‚à£‚ÇÇ

 Is‚àûGrp‚ÇÄ-Iso .Iso.leftInv =
  SQ.elimProp (Œª _ ‚Üí squash/ _ _)
   Œª a ‚Üí transportRefl _ ‚àô
      GroupStr.¬∑IdL (snd (objGroup 0)) [ a ]/
 
 Is‚àûGrp‚ÇÄ : GroupIso (objGroup zero) (HG.œÄGr zero Shape‚àô)
 Is‚àûGrp‚ÇÄ = compGroupIso
   {!!}
   (invGroupIso (œÄ-trunc-Sh‚Çô-Shape zero))
  where
  w : Iso (objGroup zero .fst) (HG.œÄGr zero Shape‚àô .fst)
  w = {!!}





--  -- isGrp‚àûem : ‚àÄ n ‚Üí Iso 
--  --    ‚ü® HG.œÄ'Gr n (EM‚àô (objAbGroup n) n) ‚ü©
--  --    ‚ü® HG.œÄ'Gr n Shape‚àô ‚ü©
--  -- isGrp‚àûem zero = {!!}
--  -- isGrp‚àûem (suc n) = {!!}

--  -- ‚àûgrpsIso : ‚àÄ n ‚Üí Iso
--  --   ‚ü® objGroup n ‚ü©
--  --   ‚ü® HG.œÄGr n Shape‚àô ‚ü© 
 
--  -- ‚àûgrpsIso zero = invIso (compIso (fst (œÄ-trunc-Sh‚Çô-Shape 0)) ({!Œ©EM^ 1!}) )
--  -- ‚àûgrpsIso (suc n) = {!!}
 
--  -- Is‚àûGrp : Type
--  -- Is‚àûGrp = ‚àÄ n ‚Üí GroupIso
--  --   (objGroup n)
--  --   (HG.œÄ'Gr n Shape‚àô)



--  -- is‚àûGrp : Is‚àûGrp
--  -- is‚àûGrp zero = {!!}
--  -- is‚àûGrp (suc n) = {!!}

module GSeqSuc (obj : ‚Ñï ‚Üí Type)
         (_‚âã_ : ‚àÄ {n} ‚Üí Rel (obj n) (obj n) ‚Ñì-zero)
         (gseq : GSeq obj _‚âã_ ) where

 module G = GSeq gseq
 module G' = Shape gseq 
 GSeqSuc : GSeq (obj ‚àò suc) _‚âã_
 GSeqSuc = w
  where

  w : GSeq (obj ‚àò suc) _‚âã_
  w .GSeq.isEquivRel‚âã n = G.isEquivRel‚âã (suc n)
  w .GSeq.obj-inv = G.obj-inv 
  w .GSeq.obj-inv-funct = G.obj-inv-funct
  w .GSeq._‚äô_ = G._‚äô_
  w .GSeq.‚äô-sym = G.‚äô-sym ‚àò suc
  w .GSeq.‚äô-functL = G.‚äô-functL ‚àò suc
  w .GSeq.‚äô-functR = G.‚äô-functR ‚àò suc
  w .GSeq.unit = G.unit
  w .GSeq.middleIso = G.middleIso
  w .GSeq.isGrp‚äô/‚ÇÄ =
   AbGroupStr.isGroup
    (abgroupstr _ _ _ (G.isAbGrp‚äô/ zero)) 
  w .GSeq.isAbGrp‚äô/ = G.isAbGrp‚äô/ ‚àò suc
  w .GSeq.middle-‚äô = G.middle-‚äô ‚àò suc
  w .GSeq.reflOver‚âã = G.reflOver‚âã ‚àò suc
  w .GSeq.to-middle-‚âã = G.to-middle-‚âã ‚àò suc
  w .GSeq.from-middle-‚âã = G.from-middle-‚âã ‚àò suc
 
 -- module SG = GSeq GSeqSuc
 -- module SG' = Shape GSeqSuc


-- is‚àûGrpShapeŒ© : ‚àÄ N n ‚Üí n ‚Ñï.‚â§ N ‚Üí {obj : ‚àÄ n ‚Üí Type}
-- ¬†             {_‚âã_ : {n = n : ‚Ñï} ‚Üí Rel (obj n) (obj n) ‚Ñì-zero}
--             ‚Üí GroupIso {!!} {!!}
-- is‚àûGrpShapeŒ© = {!!}

 -- SH-CODE :
 --      ‚àÄ n ‚Üí
 --       Œ£ ((Œ± : fst (T.hLevelTrunc‚àô (4 ‚Ñï.+ n)
 --            (G'.Sh‚Çô‚àô(suc (suc n))))) ‚Üí
 --             Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ n)) Œª (X , _) ‚Üí
 --              X ‚Üí
 --               ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc n))) ‚à£
 --                ‚â° Œ±)
 --         Œª X ‚Üí fst (fst (X
 --             ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc n))) ‚à£))
 -- SH-CODE zero = {!!}            
 -- SH-CODE (suc n) = T.elim {!!}
 --   (G.Sh.ShElim.go ww) , {!!}
 --  where
 --  Sh‚Çô-trunc =
 --    G'.trunc (4 ‚Ñï.+ (suc (suc n))) (suc (suc n))
 --      (G'.Sh‚Çô (suc (suc n)))
 --  module SS =
 --    G'.Sh-more (suc (suc n))
 --      (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
 --   (snd (fst (snd (Sh‚Çô-trunc))))
 --   ((snd (snd (Sh‚Çô-trunc))))

 --  ppp = SH-CODE n

 --  ww : G.Sh.ShElim _ _ _ _ _
 --    Œª z ‚Üí
 --       Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ suc n))
 --       (Œª (X , _) ‚Üí
 --          X ‚Üí
 --          Path (T.hLevelTrunc (5 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc (suc n))))))
 --          ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc (suc n)))) ‚à£ ‚à£ z ‚à£‚Çï)
        
 --  ww .GSeq.Sh.ShElim.œÉB =
 --    zzzz ‚àò (T.elim
 --      {B = Œª z ‚Üí
 --              Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ n))
 --              (Œª (X , _) ‚Üí
 --                 X ‚Üí
 --                 ‚à£_‚à£‚Çï {n = (5 ‚Ñï.+ n)}
 --                   (snd (G'.Sh‚Çô‚àô (suc (suc (suc n)))))
 --                  ‚â° ‚à£ SS.Sh.œÉ z ‚à£‚Çï)}
 --      {!!} zzz)

 --   where
 --   zzz : (a : G'.Sh‚Çô (suc (suc n)) .fst) ‚Üí
 --          Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ n))
 --          (Œª (X , _) ‚Üí
 --             X ‚Üí
 --             Path (T.hLevelTrunc (5 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc (suc n))))))
 --             (‚à£ snd (G'.Sh‚Çô‚àô (suc (suc (suc n)))) ‚à£)
 --             (‚à£ SS.Sh.œÉ ‚à£ a ‚à£‚Çï ‚à£‚Çï))
 --   zzz a =
 --    let (zz , zz') = fst ppp ‚à£ a ‚à£
 --        zzF : (T.hLevelTrunc (4 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc n))))) ‚Üí
 --               (T.hLevelTrunc (5 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc (suc n))))))
 --        zzF = {!!}
 --    in zz , Œª aa ‚Üí
 --        let zsz : Path ((T.hLevelTrunc (4 ‚Ñï.+ n)
 --                    (fst (G'.Sh‚Çô‚àô (suc (suc n))))))
 --                  ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc n))) ‚à£
 --                  ‚à£ a ‚à£
 --            zsz = zz' aa
 --            szs : Path (((T.hLevelTrunc (6 ‚Ñï.+ n)
 --                    (fst (G'.Sh‚Çô‚àô (suc (suc n)))))))
 --                   {!!} {!!}
 --            szs = {!!}
 --        in cong (‚à£_‚à£‚Çï {n = 5 ‚Ñï.+ n})
 --             (cong SS.Sh.œÉ szs )
 --         --  {!!}
 --         -- ‚àô‚àô cong zzF (zz' aa)
 --         -- ‚àô‚àô {!!}
 --            -- lower‚â° 3 (suc n)
 --            --       (cong (T.map (fst (G'.œÉ‚àô (suc (suc n)))))
 --            --        (zz' aa))
                   
 --   zzzz : ‚àÄ {z} ‚Üí Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ n))
 --       (Œª (X , _) ‚Üí
 --          X ‚Üí
 --          Path (T.hLevelTrunc (5 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc (suc n))))))
 --          ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc (suc n)))) ‚à£‚Çï ‚à£ SS.Sh.œÉ z ‚à£‚Çï)
 --              ‚Üí Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ suc n))
 --       (Œª (X , _) ‚Üí
 --          X ‚Üí
 --          Path (T.hLevelTrunc (5 ‚Ñï.+ n)
 --                 (fst (G'.Sh‚Çô‚àô (suc (suc (suc n))))))
 --          ‚à£ snd (G'.Sh‚Çô‚àô (suc (suc (suc n)))) ‚à£‚Çï ‚à£ SS.Sh.œÉ z ‚à£‚Çï)
 --   zzzz (x , y) = 
 --     (map-snd (isOfHLevelSuc (3 ‚Ñï.+ n)) x) ,
 --        y
   
 --  ww .GSeq.Sh.ShElim.hubB = {!!}
 --  ww .GSeq.Sh.ShElim.spokeB = {!!}
 --  ww .GSeq.Sh.ShElim.spoke-hub-spokeB = {!!}
 --  ww .GSeq.Sh.ShElim.spoke-hub-sqB = {!!}

-- module _ {obj : ‚àÄ n ‚Üí Type}
-- ¬†             {_‚âã_ : {n = n : ‚Ñï} ‚Üí Rel (obj n) (obj n) ‚Ñì-zero}
--      (Se : GSeq obj _‚âã_) where
--  SH-CODE :
--       ‚àÄ n ‚Üí
--        Œ£ ((Œ± : fst (T.hLevelTrunc‚àô (4 ‚Ñï.+ n)
--             (GSeqSuc.G'.Sh‚Çô‚àô _ _ Se (suc (suc n))))) ‚Üí
--              Œ£ (TypeOfHLevel ‚Ñì-zero (3 ‚Ñï.+ n)) Œª (X , _) ‚Üí
--               X ‚Üí
--                ‚à£ snd (GSeqSuc.G'.Sh‚Çô‚àô _ _ Se (suc (suc n))) ‚à£
--                 ‚â° Œ±)
--          Œª X ‚Üí fst (fst (X
--              ‚à£ snd (GSeqSuc.G'.Sh‚Çô‚àô _ _ Se (suc (suc n))) ‚à£))
--  SH-CODE n = {!!}
--   where
--   Sh‚Çô-trunc =
--     Shape.trunc Se (4 ‚Ñï.+ (suc n)) (suc n) (Shape.Sh‚Çô Se (suc n))
--   module SS =
--     Shape.Sh-more  ? (suc n)
--       (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
--    (snd (fst (snd (Sh‚Çô-trunc))))
--    ((snd (snd (Sh‚Çô-trunc))))


is‚àûGrpShape : ‚àÄ N {obj : ‚àÄ n ‚Üí Type}
¬†             {_‚âã_ : {n = n : ‚Ñï} ‚Üí Rel (obj n) (obj n) ‚Ñì-zero}
     (Se : GSeq obj _‚âã_) ‚Üí Shape.Is‚àûGrp‚â§' {obj = obj} {_‚âã_ = _‚âã_} Se N
is‚àûGrpShape _ Se zero x = {!!} --Shape.Is‚àûGrp‚ÇÄ Se 
is‚àûGrpShape zero Se (suc n) x = ‚ä•.rec (‚Ñï.¬¨-<-zero x)
is‚àûGrpShape (suc N) Se (suc n) x =
  -- compGroupIso
  (compGroupIso
    (compGroupIso
      ((subst (GroupIso _)
       (Œ£PathP (refl ,
         cong (groupstr _ _ _) (isPropIsGroup _ _ _ _ _))) idGroupIso))
      (is‚àûGrpShape N
         (GSeqSuc.GSeqSuc _ _ Se)
         n (‚Ñï.pred‚Ñï-‚â§-pred‚Ñï x)))
    (compGroupIso (compGroupIso
      (compGroupIso (HG.œÄTruncGroupIso n)
        (GroupEquiv‚ÜíGroupIso
          (HG.œÄIso (ww‚âÉ‚àô n) n)))
       (HG.GrIso-œÄŒ©-œÄ n)
       )
      (invGroupIso (HG.œÄTruncGroupIso (suc n)))
      ))

 where

 -- ww‚ÜíR : Shape.Sh-more.ShRec _ _ _ _  _ _ _
 -- ww‚ÜíR .GSeq.Sh.ShRec.œÉB a = {!a!}
 -- ww‚ÜíR .GSeq.Sh.ShRec.hubB = {!Shape.Sh-more.ShRec!}
 -- ww‚ÜíR .GSeq.Sh.ShRec.spokeB = {!!}
 -- ww‚ÜíR .GSeq.Sh.ShRec.spoke-hub-spokeB = {!!}
 -- ww‚ÜíR .GSeq.Sh.ShRec.spoke-hub-sqB = {!!}
 
 -- ww‚Üí : Shape.Sh‚Çô‚àô (GSeqSuc.GSeqSuc _ _ Se) (suc n)
 --        P.‚Üí‚àô
 --        Lsp.Œ© (Shape.Sh‚Çô‚àô Se (suc (suc n)))
 -- ww‚Üí .fst = Shape.Sh-more.ShRec.go _ _ _ _ _ _ ww‚ÜíR
 -- ww‚Üí .snd = {!!}

 -- ww‚Üê : {!!}
 -- ww‚Üê = {!!}

 ww‚âÉ‚àô : ‚àÄ n ‚Üí T.hLevelTrunc‚àô (3 ‚Ñï.+ n)
         ((GSeqSuc.G'.Sh‚Çô‚àô _ _
           (GSeqSuc.GSeqSuc _ _ Se) (suc n)))
     P.‚âÉ‚àô
     Lsp.Œ© (T.hLevelTrunc‚àô (4 ‚Ñï.+ n)
      (GSeqSuc.G'.Sh‚Çô‚àô _ _ Se (suc (suc n)))) 
 ww‚âÉ‚àô zero = isoToEquiv zzz , {!!}

  where
  zzz‚ÜíR : GSeqSuc.G'.Sh-more.ShElim _ _ _ _ _ _ _ _ _ 
  zzz‚ÜíR .GSeq.Sh.ShElim.œÉB a = {!‚à£ ? ‚à£ !}
  zzz‚ÜíR .GSeq.Sh.ShElim.hubB = {!!}
  zzz‚ÜíR .GSeq.Sh.ShElim.spokeB = {!!}
  zzz‚ÜíR .GSeq.Sh.ShElim.spoke-hub-spokeB = {!!}
  zzz‚ÜíR .GSeq.Sh.ShElim.spoke-hub-sqB = {!!}

  zzz‚Üí : fst
          (hLevelTrunc‚àô (3 ‚Ñï.+ zero)
           (GSeqSuc.G'.Sh‚Çô‚àô _ (Œª {n = n‚ÇÅ} ‚Üí _)
            (GSeqSuc.GSeqSuc _ _ Se) 1)) ‚Üí
          fst (Lsp.Œ© (hLevelTrunc‚àô (4 ‚Ñï.+ zero) (GSeqSuc.G'.Sh‚Çô‚àô _ _ Se 2)))
  zzz‚Üí = T.rec {!!}
    (GSeqSuc.G'.Sh-more.ShElim.go _ _ _ _ _ _ _ _ zzz‚ÜíR)
   
  zzz : Iso _ _
  zzz .Iso.fun = zzz‚Üí
  zzz .Iso.inv = {!!}
  zzz .Iso.rightInv = {!!}
  zzz .Iso.leftInv = {!!}

 ww‚âÉ‚àô (suc n) = {!!}


 -- ww : GroupIso _ _
 -- ww = wwIso , {!!}


-- -- --  gSucMap : ‚àÄ n ‚Üí Sequence.obj SG'.ShSequence n ‚Üí Sequence.obj G'.ShSequence n
-- -- --  gSucMapComm : (n : ‚Ñï) (x : Sequence.obj SG'.ShSequence n) ‚Üí
-- -- --       Sequence.map  G'.ShSequence {n = n} (gSucMap n x) ‚â°
-- -- --       G.Sh.œÉ (T.map (gSucMap n) ‚à£ x ‚à£)

-- -- --  gSucMapHlp : ‚àÄ n m s ‚Üí G'.Sh‚Çô n .snd .fst .snd (fst (G.middle m)) s ‚â°
-- -- --       gSucMap n (SG'.Sh‚Çô n .snd .fst .snd m s)

-- -- --  gSucMap zero = inducedFun-EM‚ÇÅ (_ , G.middleGroupHom 0)
-- -- --  gSucMap (suc n) = SG.Sh.ShElim.go w
-- -- --    where
-- -- --    w : SG.Sh.ShElim n _ _ _ _ _
-- -- --    w .GSeq.Sh.ShElim.œÉB = G.Sh.œÉ ‚àò T.map (gSucMap n) 
-- -- --    w .GSeq.Sh.ShElim.hubB m r =
-- -- --      G.Sh.hub (fst (G.middle m)) {!!}
-- -- --    w .GSeq.Sh.ShElim.spokeB m r s =
-- -- --       G.Sh.spoke _ _ s  ‚àô
-- -- --         cong (G'.Sh-more.Sh.œÉ ‚àòS ‚à£_‚à£)
-- -- --          (gSucMapHlp n m s)
-- -- --    w .GSeq.Sh.ShElim.spoke-hub-spokeB = {!!}
-- -- --    w .GSeq.Sh.ShElim.spoke-hub-sqB = {!!}

-- -- --  gSucMapComm n x = refl

-- -- --  gSucMapHlp = {!!}
 
-- -- --  GSeqSucFuncSeqMap : SequenceMap SG'.ShSequence G'.ShSequence
-- -- --  GSeqSucFuncSeqMap .SequenceMap.map = gSucMap
 
-- -- --  GSeqSucFuncSeqMap .SequenceMap.comm = gSucMapComm
 
-- -- --  GSeqSucFunc : SG'.Shape ‚Üí G'.Shape 
-- -- --  GSeqSucFunc = realiseSequenceMap GSeqSucFuncSeqMap 



-- -- --  -- -- --  -- objGrpHom : ‚àÄ n ‚Üí GroupHom
-- -- -- -- -- --  --   (objGroup n)
-- -- -- -- -- --  --   (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))

-- -- -- --  œÉ‚àôœÄ¬∑ : ‚àÄ n x y ‚Üí Path ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü©
-- -- -- --            ‚à£ (HG.‚àôŒ† ((œÉ‚àô n) P.‚àò‚àô x)
-- -- -- --                    ((œÉ‚àô n) P.‚àò‚àô y)) ‚à£‚ÇÇ
-- -- -- --            (ST.map (P._‚àò‚àô_ (œÉ‚àô n))
-- -- -- --                ‚à£ HG.‚àôŒ† x y ‚à£‚ÇÇ)
-- -- -- --  œÉ‚àôœÄ¬∑ n x y = {!!}
-- -- -- --  -- cong ‚à£_‚à£‚ÇÇ (Œ£PathP (((funExt w) , {!!}))) 
-- -- -- --  --  where
-- -- -- --  --  w : (x‚ÇÅ : S‚Çä‚àô (suc (suc n)) .fst) ‚Üí
-- -- -- --  --       PathP (Œª _ ‚Üí Sh‚Çô‚àô (suc (suc n)) .fst)
-- -- -- --  --       (fst (HG.‚àôŒ† (œÉ‚àô (suc n) P.‚àò‚àô x) (œÉ‚àô (suc n) P.‚àò‚àô y)) x‚ÇÅ)
-- -- -- --  --       (fst (œÉ‚àô (suc n) P.‚àò‚àô HG.‚àôŒ† x y) x‚ÇÅ)
-- -- -- --  --  w north = refl
-- -- -- --  --  w south = refl
-- -- -- --  --  w (merid a i) = {!!}


-- -- -- --  œÉ‚àôŒ†- : ‚àÄ n x ‚Üí Path (S‚Çä‚àô (suc (n)) P.‚Üí‚àô Sh‚Çô‚àô (suc (n)))
-- -- -- --            (HG.-Œ† ((œÉ‚àô (n)) P.‚àò‚àô x)) 
-- -- -- --            ((œÉ‚àô (n)) P.‚àò‚àô (HG.-Œ† x))
-- -- -- --  œÉ‚àôŒ†- n x = {!!}
-- -- -- --  -- Œ£PathP ((funExt w) , refl) 
-- -- -- --  --  where
-- -- -- --  --  w : (x‚ÇÅ : S‚Çä‚àô (suc (suc n)) .fst) ‚Üí
-- -- -- --  --       fst (HG.-Œ† (œÉ‚àô (suc n) P.‚àò‚àô x)) x‚ÇÅ ‚â°
-- -- -- --  --       fst (œÉ‚àô (suc n) P.‚àò‚àô HG.-Œ† x) x‚ÇÅ
-- -- -- --  --  w north = refl
-- -- -- --  --  w south = refl
-- -- -- --  --  w (merid a i) = refl


-- -- -- --  œÉ‚àôœÄ- : ‚àÄ n x ‚Üí Path ‚ü® HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))) ‚ü©
-- -- -- --            ‚à£ (HG.-Œ† ((œÉ‚àô (n)) P.‚àò‚àô x)) ‚à£‚ÇÇ
-- -- -- --            (ST.map (P._‚àò‚àô_ (œÉ‚àô (n)))
-- -- -- --                ‚à£ HG.-Œ† x ‚à£‚ÇÇ)
-- -- -- --  œÉ‚àôœÄ- n x = cong ‚à£_‚à£‚ÇÇ (œÉ‚àôŒ†- n x)
 
-- -- -- -- -- (snd (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n)))) GroupStr.¬∑ ff a)
-- -- -- -- --       (snd (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n)))) .GroupStr.inv (ff a'))
-- -- -- -- --       ‚â°
-- -- -- -- --       ST.map (P._‚àò‚àô_ (œÉ‚àô (suc n)))
-- -- -- -- --       ‚à£
-- -- -- -- --       HG.‚àôŒ† (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) a)
-- -- -- -- --       (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) (obj-inv a'))
-- -- -- -- --       ‚à£‚ÇÇ

-- -- -- --  unit‚âã‚ÜíœÄ'Gr‚â° :  ‚àÄ n o ‚Üí
-- -- -- --     unit {n} ‚âã o
-- -- -- --      ‚Üí Path (fst (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n))))
-- -- -- --             (HG.1œÄ' (suc n))
-- -- -- --              (ST.map (œÉ‚àô n P.‚àò‚àô_) ‚à£ (Œ£Ty-ev‚àô n (Sh‚Çô n) o) ‚à£‚ÇÇ)
-- -- -- --  unit‚âã‚ÜíœÄ'Gr‚â° n o ‚âão =
-- -- -- --    cong ‚à£_‚à£‚ÇÇ (Œ£PathP
-- -- -- --      ((funExt (Œª s ‚Üí
-- -- -- --        sym (spoke-hub-spoke-pt o ‚âão s))) ,
-- -- -- --         (flipSquare (cong sym (spoke-hub-spoke-pt-refl o ‚âão) ‚óÅ
-- -- -- --          Œª j i ‚Üí œÉ‚àô n .fst (Œ£Ty-ev‚àô n (Sh‚Çô n) o .snd (~ i ‚à® j))) ‚ñ∑ rUnit _)))
-- -- -- --   where
-- -- -- --    Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
-- -- -- --    open Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
-- -- -- --     (snd (fst (snd (Sh‚Çô-trunc))))
-- -- -- --     (fst (snd (snd (Sh‚Çô-trunc))))

-- -- -- --  -- ‚àûGrpIso‚Üí : ‚àÄ n ‚Üí ‚ü® objGroup n ‚ü©
-- -- -- --  --            ‚Üí     ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü©
-- -- -- --  -- ‚àûGrpIso‚Üí n = SQ.Rec.go w
-- -- -- --  --  where
-- -- -- --  --  module GT' = GroupTheory (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))
-- -- -- --  --  w : Rec ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü©
-- -- -- --  --  w .Rec.isSetB = squash‚ÇÇ
-- -- -- --  --  w .Rec.f = Sh‚Çô‚ÜíœÄ' n
-- -- -- --  --  w .Rec.f‚àº a a' a‚âãa' =
-- -- -- --  --    let z : unit ‚âã (a ‚äô obj-inv a') 
-- -- -- --  --        z = {!!}

-- -- -- --  --    in GT'.invUniqueL {g = Sh‚Çô‚ÜíœÄ' n a}
-- -- -- --  --              {h = snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- --  --                  .GroupStr.inv (Sh‚Çô‚ÜíœÄ' n a')}
-- -- -- --  --               ((

-- -- -- --  --                (cong {x = (snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- --  --                          .GroupStr.inv (Sh‚Çô‚ÜíœÄ' n a'))}
-- -- -- --  --                       {y = ‚à£ œÉ‚àô (n) P.‚àò‚àô
-- -- -- --  --                             Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a') ‚à£‚ÇÇ}
-- -- -- --  --                       (snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- --  --                     GroupStr.¬∑ Sh‚Çô‚ÜíœÄ' n a)
-- -- -- --  --                      {!!}
-- -- -- --  --                     -- (œÉ‚àôœÄ- n (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a')
-- -- -- --  --                     --  ‚àô cong (ST.map (œÉ‚àô (n) P.‚àò‚àô_))
-- -- -- --  --                     --     (sym (Œ£Ty-inv (n) (Sh‚Çô (n)) a')))
-- -- -- --  --                     ‚àô {!!}
-- -- -- --  --                   --   œÉ‚àôœÄ¬∑ n
-- -- -- --  --                   -- (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a)
-- -- -- --  --                   -- (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a'))
-- -- -- --  --                   )
                   
-- -- -- --  --                 ‚àô
-- -- -- --  --                 cong {x =
-- -- -- --  --                   HG.‚àôŒ†
-- -- -- --  --                    (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a)
-- -- -- --  --                    (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a'))} 
-- -- -- --  --                   (ST.map (P._‚àò‚àô_ (œÉ‚àô (n))) ‚àò ‚à£_‚à£‚ÇÇ)
-- -- -- --  --                   (snd (snd (snd (Sh‚Çô (n))))
-- -- -- --  --                    a (obj-inv a')))
-- -- -- --  --                 ‚àô sym (unit‚âã‚ÜíœÄ'Gr‚â° (n) (a ‚äô obj-inv a') z)) ‚àô
-- -- -- --  --               GT'.invInv (Sh‚Çô‚ÜíœÄ' n a')

-- -- -- --    ‚àûGrpIso‚ÇÄ : GroupIso
-- -- -- --        (objGroup 0)
-- -- -- --       (HG.œÄ'Gr 0 (Sh‚Çô‚àô 1))
-- -- -- --    ‚àûGrpIso‚ÇÄ = {!!}  
-- -- -- -- --  ‚àûGrpIso : ‚àÄ n ‚Üí  
-- -- -- -- --     Œ£[ isom ‚àà (Iso
-- -- -- -- --        ‚ü® objGroup n ‚ü©
-- -- -- -- --        ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü© ) ]
-- -- -- -- --        Unit
-- -- -- -- --  ‚àûGrpIso zero = {!!}
-- -- -- -- --  ‚àûGrpIso (suc n) .fst =
-- -- -- -- --    compIso (middleIso/ n)
-- -- -- -- --     (compIso
-- -- -- -- --       zz
-- -- -- -- --       (ST.setTruncIso
-- -- -- -- --        (compIso  (invIso (Lsp.IsoŒ©√ó _))
-- -- -- -- --         (IsoŒ©FunSuspFun {A = S‚Çä‚àô (suc n)} {B = Sh‚Çô‚àô (suc (suc n))}))))
-- -- -- -- --    where

-- -- -- -- --    module N = Iso (‚àûGrpIso n .fst)

-- -- -- -- --    zz‚Üí : ‚àÄ _ ‚Üí _ ‚Üí  _
-- -- -- -- --    zz‚Üí x = SQ.Rec.go zzz
-- -- -- -- --     where
-- -- -- -- --     x' : ‚ü® HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) ‚ü©
-- -- -- -- --     x' = N.fun SQ.[ x ]
-- -- -- -- --     zzz : SQ.Rec _
-- -- -- -- --     zzz .Rec.isSetB = ST.squash‚ÇÇ
-- -- -- -- --     zzz .Rec.f (u‚âãx‚ÇÄ , u‚âãx‚ÇÅ) =
-- -- -- -- --       ST.rec squash‚ÇÇ (Œª x'' ‚Üí
-- -- -- -- --         ‚à£ (( œÉ‚àô (suc n) P.‚àò‚àô x'') ,
-- -- -- -- --           {!!}) ‚à£‚ÇÇ)
-- -- -- -- --         x'
-- -- -- -- --     zzz .Rec.f‚àº a a' r = {!!}
    
-- -- -- -- --    zz : Iso ‚à• Œ£ (obj n // ER‚âã.transitive) _ ‚à•‚ÇÇ
-- -- -- -- --             ‚à• Œ£ (S‚Çä‚àô (suc n) P.‚Üí‚àô Sh‚Çô‚àô (suc (suc n)))
-- -- -- -- --                 (Œª x ‚Üí ((_ , refl) ‚â° x) √ó ((_ , refl) ‚â° x)) ‚à•‚ÇÇ
-- -- -- -- --    zz .Iso.fun =
-- -- -- -- --      ST.rec squash‚ÇÇ (uncurry
-- -- -- -- --       (GQ.elimSet ER‚âã.transitive (Œª _ ‚Üí isSet‚Üí ST.squash‚ÇÇ)
-- -- -- -- --        zz‚Üí {!!})) 
-- -- -- -- --    zz .Iso.inv = {!!}
-- -- -- -- --    zz .Iso.rightInv = {!!}
-- -- -- -- --    zz .Iso.leftInv = {!!}
   
-- -- -- -- --  ‚àûGrpIso (suc n) .snd = {!!}
 
-- -- -- -- -- --  objGrpHom : ‚àÄ n ‚Üí GroupHom
-- -- -- -- -- --    (objGroup n)
-- -- -- -- -- --    (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))
-- -- -- -- -- --  objGrpHom n = SQ.Rec.go wq ,
-- -- -- -- -- --    {!!}
-- -- -- -- -- --   where
-- -- -- -- -- --    open GroupTheory (HG.œÄ'Gr n (Sh‚Çô‚àô n))
-- -- -- -- -- --    module GT' = GroupTheory (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))


-- -- -- -- -- --    ff' : obj n ‚Üí
-- -- -- -- -- --          HG.œÄ'Gr n (fst (Sh‚Çô n) , fst (fst (snd (Sh‚Çô n))))
-- -- -- -- -- --          .fst
-- -- -- -- -- --    ff' = ‚à£_‚à£‚ÇÇ ‚àòS Œ£Ty-ev‚àô n (Sh‚Çô n)

-- -- -- -- -- --    ff : obj n ‚Üí
-- -- -- -- -- --          HG.œÄ'Gr n (fst (Sh‚Çô (suc n)) , fst (fst (snd (Sh‚Çô (suc n)))))
-- -- -- -- -- --          .fst
-- -- -- -- -- --    ff = ST.map (œÉ‚àô n P.‚àò‚àô_) ‚àòS ff'

-- -- -- -- -- --    wq : Rec (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)) .fst)
-- -- -- -- -- --    wq .Rec.isSetB = squash‚ÇÇ
-- -- -- -- -- --    wq .Rec.f = ff
-- -- -- -- -- --    wq .Rec.f‚àº a a' a‚âãa' =
-- -- -- -- -- --     let z : unit ‚âã (a ‚äô obj-inv a') 
-- -- -- -- -- --         z = {!!}

-- -- -- -- -- --     in GT'.invUniqueL {g = ff a}
-- -- -- -- -- --               {h = snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- -- -- --                   .GroupStr.inv (ff a')}
-- -- -- -- -- --                ((

-- -- -- -- -- --                 (cong {x = (snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- -- -- --                           .GroupStr.inv (ff a'))}
-- -- -- -- -- --                        {y = ‚à£ œÉ‚àô (n) P.‚àò‚àô
-- -- -- -- -- --                              Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a') ‚à£‚ÇÇ}
-- -- -- -- -- --                        (snd (HG.œÄ'Gr (n) (Sh‚Çô‚àô (suc (n))))
-- -- -- -- -- --                      GroupStr.¬∑ ff a)
-- -- -- -- -- --                      (œÉ‚àôœÄ- n (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a')
-- -- -- -- -- --                       ‚àô cong (ST.map (œÉ‚àô (n) P.‚àò‚àô_))
-- -- -- -- -- --                          (sym (Œ£Ty-inv (n) (Sh‚Çô (n)) a')))
-- -- -- -- -- --                      ‚àô œÉ‚àôœÄ¬∑ n
-- -- -- -- -- --                    (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a)
-- -- -- -- -- --                    (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a')))
                   
-- -- -- -- -- --                  ‚àô
-- -- -- -- -- --                  cong {x =
-- -- -- -- -- --                    HG.‚àôŒ†
-- -- -- -- -- --                     (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) a)
-- -- -- -- -- --                     (Œ£Ty-ev‚àô (n) (Sh‚Çô (n)) (obj-inv a'))} 
-- -- -- -- -- --                    (ST.map (P._‚àò‚àô_ (œÉ‚àô (n))) ‚àò ‚à£_‚à£‚ÇÇ)
-- -- -- -- -- --                    (snd (snd (snd (Sh‚Çô (n))))
-- -- -- -- -- --                     a (obj-inv a')))
-- -- -- -- -- --                  ‚àô sym (unit‚âã‚ÜíœÄ'Gr‚â° (n) (a ‚äô obj-inv a') z)) ‚àô
-- -- -- -- -- --                GT'.invInv (ff a')


-- -- -- -- -- --  -- objGrpHom : ‚àÄ n ‚Üí GroupHom
-- -- -- -- -- --  --   (objGroup n)
-- -- -- -- -- --  --   (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))
-- -- -- -- -- --  -- objGrpHom zero = {!!}
-- -- -- -- -- --  -- objGrpHom (suc n) =
-- -- -- -- -- --  --   SQ.Rec.go w , makeIsGroupHom (SQ.ElimProp2.go ww)
-- -- -- -- -- --  --   where
-- -- -- -- -- --  --   open GroupTheory (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc n)))
-- -- -- -- -- --  --   module GT' = GroupTheory (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n))))

-- -- -- -- -- --  --   ff' : obj (suc n) ‚Üí
-- -- -- -- -- --  --         HG.œÄ'Gr (suc n) (fst (Sh‚Çô (suc n)) , fst (fst (snd (Sh‚Çô (suc n)))))
-- -- -- -- -- --  --         .fst
-- -- -- -- -- --  --   ff' = ‚à£_‚à£‚ÇÇ ‚àòS Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n))

-- -- -- -- -- --  --   ff : obj (suc n) ‚Üí
-- -- -- -- -- --  --         HG.œÄ'Gr (suc n) (fst (Sh‚Çô (suc (suc n))) , fst (fst (snd (Sh‚Çô (suc (suc n))))))
-- -- -- -- -- --  --         .fst
-- -- -- -- -- --  --   ff = ST.map (œÉ‚àô (suc n) P.‚àò‚àô_) ‚àòS ff'

-- -- -- -- -- --  --   w : Rec
-- -- -- -- -- --  --        (HG.œÄ'Gr (suc n)
-- -- -- -- -- --  --         (fst (Sh‚Çô (suc (suc n))) , fst (fst (snd (Sh‚Çô (suc (suc n)))))) .fst)
-- -- -- -- -- --  --   w .Rec.isSetB = squash‚ÇÇ 
-- -- -- -- -- --  --   w .Rec.f = ff
-- -- -- -- -- --  --   w .Rec.f‚àº a a' a‚âãa' =
-- -- -- -- -- --  --    let z : unit ‚âã (a ‚äô obj-inv a') 
-- -- -- -- -- --  --        z = {!!}

-- -- -- -- -- --  --    in GT'.invUniqueL {g = ff a}
-- -- -- -- -- --  --              {h = snd (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n))))
-- -- -- -- -- --  --                  .GroupStr.inv (ff a')}
-- -- -- -- -- --  --               ((

-- -- -- -- -- --  --                (cong {x = (snd (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n))))
-- -- -- -- -- --  --                          .GroupStr.inv (ff a'))}
-- -- -- -- -- --  --                       {y = ‚à£ œÉ‚àô (suc n) P.‚àò‚àô
-- -- -- -- -- --  --                             Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) (obj-inv a') ‚à£‚ÇÇ}
-- -- -- -- -- --  --                       (snd (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n))))
-- -- -- -- -- --  --                     GroupStr.¬∑ ff a)
-- -- -- -- -- --  --                     (œÉ‚àôœÄ- n (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) a')
-- -- -- -- -- --  --                      ‚àô cong (ST.map (œÉ‚àô (suc n) P.‚àò‚àô_))
-- -- -- -- -- --  --                         (sym (Œ£Ty-inv (suc n) (Sh‚Çô (suc n)) a')))
-- -- -- -- -- --  --                     ‚àô œÉ‚àôœÄ¬∑ n
-- -- -- -- -- --  --                   (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) a)
-- -- -- -- -- --  --                   (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) (obj-inv a')))
                   
-- -- -- -- -- --  --                 ‚àô
-- -- -- -- -- --  --                 cong {x =
-- -- -- -- -- --  --                   HG.‚àôŒ†
-- -- -- -- -- --  --                    (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) a)
-- -- -- -- -- --  --                    (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) (obj-inv a'))} 
-- -- -- -- -- --  --                   (ST.map (P._‚àò‚àô_ (œÉ‚àô (suc n))) ‚àò ‚à£_‚à£‚ÇÇ)
-- -- -- -- -- --  --                   (snd (snd (snd (Sh‚Çô (suc n))))
-- -- -- -- -- --  --                    a (obj-inv a')))
-- -- -- -- -- --  --                 ‚àô sym (unit‚âã‚ÜíœÄ'Gr‚â° (suc n) (a ‚äô obj-inv a') z)) ‚àô
-- -- -- -- -- --  --               GT'.invInv (ff a')

-- -- -- -- -- --  --   ww : ElimProp2
-- -- -- -- -- --  --         (Œª z z‚ÇÅ ‚Üí
-- -- -- -- -- --  --            Rec.go w ((objGroup (suc n) .snd GroupStr.¬∑ z) z‚ÇÅ) ‚â°
-- -- -- -- -- --  --            (HG.œÄ'Gr (suc n) (Sh‚Çô‚àô (suc (suc n))) .snd GroupStr.¬∑ Rec.go w z)
-- -- -- -- -- --  --            (Rec.go w z‚ÇÅ))
-- -- -- -- -- --  --   ww .ElimProp2.isPropB _ _ = squash‚ÇÇ _ _ 
-- -- -- -- -- --  --   ww .ElimProp2.f x y =
-- -- -- -- -- --  --     cong {x = ff' (x ‚äô y)}
-- -- -- -- -- --  --           {y = ‚à£ HG.‚àôŒ† (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) x)
-- -- -- -- -- --  --                     (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) y) ‚à£‚ÇÇ}
-- -- -- -- -- --  --                      (ST.map (P._‚àò‚àô_ (œÉ‚àô (suc n))))
-- -- -- -- -- --  --          (cong ‚à£_‚à£‚ÇÇ (sym (snd (snd (snd (Sh‚Çô (suc n))))
-- -- -- -- -- --  --           x y)))
-- -- -- -- -- --  --     ‚àô sym (œÉ‚àôœÄ¬∑ n
-- -- -- -- -- --  --       (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) x)
-- -- -- -- -- --  --       (Œ£Ty-ev‚àô (suc n) (Sh‚Çô (suc n)) y)) 


-- -- -- -- -- --  -- is‚àûGrp-zero : GroupIso (objGroup zero)
-- -- -- -- -- --  --      (HG.œÄ'Gr zero (EM‚ÇÅ (objGroup zero) , embase))
-- -- -- -- -- --  -- is‚àûGrp-zero = {!!} , {!!}

-- -- -- -- -- --  is‚àûGrp-inj : ‚àÄ n ‚Üí isInjective (objGrpHom n)
-- -- -- -- -- --  is‚àûGrp-inj zero = {!!}
-- -- -- -- -- --  is‚àûGrp-inj (suc n) = SQ.ElimProp.go w
-- -- -- -- -- --   where
-- -- -- -- -- --   w : ElimProp
-- -- -- -- -- --        (Œª z ‚Üí
-- -- -- -- -- --           isInKer (objGrpHom (suc n)) z ‚Üí
-- -- -- -- -- --           z ‚â° GroupStr.1g (objGroup (suc n) .snd))
-- -- -- -- -- --   w .ElimProp.isPropB _ = isPropŒ† Œª _ ‚Üí squash/ _ _
-- -- -- -- -- --   w .ElimProp.f x = PT.rec (squash/ _ _)
-- -- -- -- -- --    {!? ‚àò cong (Iso.fun (suspRecIso (Sh‚Çô‚àô (suc n))))!}
-- -- -- -- -- --    ‚àòS Iso.fun PathIdTrunc‚ÇÄIso
 
-- -- -- -- -- --  is‚àûGrp : ‚àÄ n ‚Üí BijectionIso (objGroup n)
-- -- -- -- -- --   (HG.œÄ'Gr n (Sh‚Çô‚àô (suc n)))
-- -- -- -- -- --  is‚àûGrp n .BijectionIso.fun = objGrpHom n
-- -- -- -- -- --  is‚àûGrp n .BijectionIso.inj = is‚àûGrp-inj n
-- -- -- -- -- --  is‚àûGrp zero .BijectionIso.surj = {!!}
-- -- -- -- -- --  is‚àûGrp (suc n) .BijectionIso.surj = 
-- -- -- -- -- --    ST.elim (Œª _ ‚Üí isProp‚ÜíisSet squash‚ÇÅ)
-- -- -- -- -- --     ((Iso.inv (domIsoDep
-- -- -- -- -- --      ( invIso (suspRecIso (S‚Çä‚àô (suc n)) {B = Sh‚Çô‚àô (suc (suc n))})))
-- -- -- -- -- --       (uncurry
-- -- -- -- -- --         (S.ShElimProp.go w))))
-- -- -- -- -- --   where
-- -- -- -- -- --   Sh‚Çô-trunc' = trunc (4 ‚Ñï.+ (suc n)) (suc n) (Sh‚Çô (suc n))
-- -- -- -- -- --   Sh‚Çô-trunc = trunc (4 ‚Ñï.+ n) n (Sh‚Çô n)
-- -- -- -- -- --   module S = Sh-more (suc n) (fst (Sh‚Çô-trunc')) (fst (fst (snd (Sh‚Çô-trunc'))))
-- -- -- -- -- --     (snd (fst (snd (Sh‚Çô-trunc'))))
-- -- -- -- -- --     (fst (snd (snd (Sh‚Çô-trunc'))))
-- -- -- -- -- --   module S-p = Sh-more n (fst (Sh‚Çô-trunc)) (fst (fst (snd (Sh‚Çô-trunc))))
-- -- -- -- -- --     (snd (fst (snd (Sh‚Çô-trunc))))
-- -- -- -- -- --     (fst (snd (snd (Sh‚Çô-trunc))))
-- -- -- -- -- --   w : S.ShElimProp
-- -- -- -- -- --        (Œª z ‚Üí
-- -- -- -- -- --           (y : fst (S‚Çä‚àô (suc n)) ‚Üí snd (Sh‚Çô‚àô (suc (suc n))) ‚â° z) ‚Üí
-- -- -- -- -- --           isInIm (is‚àûGrp (suc n) .BijectionIso.fun)
-- -- -- -- -- --           ‚à£ Iso.fun (invIso (suspRecIso (S‚Çä‚àô (suc n)))) (z , y) ‚à£‚ÇÇ)
-- -- -- -- -- --   w .GSeq.Sh.ShElimProp.œÉB = T.elim
-- -- -- -- -- --    (Œª _ ‚Üí isOfHLevelPlus' {n = (suc (suc (suc (suc n))))} 1
-- -- -- -- -- --           (isPropŒ† Œª _ ‚Üí squash‚ÇÅ) 
-- -- -- -- -- --          ) (S-p.ShElimProp.go ww)


-- -- -- -- -- --    where
-- -- -- -- -- --     ww : S-p.ShElimProp _
-- -- -- -- -- --     ww .GSeq.Sh.ShElimProp.œÉB = {!!}
-- -- -- -- -- --       -- T.elim {!!}
-- -- -- -- -- --       --   Œª a y ‚Üí
-- -- -- -- -- --       --     ‚à£ ([ unit ]/ , {!!}) ‚à£‚ÇÅ
-- -- -- -- -- --     ww .GSeq.Sh.ShElimProp.isPropB _ =
-- -- -- -- -- --       isPropŒ† Œª _ ‚Üí squash‚ÇÅ
    
  
-- -- -- -- -- --   w .GSeq.Sh.ShElimProp.isPropB = {!!}
  
-- -- -- -- -- --  -- zero = {!!}
-- -- -- -- -- --  -- is‚àûGrp (suc n) = compIso {!!}
-- -- -- -- -- --  --   (setTruncIso (Œ©SuspAdjointIso {A = _ , ptSn (suc n)}) )
-- -- -- -- -- --  --    , {!!}
