<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Tactics.Reflection.Utilities</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Cubical.Tactics.Reflection.Utilities.html" class="Module">Cubical.Tactics.Reflection.Utilities</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a> <a id="115" class="Keyword">hiding</a> <a id="122" class="Symbol">(</a><a id="123" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="127" class="Symbol">)</a>

<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="166" class="Keyword">hiding</a> <a id="173" class="Symbol">(</a><a id="174" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="178" class="Symbol">)</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="241" class="Keyword">using</a> <a id="247" class="Symbol">()</a> <a id="250" class="Keyword">renaming</a> <a id="259" class="Symbol">(</a><a id="260" href="Agda.Builtin.Nat.html#631" class="Primitive Operator">_==_</a> <a id="265" class="Symbol">to</a> <a id="268" class="Primitive Operator">_=ℕ_</a><a id="272" class="Symbol">)</a>

<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a>
<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Cubical.Data.Maybe.html" class="Module">Cubical.Data.Maybe</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Cubical.Data.FinData.html" class="Module">Cubical.Data.FinData</a> <a id="405" class="Keyword">using</a> <a id="411" class="Symbol">()</a> <a id="414" class="Keyword">renaming</a> <a id="423" class="Symbol">(</a><a id="424" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="429" class="Symbol">to</a> <a id="432" class="InductiveConstructor">fzero</a><a id="437" class="Symbol">;</a> <a id="439" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="443" class="Symbol">to</a> <a id="446" class="InductiveConstructor">fsuc</a><a id="450" class="Symbol">)</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a> <a id="512" class="Keyword">using</a> <a id="518" class="Symbol">(</a><a id="519" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="520" class="Symbol">)</a>

<a id="523" class="Keyword">open</a> <a id="528" class="Keyword">import</a> <a id="535" href="Cubical.Tactics.Reflection.html" class="Module">Cubical.Tactics.Reflection</a>
<a id="562" class="Keyword">open</a> <a id="567" class="Keyword">import</a> <a id="574" href="Cubical.Tactics.Reflection.Variables.html" class="Module">Cubical.Tactics.Reflection.Variables</a>


<a id="finiteNumberAsTerm"></a><a id="613" href="Cubical.Tactics.Reflection.Utilities.html#613" class="Function">finiteNumberAsTerm</a> <a id="632" class="Symbol">:</a> <a id="634" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="640" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="642" class="Symbol">→</a> <a id="644" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="649" href="Cubical.Tactics.Reflection.Utilities.html#613" class="Function">finiteNumberAsTerm</a> <a id="668" class="Symbol">(</a><a id="669" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="674" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">ℕ.zero</a><a id="680" class="Symbol">)</a> <a id="682" class="Symbol">=</a> <a id="684" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="688" class="Symbol">(</a><a id="689" class="Keyword">quote</a> <a id="695" href="Cubical.Tactics.Reflection.Utilities.html#432" class="InductiveConstructor">fzero</a><a id="700" class="Symbol">)</a> <a id="702" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="705" href="Cubical.Tactics.Reflection.Utilities.html#613" class="Function">finiteNumberAsTerm</a> <a id="724" class="Symbol">(</a><a id="725" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="730" class="Symbol">(</a><a id="731" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">ℕ.suc</a> <a id="737" href="Cubical.Tactics.Reflection.Utilities.html#737" class="Bound">n</a><a id="738" class="Symbol">))</a> <a id="741" class="Symbol">=</a> <a id="743" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="747" class="Symbol">(</a><a id="748" class="Keyword">quote</a> <a id="754" href="Cubical.Tactics.Reflection.Utilities.html#446" class="InductiveConstructor">fsuc</a><a id="758" class="Symbol">)</a> <a id="760" class="Symbol">(</a><a id="761" href="Cubical.Tactics.Reflection.Utilities.html#613" class="Function">finiteNumberAsTerm</a> <a id="780" class="Symbol">(</a><a id="781" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="786" href="Cubical.Tactics.Reflection.Utilities.html#737" class="Bound">n</a><a id="787" class="Symbol">)</a> <a id="789" href="Cubical.Reflection.Base.html#784" class="InductiveConstructor Operator">v∷</a> <a id="792" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="794" class="Symbol">)</a>
<a id="796" href="Cubical.Tactics.Reflection.Utilities.html#613" class="CatchallClause Function">finiteNumberAsTerm</a><a id="814" class="CatchallClause"> </a><a id="815" class="CatchallClause Symbol">_</a> <a id="817" class="Symbol">=</a> <a id="819" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>

<a id="828" class="Comment">-- error message helper</a>
<a id="errorOut"></a><a id="852" href="Cubical.Tactics.Reflection.Utilities.html#852" class="Function">errorOut</a> <a id="861" class="Symbol">:</a> <a id="863" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="868" class="Symbol">(</a><a id="869" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="873" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="877" class="Symbol">)</a> <a id="879" class="Symbol">→</a> <a id="881" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="884" class="Symbol">(</a><a id="885" href="Cubical.Tactics.Reflection.Variables.html#1129" class="Function">Template</a> <a id="894" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="896" href="Cubical.Tactics.Reflection.Variables.html#1088" class="Function">Vars</a><a id="900" class="Symbol">)</a>
<a id="902" href="Cubical.Tactics.Reflection.Utilities.html#852" class="Function">errorOut</a> <a id="911" href="Cubical.Tactics.Reflection.Utilities.html#911" class="Bound">something</a> <a id="921" class="Symbol">=</a> <a id="923" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="933" class="Symbol">(</a><a id="934" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="941" class="String">&quot;Don&#39;t know what to do with &quot;</a> <a id="971" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="973" href="Cubical.Data.List.Base.html#600" class="Function">map</a> <a id="977" class="Symbol">(λ</a> <a id="980" class="Symbol">{(</a><a id="982" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="986" class="Symbol">_</a> <a id="988" href="Cubical.Tactics.Reflection.Utilities.html#988" class="Bound">t</a><a id="989" class="Symbol">)</a> <a id="991" class="Symbol">→</a> <a id="993" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="1001" href="Cubical.Tactics.Reflection.Utilities.html#988" class="Bound">t</a><a id="1002" class="Symbol">})</a> <a id="1005" href="Cubical.Tactics.Reflection.Utilities.html#911" class="Bound">something</a><a id="1014" class="Symbol">)</a>

<a id="errorOut&#39;"></a><a id="1017" href="Cubical.Tactics.Reflection.Utilities.html#1017" class="Function">errorOut&#39;</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1039" class="Symbol">(</a><a id="1040" href="Cubical.Tactics.Reflection.Variables.html#1129" class="Function">Template</a> <a id="1049" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="1051" href="Cubical.Tactics.Reflection.Variables.html#1088" class="Function">Vars</a><a id="1055" class="Symbol">)</a>
<a id="1057" href="Cubical.Tactics.Reflection.Utilities.html#1017" class="Function">errorOut&#39;</a> <a id="1067" href="Cubical.Tactics.Reflection.Utilities.html#1067" class="Bound">something</a> <a id="1077" class="Symbol">=</a> <a id="1079" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="1097" class="String">&quot;Don&#39;t know what to do with &quot;</a> <a id="1127" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1129" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="1137" href="Cubical.Tactics.Reflection.Utilities.html#1067" class="Bound">something</a> <a id="1147" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1149" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1151" class="Symbol">)</a>


<a id="_==_"></a><a id="1155" href="Cubical.Tactics.Reflection.Utilities.html#1155" class="Function Operator">_==_</a> <a id="1160" class="Symbol">=</a> <a id="1162" href="Agda.Builtin.Reflection.html#539" class="Primitive">primQNameEquality</a>
<a id="1180" class="Symbol">{-#</a> <a id="1184" class="Keyword">INLINE</a> <a id="1191" href="Cubical.Tactics.Reflection.Utilities.html#1155" class="Function Operator">_==_</a> <a id="1196" class="Symbol">#-}</a>
</pre></body></html>