<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Tactics.Reflection.Utilities</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Cubical.Tactics.Reflection.Utilities.html" class="Module">Cubical.Tactics.Reflection.Utilities</a> <a id="45" class="Keyword">where</a>

<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a> <a id="92" class="Keyword">hiding</a> <a id="99" class="Symbol">(</a><a id="100" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="104" class="Symbol">)</a>

<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="143" class="Keyword">hiding</a> <a id="150" class="Symbol">(</a><a id="151" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="155" class="Symbol">)</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="218" class="Keyword">using</a> <a id="224" class="Symbol">()</a> <a id="227" class="Keyword">renaming</a> <a id="236" class="Symbol">(</a><a id="237" href="Agda.Builtin.Nat.html#631" class="Primitive Operator">_==_</a> <a id="242" class="Symbol">to</a> <a id="245" class="Primitive Operator">_=ℕ_</a><a id="249" class="Symbol">)</a>

<a id="252" class="Keyword">open</a> <a id="257" class="Keyword">import</a> <a id="264" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Cubical.Data.Maybe.html" class="Module">Cubical.Data.Maybe</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Cubical.Data.FinData.html" class="Module">Cubical.Data.FinData</a> <a id="382" class="Keyword">using</a> <a id="388" class="Symbol">()</a> <a id="391" class="Keyword">renaming</a> <a id="400" class="Symbol">(</a><a id="401" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="406" class="Symbol">to</a> <a id="409" class="InductiveConstructor">fzero</a><a id="414" class="Symbol">;</a> <a id="416" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="420" class="Symbol">to</a> <a id="423" class="InductiveConstructor">fsuc</a><a id="427" class="Symbol">)</a>
<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="460" class="Keyword">open</a> <a id="465" class="Keyword">import</a> <a id="472" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a> <a id="489" class="Keyword">using</a> <a id="495" class="Symbol">(</a><a id="496" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="497" class="Symbol">)</a>

<a id="500" class="Keyword">open</a> <a id="505" class="Keyword">import</a> <a id="512" href="Cubical.Tactics.Reflection.html" class="Module">Cubical.Tactics.Reflection</a>
<a id="539" class="Keyword">open</a> <a id="544" class="Keyword">import</a> <a id="551" href="Cubical.Tactics.Reflection.Variables.html" class="Module">Cubical.Tactics.Reflection.Variables</a>


<a id="finiteNumberAsTerm"></a><a id="590" href="Cubical.Tactics.Reflection.Utilities.html#590" class="Function">finiteNumberAsTerm</a> <a id="609" class="Symbol">:</a> <a id="611" href="Cubical.Data.Maybe.Base.html#157" class="Datatype">Maybe</a> <a id="617" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="619" class="Symbol">→</a> <a id="621" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="626" href="Cubical.Tactics.Reflection.Utilities.html#590" class="Function">finiteNumberAsTerm</a> <a id="645" class="Symbol">(</a><a id="646" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="651" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">ℕ.zero</a><a id="657" class="Symbol">)</a> <a id="659" class="Symbol">=</a> <a id="661" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="665" class="Symbol">(</a><a id="666" class="Keyword">quote</a> <a id="672" href="Cubical.Tactics.Reflection.Utilities.html#409" class="InductiveConstructor">fzero</a><a id="677" class="Symbol">)</a> <a id="679" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="682" href="Cubical.Tactics.Reflection.Utilities.html#590" class="Function">finiteNumberAsTerm</a> <a id="701" class="Symbol">(</a><a id="702" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="707" class="Symbol">(</a><a id="708" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">ℕ.suc</a> <a id="714" href="Cubical.Tactics.Reflection.Utilities.html#714" class="Bound">n</a><a id="715" class="Symbol">))</a> <a id="718" class="Symbol">=</a> <a id="720" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="724" class="Symbol">(</a><a id="725" class="Keyword">quote</a> <a id="731" href="Cubical.Tactics.Reflection.Utilities.html#423" class="InductiveConstructor">fsuc</a><a id="735" class="Symbol">)</a> <a id="737" class="Symbol">(</a><a id="738" href="Cubical.Tactics.Reflection.Utilities.html#590" class="Function">finiteNumberAsTerm</a> <a id="757" class="Symbol">(</a><a id="758" href="Cubical.Data.Maybe.Base.html#213" class="InductiveConstructor">just</a> <a id="763" href="Cubical.Tactics.Reflection.Utilities.html#714" class="Bound">n</a><a id="764" class="Symbol">)</a> <a id="766" href="Cubical.Reflection.Base.html#777" class="InductiveConstructor Operator">v∷</a> <a id="769" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="771" class="Symbol">)</a>
<a id="773" href="Cubical.Tactics.Reflection.Utilities.html#590" class="CatchallClause Function">finiteNumberAsTerm</a><a id="791" class="CatchallClause"> </a><a id="792" class="CatchallClause Symbol">_</a> <a id="794" class="Symbol">=</a> <a id="796" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>

<a id="805" class="Comment">-- error message helper</a>
<a id="errorOut"></a><a id="829" href="Cubical.Tactics.Reflection.Utilities.html#829" class="Function">errorOut</a> <a id="838" class="Symbol">:</a> <a id="840" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="845" class="Symbol">(</a><a id="846" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="850" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="854" class="Symbol">)</a> <a id="856" class="Symbol">→</a> <a id="858" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="861" class="Symbol">(</a><a id="862" href="Cubical.Tactics.Reflection.Variables.html#1106" class="Function">Template</a> <a id="871" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="873" href="Cubical.Tactics.Reflection.Variables.html#1065" class="Function">Vars</a><a id="877" class="Symbol">)</a>
<a id="879" href="Cubical.Tactics.Reflection.Utilities.html#829" class="Function">errorOut</a> <a id="888" href="Cubical.Tactics.Reflection.Utilities.html#888" class="Bound">something</a> <a id="898" class="Symbol">=</a> <a id="900" href="Agda.Builtin.Reflection.html#8830" class="Postulate">typeError</a> <a id="910" class="Symbol">(</a><a id="911" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="918" class="String">&quot;Don&#39;t know what to do with &quot;</a> <a id="948" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="950" href="Cubical.Data.List.Base.html#617" class="Function">map</a> <a id="954" class="Symbol">(λ</a> <a id="957" class="Symbol">{(</a><a id="959" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="963" class="Symbol">_</a> <a id="965" href="Cubical.Tactics.Reflection.Utilities.html#965" class="Bound">t</a><a id="966" class="Symbol">)</a> <a id="968" class="Symbol">→</a> <a id="970" href="Agda.Builtin.Reflection.html#8269" class="InductiveConstructor">termErr</a> <a id="978" href="Cubical.Tactics.Reflection.Utilities.html#965" class="Bound">t</a><a id="979" class="Symbol">})</a> <a id="982" href="Cubical.Tactics.Reflection.Utilities.html#888" class="Bound">something</a><a id="991" class="Symbol">)</a>

<a id="errorOut&#39;"></a><a id="994" href="Cubical.Tactics.Reflection.Utilities.html#994" class="Function">errorOut&#39;</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Cubical.Tactics.Reflection.Variables.html#1106" class="Function">Template</a> <a id="1026" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="1028" href="Cubical.Tactics.Reflection.Variables.html#1065" class="Function">Vars</a><a id="1032" class="Symbol">)</a>
<a id="1034" href="Cubical.Tactics.Reflection.Utilities.html#994" class="Function">errorOut&#39;</a> <a id="1044" href="Cubical.Tactics.Reflection.Utilities.html#1044" class="Bound">something</a> <a id="1054" class="Symbol">=</a> <a id="1056" href="Agda.Builtin.Reflection.html#8830" class="Postulate">typeError</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="1074" class="String">&quot;Don&#39;t know what to do with &quot;</a> <a id="1104" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1106" href="Agda.Builtin.Reflection.html#8269" class="InductiveConstructor">termErr</a> <a id="1114" href="Cubical.Tactics.Reflection.Utilities.html#1044" class="Bound">something</a> <a id="1124" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1126" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1128" class="Symbol">)</a>


<a id="_==_"></a><a id="1132" href="Cubical.Tactics.Reflection.Utilities.html#1132" class="Function Operator">_==_</a> <a id="1137" class="Symbol">=</a> <a id="1139" href="Agda.Builtin.Reflection.html#539" class="Primitive">primQNameEquality</a>
<a id="1157" class="Symbol">{-#</a> <a id="1161" class="Keyword">INLINE</a> <a id="1168" href="Cubical.Tactics.Reflection.Utilities.html#1132" class="Function Operator">_==_</a> <a id="1173" class="Symbol">#-}</a>
</pre></body></html>