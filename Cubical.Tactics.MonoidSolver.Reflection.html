<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Tactics.MonoidSolver.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">module</a> <a id="32" href="Cubical.Tactics.MonoidSolver.Reflection.html" class="Module">Cubical.Tactics.MonoidSolver.Reflection</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a> <a id="119" class="Keyword">hiding</a> <a id="126" class="Symbol">(</a><a id="127" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="131" class="Symbol">)</a>

<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="170" class="Keyword">hiding</a> <a id="177" class="Symbol">(</a><a id="178" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="182" class="Symbol">)</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>

<a id="254" class="Keyword">open</a> <a id="259" class="Keyword">import</a> <a id="266" href="Cubical.Data.Maybe.html" class="Module">Cubical.Data.Maybe</a>
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
<a id="375" class="Keyword">open</a> <a id="380" class="Keyword">import</a> <a id="387" href="Cubical.Data.FinData.html" class="Module">Cubical.Data.FinData</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">()</a> <a id="417" class="Keyword">renaming</a> <a id="426" class="Symbol">(</a><a id="427" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="432" class="Symbol">to</a> <a id="435" class="InductiveConstructor">fzero</a><a id="440" class="Symbol">;</a> <a id="442" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="446" class="Symbol">to</a> <a id="449" class="InductiveConstructor">fsuc</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Cubical.Data.Bool.html" class="Module">Cubical.Data.Bool</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Cubical.Data.Vec.html" class="Module">Cubical.Data.Vec</a> <a id="514" class="Keyword">using</a> <a id="520" class="Symbol">(</a><a id="521" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a><a id="524" class="Symbol">)</a> <a id="526" class="Keyword">renaming</a> <a id="535" class="Symbol">(</a><a id="536" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="539" class="Symbol">to</a> <a id="542" class="InductiveConstructor">emptyVec</a><a id="550" class="Symbol">;</a> <a id="552" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">_∷_</a> <a id="556" class="Symbol">to</a> <a id="559" class="InductiveConstructor Operator">_∷vec_</a><a id="565" class="Symbol">)</a> <a id="567" class="Keyword">public</a>

<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="Cubical.Algebra.Monoid.Base.html" class="Module">Cubical.Algebra.Monoid.Base</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Cubical.Algebra.CommMonoid.Base.html" class="Module">Cubical.Algebra.CommMonoid.Base</a>
<a id="659" class="Keyword">open</a> <a id="664" class="Keyword">import</a> <a id="671" href="Cubical.Tactics.MonoidSolver.Solver.html" class="Module">Cubical.Tactics.MonoidSolver.Solver</a> <a id="707" class="Keyword">renaming</a> <a id="716" class="Symbol">(</a><a id="717" href="Cubical.Tactics.MonoidSolver.Solver.html#2521" class="Function">solve</a> <a id="723" class="Symbol">to</a> <a id="726" class="Function">naiveSolve</a><a id="736" class="Symbol">)</a>
<a id="738" class="Keyword">open</a> <a id="743" class="Keyword">import</a> <a id="750" href="Cubical.Tactics.MonoidSolver.CommSolver.html" class="Module">Cubical.Tactics.MonoidSolver.CommSolver</a> <a id="790" class="Keyword">renaming</a> <a id="799" class="Symbol">(</a><a id="800" href="Cubical.Tactics.MonoidSolver.CommSolver.html#3730" class="Function">solve</a> <a id="806" class="Symbol">to</a> <a id="809" class="Function">naiveCommSolve</a><a id="823" class="Symbol">)</a>
<a id="825" class="Keyword">open</a> <a id="830" class="Keyword">import</a> <a id="837" href="Cubical.Tactics.MonoidSolver.MonoidExpression.html" class="Module">Cubical.Tactics.MonoidSolver.MonoidExpression</a>

<a id="884" class="Keyword">private</a>
  <a id="894" class="Keyword">variable</a>
    <a id="907" href="Cubical.Tactics.MonoidSolver.Reflection.html#907" class="Generalizable">ℓ</a> <a id="909" class="Symbol">:</a> <a id="911" href="Agda.Primitive.html#742" class="Postulate">Level</a>

<a id="918" class="Keyword">module</a> <a id="ReflectionSolver"></a><a id="925" href="Cubical.Tactics.MonoidSolver.Reflection.html#925" class="Module">ReflectionSolver</a> <a id="942" class="Symbol">(</a><a id="943" href="Cubical.Tactics.MonoidSolver.Reflection.html#943" class="Bound">op</a> <a id="946" href="Cubical.Tactics.MonoidSolver.Reflection.html#946" class="Bound">unit</a> <a id="951" href="Cubical.Tactics.MonoidSolver.Reflection.html#951" class="Bound">solver</a> <a id="958" class="Symbol">:</a> <a id="960" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="964" class="Symbol">)</a> <a id="966" class="Keyword">where</a>

  <a id="ReflectionSolver._==_"></a><a id="975" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">_==_</a> <a id="980" class="Symbol">=</a> <a id="982" href="Agda.Builtin.Reflection.html#539" class="Primitive">primQNameEquality</a>
  <a id="1002" class="Symbol">{-#</a> <a id="1006" class="Keyword">INLINE</a> <a id="1013" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">_==_</a> <a id="1018" class="Symbol">#-}</a>

  <a id="1025" class="Keyword">record</a> <a id="ReflectionSolver.VarInfo"></a><a id="1032" href="Cubical.Tactics.MonoidSolver.Reflection.html#1032" class="Record">VarInfo</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1047" href="Agda.Primitive.html#915" class="Primitive">ℓ-zero</a> <a id="1054" class="Keyword">where</a>
    <a id="1064" class="Keyword">field</a>
      <a id="ReflectionSolver.VarInfo.varName"></a><a id="1076" href="Cubical.Tactics.MonoidSolver.Reflection.html#1076" class="Field">varName</a> <a id="1084" class="Symbol">:</a> <a id="1086" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
      <a id="ReflectionSolver.VarInfo.varType"></a><a id="1099" href="Cubical.Tactics.MonoidSolver.Reflection.html#1099" class="Field">varType</a> <a id="1107" class="Symbol">:</a> <a id="1109" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1113" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="ReflectionSolver.VarInfo.index"></a><a id="1124" href="Cubical.Tactics.MonoidSolver.Reflection.html#1124" class="Field">index</a> <a id="1130" class="Symbol">:</a> <a id="1132" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

  <a id="1137" class="Comment">{-
    `getLastTwoArgsOf` maps a term &#39;def n (z₁ ∷ … ∷ zₙ ∷ x ∷ y ∷ [])&#39; to the pair &#39;(x,y)&#39;
    non-visible arguments are ignored.
  -}</a>
  <a id="ReflectionSolver.getLastTwoArgsOf"></a><a id="1276" href="Cubical.Tactics.MonoidSolver.Reflection.html#1276" class="Function">getLastTwoArgsOf</a> <a id="1293" class="Symbol">:</a> <a id="1295" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1300" class="Symbol">→</a> <a id="1302" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="1315" class="Symbol">(</a><a id="1316" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1321" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="1323" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1327" class="Symbol">)</a>
  <a id="1331" href="Cubical.Tactics.MonoidSolver.Reflection.html#1276" class="Function">getLastTwoArgsOf</a> <a id="1348" href="Cubical.Tactics.MonoidSolver.Reflection.html#1348" class="Bound">n&#39;</a> <a id="1351" class="Symbol">(</a><a id="1352" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1356" href="Cubical.Tactics.MonoidSolver.Reflection.html#1356" class="Bound">n</a> <a id="1358" href="Cubical.Tactics.MonoidSolver.Reflection.html#1358" class="Bound">xs</a><a id="1360" class="Symbol">)</a> <a id="1362" class="Symbol">=</a>
    <a id="1368" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">if</a> <a id="1371" href="Cubical.Tactics.MonoidSolver.Reflection.html#1356" class="Bound">n</a> <a id="1373" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">==</a> <a id="1376" href="Cubical.Tactics.MonoidSolver.Reflection.html#1348" class="Bound">n&#39;</a>
    <a id="1383" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">then</a> <a id="1388" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="Function">go</a> <a id="1391" href="Cubical.Tactics.MonoidSolver.Reflection.html#1358" class="Bound">xs</a>
    <a id="1398" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">else</a> <a id="1403" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
      <a id="1417" class="Keyword">where</a>
      <a id="1429" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="Function">go</a> <a id="1432" class="Symbol">:</a> <a id="1434" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1439" class="Symbol">(</a><a id="1440" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1444" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1448" class="Symbol">)</a> <a id="1450" class="Symbol">→</a> <a id="1452" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1464" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="1466" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1470" class="Symbol">)</a>
      <a id="1478" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="Function">go</a> <a id="1481" class="Symbol">(</a><a id="1482" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1487" href="Cubical.Tactics.MonoidSolver.Reflection.html#1487" class="Bound">x</a> <a id="1489" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1491" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1496" href="Cubical.Tactics.MonoidSolver.Reflection.html#1496" class="Bound">y</a> <a id="1498" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1500" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1502" class="Symbol">)</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="1511" class="Symbol">(</a><a id="1512" href="Cubical.Tactics.MonoidSolver.Reflection.html#1487" class="Bound">x</a> <a id="1514" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1516" href="Cubical.Tactics.MonoidSolver.Reflection.html#1496" class="Bound">y</a><a id="1517" class="Symbol">)</a>
      <a id="1525" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="CatchallClause Function">go</a><a id="1527" class="CatchallClause"> </a><a id="1528" class="CatchallClause Symbol">(</a><a id="1529" href="Cubical.Tactics.MonoidSolver.Reflection.html#1529" class="CatchallClause Bound">x</a><a id="1530" class="CatchallClause"> </a><a id="1531" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1532" class="CatchallClause"> </a><a id="1533" href="Cubical.Tactics.MonoidSolver.Reflection.html#1533" class="CatchallClause Bound">xs</a><a id="1535" class="CatchallClause Symbol">)</a>               <a id="1551" class="Symbol">=</a> <a id="1553" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="Function">go</a> <a id="1556" href="Cubical.Tactics.MonoidSolver.Reflection.html#1533" class="Bound">xs</a>
      <a id="1565" href="Cubical.Tactics.MonoidSolver.Reflection.html#1429" class="CatchallClause Function">go</a><a id="1567" class="CatchallClause"> </a><a id="1568" class="CatchallClause Symbol">_</a>                      <a id="1591" class="Symbol">=</a> <a id="1593" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
  <a id="1603" href="Cubical.Tactics.MonoidSolver.Reflection.html#1276" class="CatchallClause Function">getLastTwoArgsOf</a><a id="1619" class="CatchallClause"> </a><a id="1620" href="Cubical.Tactics.MonoidSolver.Reflection.html#1620" class="CatchallClause Bound">n&#39;</a><a id="1622" class="CatchallClause"> </a><a id="1623" class="CatchallClause Symbol">_</a> <a id="1625" class="Symbol">=</a> <a id="1627" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>

  <a id="1638" class="Comment">{-
    `getArgs` maps a term &#39;x ≡ y&#39; to the pair &#39;(x,y)&#39;
  -}</a>
  <a id="ReflectionSolver.getArgs"></a><a id="1702" href="Cubical.Tactics.MonoidSolver.Reflection.html#1702" class="Function">getArgs</a> <a id="1710" class="Symbol">:</a> <a id="1712" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1717" class="Symbol">→</a> <a id="1719" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="1725" class="Symbol">(</a><a id="1726" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1731" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="1733" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1737" class="Symbol">)</a>
  <a id="1741" href="Cubical.Tactics.MonoidSolver.Reflection.html#1702" class="Function">getArgs</a> <a id="1749" class="Symbol">=</a> <a id="1751" href="Cubical.Tactics.MonoidSolver.Reflection.html#1276" class="Function">getLastTwoArgsOf</a> <a id="1768" class="Symbol">(</a><a id="1769" class="Keyword">quote</a> <a id="1775" href="Agda.Primitive.Cubical.html#2013" class="Postulate">PathP</a><a id="1780" class="Symbol">)</a>

  <a id="1785" class="Keyword">private</a>
    <a id="ReflectionSolver.solverCallAsTerm"></a><a id="1797" href="Cubical.Tactics.MonoidSolver.Reflection.html#1797" class="Function">solverCallAsTerm</a> <a id="1814" class="Symbol">:</a> <a id="1816" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1821" class="Symbol">→</a> <a id="1823" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1827" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1832" class="Symbol">→</a> <a id="1834" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1839" class="Symbol">→</a> <a id="1841" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1846" class="Symbol">→</a> <a id="1848" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="1857" href="Cubical.Tactics.MonoidSolver.Reflection.html#1797" class="Function">solverCallAsTerm</a> <a id="1874" href="Cubical.Tactics.MonoidSolver.Reflection.html#1874" class="Bound">M</a> <a id="1876" href="Cubical.Tactics.MonoidSolver.Reflection.html#1876" class="Bound">varList</a> <a id="1884" href="Cubical.Tactics.MonoidSolver.Reflection.html#1884" class="Bound">lhs</a> <a id="1888" href="Cubical.Tactics.MonoidSolver.Reflection.html#1888" class="Bound">rhs</a> <a id="1892" class="Symbol">=</a>
      <a id="1900" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a>
         <a id="1913" href="Cubical.Tactics.MonoidSolver.Reflection.html#951" class="Bound">solver</a>
         <a id="1929" class="Symbol">(</a><a id="1930" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1935" href="Cubical.Tactics.MonoidSolver.Reflection.html#1874" class="Bound">M</a> <a id="1937" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1939" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1944" href="Cubical.Tactics.MonoidSolver.Reflection.html#1884" class="Bound">lhs</a> <a id="1948" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1950" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1955" href="Cubical.Tactics.MonoidSolver.Reflection.html#1888" class="Bound">rhs</a>
           <a id="1970" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1972" href="Cubical.Tactics.MonoidSolver.Reflection.html#1876" class="Bound">varList</a>
           <a id="1991" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1993" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="1998" class="Symbol">(</a><a id="1999" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="2003" class="Symbol">(</a><a id="2004" class="Keyword">quote</a> <a id="2010" href="Cubical.Foundations.Prelude.html#915" class="Function">refl</a><a id="2014" class="Symbol">)</a> <a id="2016" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2018" class="Symbol">)</a> <a id="2020" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2022" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2024" class="Symbol">)</a>

  <a id="ReflectionSolver.solverCallWithLambdas"></a><a id="2029" href="Cubical.Tactics.MonoidSolver.Reflection.html#2029" class="Function">solverCallWithLambdas</a> <a id="2051" class="Symbol">:</a> <a id="2053" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2055" class="Symbol">→</a> <a id="2057" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2062" href="Cubical.Tactics.MonoidSolver.Reflection.html#1032" class="Record">VarInfo</a> <a id="2070" class="Symbol">→</a> <a id="2072" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2077" class="Symbol">→</a> <a id="2079" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2084" class="Symbol">→</a> <a id="2086" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2091" class="Symbol">→</a> <a id="2093" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2100" href="Cubical.Tactics.MonoidSolver.Reflection.html#2029" class="Function">solverCallWithLambdas</a> <a id="2122" href="Cubical.Tactics.MonoidSolver.Reflection.html#2122" class="Bound">n</a> <a id="2124" href="Cubical.Tactics.MonoidSolver.Reflection.html#2124" class="Bound">varInfos</a> <a id="2133" href="Cubical.Tactics.MonoidSolver.Reflection.html#2133" class="Bound">M</a> <a id="2135" href="Cubical.Tactics.MonoidSolver.Reflection.html#2135" class="Bound">lhs</a> <a id="2139" href="Cubical.Tactics.MonoidSolver.Reflection.html#2139" class="Bound">rhs</a> <a id="2143" class="Symbol">=</a>
    <a id="2149" href="Cubical.Tactics.MonoidSolver.Reflection.html#2293" class="Function">encloseWithIteratedLambda</a>
      <a id="2181" class="Symbol">(</a><a id="2182" href="Cubical.Data.List.Base.html#600" class="Function">map</a> <a id="2186" href="Cubical.Tactics.MonoidSolver.Reflection.html#1076" class="Field">VarInfo.varName</a> <a id="2202" href="Cubical.Tactics.MonoidSolver.Reflection.html#2124" class="Bound">varInfos</a><a id="2210" class="Symbol">)</a>
      <a id="2218" class="Symbol">(</a><a id="2219" href="Cubical.Tactics.MonoidSolver.Reflection.html#1797" class="Function">solverCallAsTerm</a> <a id="2236" href="Cubical.Tactics.MonoidSolver.Reflection.html#2133" class="Bound">M</a> <a id="2238" class="Symbol">(</a><a id="2239" href="Cubical.Tactics.MonoidSolver.Reflection.html#2505" class="Function">variableList</a> <a id="2252" class="Symbol">(</a><a id="2253" href="Cubical.Data.List.Base.html#402" class="Function">rev</a> <a id="2257" href="Cubical.Tactics.MonoidSolver.Reflection.html#2124" class="Bound">varInfos</a><a id="2265" class="Symbol">))</a> <a id="2268" href="Cubical.Tactics.MonoidSolver.Reflection.html#2135" class="Bound">lhs</a> <a id="2272" href="Cubical.Tactics.MonoidSolver.Reflection.html#2139" class="Bound">rhs</a><a id="2275" class="Symbol">)</a>
    <a id="2281" class="Keyword">where</a>
      <a id="2293" href="Cubical.Tactics.MonoidSolver.Reflection.html#2293" class="Function">encloseWithIteratedLambda</a> <a id="2319" class="Symbol">:</a> <a id="2321" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2326" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2333" class="Symbol">→</a> <a id="2335" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2340" class="Symbol">→</a> <a id="2342" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2353" href="Cubical.Tactics.MonoidSolver.Reflection.html#2293" class="Function">encloseWithIteratedLambda</a> <a id="2379" class="Symbol">(</a><a id="2380" href="Cubical.Tactics.MonoidSolver.Reflection.html#2380" class="Bound">varName</a> <a id="2388" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2390" href="Cubical.Tactics.MonoidSolver.Reflection.html#2390" class="Bound">xs</a><a id="2392" class="Symbol">)</a> <a id="2394" href="Cubical.Tactics.MonoidSolver.Reflection.html#2394" class="Bound">t</a> <a id="2396" class="Symbol">=</a> <a id="2398" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="2402" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="2410" class="Symbol">(</a><a id="2411" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2415" href="Cubical.Tactics.MonoidSolver.Reflection.html#2380" class="Bound">varName</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Cubical.Tactics.MonoidSolver.Reflection.html#2293" class="Function">encloseWithIteratedLambda</a> <a id="2450" href="Cubical.Tactics.MonoidSolver.Reflection.html#2390" class="Bound">xs</a> <a id="2453" href="Cubical.Tactics.MonoidSolver.Reflection.html#2394" class="Bound">t</a><a id="2454" class="Symbol">))</a>
      <a id="2463" href="Cubical.Tactics.MonoidSolver.Reflection.html#2293" class="Function">encloseWithIteratedLambda</a> <a id="2489" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2492" href="Cubical.Tactics.MonoidSolver.Reflection.html#2492" class="Bound">t</a> <a id="2494" class="Symbol">=</a> <a id="2496" href="Cubical.Tactics.MonoidSolver.Reflection.html#2492" class="Bound">t</a>

      <a id="2505" href="Cubical.Tactics.MonoidSolver.Reflection.html#2505" class="Function">variableList</a> <a id="2518" class="Symbol">:</a> <a id="2520" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2525" href="Cubical.Tactics.MonoidSolver.Reflection.html#1032" class="Record">VarInfo</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2539" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2550" href="Cubical.Tactics.MonoidSolver.Reflection.html#2505" class="Function">variableList</a> <a id="2563" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2566" class="Symbol">=</a> <a id="2568" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="2573" class="Symbol">(</a><a id="2574" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2578" class="Symbol">(</a><a id="2579" class="Keyword">quote</a> <a id="2585" href="Cubical.Tactics.MonoidSolver.Reflection.html#542" class="InductiveConstructor">emptyVec</a><a id="2593" class="Symbol">)</a> <a id="2595" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2597" class="Symbol">)</a>
      <a id="2605" href="Cubical.Tactics.MonoidSolver.Reflection.html#2505" class="Function">variableList</a> <a id="2618" class="Symbol">(</a><a id="2619" href="Cubical.Tactics.MonoidSolver.Reflection.html#2619" class="Bound">varInfo</a> <a id="2627" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2629" href="Cubical.Tactics.MonoidSolver.Reflection.html#2629" class="Bound">varInfos</a><a id="2637" class="Symbol">)</a>
        <a id="2647" class="Symbol">=</a> <a id="2649" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2659" class="Symbol">(</a><a id="2660" class="Keyword">quote</a> <a id="2666" href="Cubical.Tactics.MonoidSolver.Reflection.html#559" class="InductiveConstructor Operator">_∷vec_</a><a id="2672" class="Symbol">)</a> <a id="2674" class="Symbol">(</a><a id="2675" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="2680" class="Symbol">(</a><a id="2681" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Cubical.Tactics.MonoidSolver.Reflection.html#1124" class="Field">VarInfo.index</a> <a id="2700" href="Cubical.Tactics.MonoidSolver.Reflection.html#2619" class="Bound">varInfo</a><a id="2707" class="Symbol">)</a> <a id="2709" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2711" class="Symbol">)</a> <a id="2713" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2715" class="Symbol">(</a><a id="2716" href="Cubical.Tactics.MonoidSolver.Reflection.html#2505" class="Function">variableList</a> <a id="2729" href="Cubical.Tactics.MonoidSolver.Reflection.html#2629" class="Bound">varInfos</a><a id="2737" class="Symbol">)</a> <a id="2739" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2741" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2743" class="Symbol">))</a>

  <a id="ReflectionSolver.solverCallByVarIndices"></a><a id="2749" href="Cubical.Tactics.MonoidSolver.Reflection.html#2749" class="Function">solverCallByVarIndices</a> <a id="2772" class="Symbol">:</a> <a id="2774" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2776" class="Symbol">→</a> <a id="2778" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2783" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2785" class="Symbol">→</a> <a id="2787" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2792" class="Symbol">→</a> <a id="2794" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2799" class="Symbol">→</a> <a id="2801" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2806" class="Symbol">→</a> <a id="2808" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2815" href="Cubical.Tactics.MonoidSolver.Reflection.html#2749" class="Function">solverCallByVarIndices</a> <a id="2838" href="Cubical.Tactics.MonoidSolver.Reflection.html#2838" class="Bound">n</a> <a id="2840" href="Cubical.Tactics.MonoidSolver.Reflection.html#2840" class="Bound">varIndices</a> <a id="2851" href="Cubical.Tactics.MonoidSolver.Reflection.html#2851" class="Bound">R</a> <a id="2853" href="Cubical.Tactics.MonoidSolver.Reflection.html#2853" class="Bound">lhs</a> <a id="2857" href="Cubical.Tactics.MonoidSolver.Reflection.html#2857" class="Bound">rhs</a> <a id="2861" class="Symbol">=</a>
      <a id="2869" href="Cubical.Tactics.MonoidSolver.Reflection.html#1797" class="Function">solverCallAsTerm</a> <a id="2886" href="Cubical.Tactics.MonoidSolver.Reflection.html#2851" class="Bound">R</a> <a id="2888" class="Symbol">(</a><a id="2889" href="Cubical.Tactics.MonoidSolver.Reflection.html#2948" class="Function">variableList</a> <a id="2902" class="Symbol">(</a><a id="2903" href="Cubical.Data.List.Base.html#402" class="Function">rev</a> <a id="2907" href="Cubical.Tactics.MonoidSolver.Reflection.html#2840" class="Bound">varIndices</a><a id="2917" class="Symbol">))</a> <a id="2920" href="Cubical.Tactics.MonoidSolver.Reflection.html#2853" class="Bound">lhs</a> <a id="2924" href="Cubical.Tactics.MonoidSolver.Reflection.html#2857" class="Bound">rhs</a>
      <a id="2934" class="Keyword">where</a>
        <a id="2948" href="Cubical.Tactics.MonoidSolver.Reflection.html#2948" class="Function">variableList</a> <a id="2961" class="Symbol">:</a> <a id="2963" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2968" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2970" class="Symbol">→</a> <a id="2972" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2976" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
        <a id="2989" href="Cubical.Tactics.MonoidSolver.Reflection.html#2948" class="Function">variableList</a> <a id="3002" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3005" class="Symbol">=</a> <a id="3007" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3012" class="Symbol">(</a><a id="3013" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3017" class="Symbol">(</a><a id="3018" class="Keyword">quote</a> <a id="3024" href="Cubical.Tactics.MonoidSolver.Reflection.html#542" class="InductiveConstructor">emptyVec</a><a id="3032" class="Symbol">)</a> <a id="3034" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3036" class="Symbol">)</a>
        <a id="3046" href="Cubical.Tactics.MonoidSolver.Reflection.html#2948" class="Function">variableList</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Cubical.Tactics.MonoidSolver.Reflection.html#3060" class="Bound">varIndex</a> <a id="3069" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3071" href="Cubical.Tactics.MonoidSolver.Reflection.html#3071" class="Bound">varIndices</a><a id="3081" class="Symbol">)</a>
          <a id="3093" class="Symbol">=</a> <a id="3095" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3100" class="Symbol">(</a><a id="3101" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3105" class="Symbol">(</a><a id="3106" class="Keyword">quote</a> <a id="3112" href="Cubical.Tactics.MonoidSolver.Reflection.html#559" class="InductiveConstructor Operator">_∷vec_</a><a id="3118" class="Symbol">)</a> <a id="3120" class="Symbol">(</a><a id="3121" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3126" class="Symbol">(</a><a id="3127" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="3131" class="Symbol">(</a><a id="3132" href="Cubical.Tactics.MonoidSolver.Reflection.html#3060" class="Bound">varIndex</a><a id="3140" class="Symbol">)</a> <a id="3142" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3144" class="Symbol">)</a> <a id="3146" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3148" class="Symbol">(</a><a id="3149" href="Cubical.Tactics.MonoidSolver.Reflection.html#2948" class="Function">variableList</a> <a id="3162" href="Cubical.Tactics.MonoidSolver.Reflection.html#3071" class="Bound">varIndices</a><a id="3172" class="Symbol">)</a> <a id="3174" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3176" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3178" class="Symbol">))</a>

  <a id="3184" class="Keyword">module</a> <a id="3191" href="Cubical.Tactics.MonoidSolver.Reflection.html#3191" class="Module">_</a> <a id="3193" class="Symbol">(</a><a id="3194" href="Cubical.Tactics.MonoidSolver.Reflection.html#3194" class="Bound">monoid</a> <a id="3201" class="Symbol">:</a> <a id="3203" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3207" class="Symbol">)</a> <a id="3209" class="Keyword">where</a>

    <a id="3220" href="Cubical.Tactics.MonoidSolver.Reflection.html#3220" class="Function">`ε⊗`</a> <a id="3225" class="Symbol">:</a> <a id="3227" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="3236" href="Cubical.Tactics.MonoidSolver.Reflection.html#3220" class="Function">`ε⊗`</a> <a id="3241" class="Symbol">=</a> <a id="3243" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3247" class="Symbol">(</a><a id="3248" class="Keyword">quote</a> <a id="3254" href="Cubical.Tactics.MonoidSolver.MonoidExpression.html#421" class="InductiveConstructor">ε⊗</a><a id="3256" class="Symbol">)</a> <a id="3258" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

    <a id="3266" class="Keyword">mutual</a>

      <a id="3280" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="Function Operator">`_⊗_`</a> <a id="3286" class="Symbol">:</a> <a id="3288" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3293" class="Symbol">(</a><a id="3294" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="3298" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3302" class="Symbol">)</a> <a id="3304" class="Symbol">→</a> <a id="3306" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="3317" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="Function Operator">`_⊗_`</a> <a id="3323" class="Symbol">(</a><a id="3324" href="Cubical.Reflection.Base.html#703" class="InductiveConstructor">harg</a> <a id="3329" class="Symbol">_</a> <a id="3331" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3333" href="Cubical.Tactics.MonoidSolver.Reflection.html#3333" class="Bound">xs</a><a id="3335" class="Symbol">)</a> <a id="3337" class="Symbol">=</a> <a id="3339" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="Function Operator">`_⊗_`</a> <a id="3345" href="Cubical.Tactics.MonoidSolver.Reflection.html#3333" class="Bound">xs</a>
      <a id="3354" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="Function Operator">`_⊗_`</a> <a id="3360" class="Symbol">(</a><a id="3361" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3366" class="Symbol">_</a> <a id="3368" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3370" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3375" href="Cubical.Tactics.MonoidSolver.Reflection.html#3375" class="Bound">x</a> <a id="3377" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3379" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3384" href="Cubical.Tactics.MonoidSolver.Reflection.html#3384" class="Bound">y</a> <a id="3386" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3388" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3390" class="Symbol">)</a> <a id="3392" class="Symbol">=</a>
        <a id="3402" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a>
          <a id="3416" class="Symbol">(</a><a id="3417" class="Keyword">quote</a> <a id="3423" href="Cubical.Tactics.MonoidSolver.MonoidExpression.html#438" class="InductiveConstructor Operator">_⊗_</a><a id="3426" class="Symbol">)</a> <a id="3428" class="Symbol">(</a><a id="3429" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3434" class="Symbol">(</a><a id="3435" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="3451" href="Cubical.Tactics.MonoidSolver.Reflection.html#3375" class="Bound">x</a><a id="3452" class="Symbol">)</a> <a id="3454" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3456" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3461" class="Symbol">(</a><a id="3462" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="3478" href="Cubical.Tactics.MonoidSolver.Reflection.html#3384" class="Bound">y</a><a id="3479" class="Symbol">)</a> <a id="3481" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3483" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3485" class="Symbol">)</a>
      <a id="3493" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="CatchallClause Function Operator">`_⊗_`</a><a id="3498" class="CatchallClause"> </a><a id="3499" class="CatchallClause Symbol">_</a> <a id="3501" class="Symbol">=</a> <a id="3503" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>

      <a id="3518" href="Cubical.Tactics.MonoidSolver.Reflection.html#3518" class="Function">finiteNumberAsTerm</a> <a id="3537" class="Symbol">:</a> <a id="3539" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3541" class="Symbol">→</a> <a id="3543" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="3554" href="Cubical.Tactics.MonoidSolver.Reflection.html#3518" class="Function">finiteNumberAsTerm</a> <a id="3573" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">ℕ.zero</a> <a id="3580" class="Symbol">=</a> <a id="3582" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3586" class="Symbol">(</a><a id="3587" class="Keyword">quote</a> <a id="3593" href="Cubical.Tactics.MonoidSolver.Reflection.html#435" class="InductiveConstructor">fzero</a><a id="3598" class="Symbol">)</a> <a id="3600" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
      <a id="3609" href="Cubical.Tactics.MonoidSolver.Reflection.html#3518" class="Function">finiteNumberAsTerm</a> <a id="3628" class="Symbol">(</a><a id="3629" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">ℕ.suc</a> <a id="3635" href="Cubical.Tactics.MonoidSolver.Reflection.html#3635" class="Bound">n</a><a id="3636" class="Symbol">)</a> <a id="3638" class="Symbol">=</a> <a id="3640" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3644" class="Symbol">(</a><a id="3645" class="Keyword">quote</a> <a id="3651" href="Cubical.Tactics.MonoidSolver.Reflection.html#449" class="InductiveConstructor">fsuc</a><a id="3655" class="Symbol">)</a> <a id="3657" class="Symbol">(</a><a id="3658" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3663" class="Symbol">(</a><a id="3664" href="Cubical.Tactics.MonoidSolver.Reflection.html#3518" class="Function">finiteNumberAsTerm</a> <a id="3683" href="Cubical.Tactics.MonoidSolver.Reflection.html#3635" class="Bound">n</a><a id="3684" class="Symbol">)</a> <a id="3686" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3688" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3690" class="Symbol">)</a>

      <a id="3699" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="3715" class="Symbol">:</a> <a id="3717" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3722" class="Symbol">→</a> <a id="3724" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="3735" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="3751" class="Symbol">(</a><a id="3752" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="3756" href="Cubical.Tactics.MonoidSolver.Reflection.html#3756" class="Bound">index</a> <a id="3762" class="Symbol">_)</a> <a id="3765" class="Symbol">=</a> <a id="3767" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="3771" class="Symbol">(</a><a id="3772" class="Keyword">quote</a> <a id="3778" href="Cubical.Tactics.MonoidSolver.MonoidExpression.html#396" class="InductiveConstructor">∣</a><a id="3779" class="Symbol">)</a> <a id="3781" class="Symbol">(</a><a id="3782" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="3787" class="Symbol">(</a><a id="3788" href="Cubical.Tactics.MonoidSolver.Reflection.html#3518" class="Function">finiteNumberAsTerm</a> <a id="3807" href="Cubical.Tactics.MonoidSolver.Reflection.html#3756" class="Bound">index</a><a id="3812" class="Symbol">)</a> <a id="3814" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3816" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3818" class="Symbol">)</a>
      <a id="3826" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="3842" href="Cubical.Tactics.MonoidSolver.Reflection.html#3842" class="Bound">t</a><a id="3843" class="Symbol">@(</a><a id="3845" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="3849" href="Cubical.Tactics.MonoidSolver.Reflection.html#3849" class="Bound">n</a> <a id="3851" href="Cubical.Tactics.MonoidSolver.Reflection.html#3851" class="Bound">xs</a><a id="3853" class="Symbol">)</a> <a id="3855" class="Symbol">=</a>
        <a id="3865" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">if</a> <a id="3868" class="Symbol">(</a><a id="3869" href="Cubical.Tactics.MonoidSolver.Reflection.html#3849" class="Bound">n</a> <a id="3871" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">==</a> <a id="3874" href="Cubical.Tactics.MonoidSolver.Reflection.html#943" class="Bound">op</a><a id="3876" class="Symbol">)</a>
          <a id="3888" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">then</a> <a id="3893" href="Cubical.Tactics.MonoidSolver.Reflection.html#3280" class="Function Operator">`_⊗_`</a> <a id="3899" href="Cubical.Tactics.MonoidSolver.Reflection.html#3851" class="Bound">xs</a>
        <a id="3910" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">else</a> <a id="3915" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">if</a> <a id="3918" class="Symbol">(</a><a id="3919" href="Cubical.Tactics.MonoidSolver.Reflection.html#3849" class="Bound">n</a> <a id="3921" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">==</a> <a id="3924" href="Cubical.Tactics.MonoidSolver.Reflection.html#946" class="Bound">unit</a><a id="3928" class="Symbol">)</a>
          <a id="3940" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">then</a> <a id="3945" href="Cubical.Tactics.MonoidSolver.Reflection.html#3220" class="Function">`ε⊗`</a>
        <a id="3958" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">else</a>
          <a id="3973" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>
      <a id="3987" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="CatchallClause Function">buildExpression</a><a id="4002" class="CatchallClause"> </a><a id="4003" href="Cubical.Tactics.MonoidSolver.Reflection.html#4003" class="CatchallClause Bound">t</a> <a id="4005" class="Symbol">=</a> <a id="4007" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>


    <a id="4021" href="Cubical.Tactics.MonoidSolver.Reflection.html#4021" class="Function">toMonoidExpression</a> <a id="4040" class="Symbol">:</a> <a id="4042" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="4048" class="Symbol">(</a><a id="4049" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4054" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="4056" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4060" class="Symbol">)</a> <a id="4062" class="Symbol">→</a> <a id="4064" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="4070" class="Symbol">(</a><a id="4071" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4076" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="4078" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4082" class="Symbol">)</a>
    <a id="4088" href="Cubical.Tactics.MonoidSolver.Reflection.html#4021" class="Function">toMonoidExpression</a> <a id="4107" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a> <a id="4115" class="Symbol">=</a> <a id="4117" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
    <a id="4129" href="Cubical.Tactics.MonoidSolver.Reflection.html#4021" class="Function">toMonoidExpression</a> <a id="4148" class="Symbol">(</a><a id="4149" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4154" class="Symbol">(</a><a id="4155" href="Cubical.Tactics.MonoidSolver.Reflection.html#4155" class="Bound">lhs</a> <a id="4159" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4161" href="Cubical.Tactics.MonoidSolver.Reflection.html#4161" class="Bound">rhs</a><a id="4164" class="Symbol">))</a> <a id="4167" class="Symbol">=</a> <a id="4169" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4174" class="Symbol">(</a><a id="4175" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="4191" href="Cubical.Tactics.MonoidSolver.Reflection.html#4155" class="Bound">lhs</a> <a id="4195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4197" href="Cubical.Tactics.MonoidSolver.Reflection.html#3699" class="Function">buildExpression</a> <a id="4213" href="Cubical.Tactics.MonoidSolver.Reflection.html#4161" class="Bound">rhs</a><a id="4216" class="Symbol">)</a>

  <a id="ReflectionSolver.adjustDeBruijnIndex"></a><a id="4221" href="Cubical.Tactics.MonoidSolver.Reflection.html#4221" class="Function">adjustDeBruijnIndex</a> <a id="4241" class="Symbol">:</a> <a id="4243" class="Symbol">(</a><a id="4244" href="Cubical.Tactics.MonoidSolver.Reflection.html#4244" class="Bound">n</a> <a id="4246" class="Symbol">:</a> <a id="4248" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4249" class="Symbol">)</a> <a id="4251" class="Symbol">→</a> <a id="4253" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4258" class="Symbol">→</a> <a id="4260" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="4267" href="Cubical.Tactics.MonoidSolver.Reflection.html#4221" class="Function">adjustDeBruijnIndex</a> <a id="4287" href="Cubical.Tactics.MonoidSolver.Reflection.html#4287" class="Bound">n</a> <a id="4289" class="Symbol">(</a><a id="4290" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="4294" href="Cubical.Tactics.MonoidSolver.Reflection.html#4294" class="Bound">k</a> <a id="4296" href="Cubical.Tactics.MonoidSolver.Reflection.html#4296" class="Bound">args</a><a id="4300" class="Symbol">)</a> <a id="4302" class="Symbol">=</a> <a id="4304" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="4308" class="Symbol">(</a><a id="4309" href="Cubical.Tactics.MonoidSolver.Reflection.html#4294" class="Bound">k</a> <a id="4311" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4313" href="Cubical.Tactics.MonoidSolver.Reflection.html#4287" class="Bound">n</a><a id="4314" class="Symbol">)</a> <a id="4316" href="Cubical.Tactics.MonoidSolver.Reflection.html#4296" class="Bound">args</a>
  <a id="4323" href="Cubical.Tactics.MonoidSolver.Reflection.html#4221" class="CatchallClause Function">adjustDeBruijnIndex</a><a id="4342" class="CatchallClause"> </a><a id="4343" href="Cubical.Tactics.MonoidSolver.Reflection.html#4343" class="CatchallClause Bound">n</a><a id="4344" class="CatchallClause"> </a><a id="4345" class="CatchallClause Symbol">_</a> <a id="4347" class="Symbol">=</a> <a id="4349" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a>

  <a id="ReflectionSolver.extractVarIndices"></a><a id="4360" href="Cubical.Tactics.MonoidSolver.Reflection.html#4360" class="Function">extractVarIndices</a> <a id="4378" class="Symbol">:</a> <a id="4380" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="4386" class="Symbol">(</a><a id="4387" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4392" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4396" class="Symbol">)</a> <a id="4398" class="Symbol">→</a> <a id="4400" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="4406" class="Symbol">(</a><a id="4407" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4412" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4413" class="Symbol">)</a>
  <a id="4417" href="Cubical.Tactics.MonoidSolver.Reflection.html#4360" class="Function">extractVarIndices</a> <a id="4435" class="Symbol">(</a><a id="4436" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4441" class="Symbol">((</a><a id="4443" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="4447" href="Cubical.Tactics.MonoidSolver.Reflection.html#4447" class="Bound">index</a> <a id="4453" class="Symbol">_)</a> <a id="4456" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4458" href="Cubical.Tactics.MonoidSolver.Reflection.html#4458" class="Bound">l</a><a id="4459" class="Symbol">))</a> <a id="4462" class="Keyword">with</a> <a id="4467" href="Cubical.Tactics.MonoidSolver.Reflection.html#4360" class="Function">extractVarIndices</a> <a id="4485" class="Symbol">(</a><a id="4486" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4491" href="Cubical.Tactics.MonoidSolver.Reflection.html#4458" class="Bound">l</a><a id="4492" class="Symbol">)</a>
  <a id="4496" class="Symbol">...</a> <a id="4500" class="Symbol">|</a> <a id="4502" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4507" href="Cubical.Tactics.MonoidSolver.Reflection.html#4507" class="Bound">indices</a> <a id="4515" class="Symbol">=</a> <a id="4517" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4522" class="Symbol">(</a><a id="4523" class="Bound">index</a> <a id="4529" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4531" href="Cubical.Tactics.MonoidSolver.Reflection.html#4507" class="Bound">indices</a><a id="4538" class="Symbol">)</a>
  <a id="4542" class="Symbol">...</a> <a id="4546" class="Symbol">|</a> <a id="4548" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a> <a id="4556" class="Symbol">=</a> <a id="4558" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
  <a id="4568" href="Cubical.Tactics.MonoidSolver.Reflection.html#4360" class="Function">extractVarIndices</a> <a id="4586" class="Symbol">(</a><a id="4587" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4592" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4594" class="Symbol">)</a> <a id="4596" class="Symbol">=</a> <a id="4598" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="4603" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="4608" href="Cubical.Tactics.MonoidSolver.Reflection.html#4360" class="CatchallClause Function">extractVarIndices</a><a id="4625" class="CatchallClause"> </a><a id="4626" class="CatchallClause Symbol">_</a> <a id="4628" class="Symbol">=</a> <a id="4630" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>

  <a id="ReflectionSolver.getVarsAndEquation"></a><a id="4641" href="Cubical.Tactics.MonoidSolver.Reflection.html#4641" class="Function">getVarsAndEquation</a> <a id="4660" class="Symbol">:</a> <a id="4662" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4667" class="Symbol">→</a> <a id="4669" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="4675" class="Symbol">(</a><a id="4676" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4681" href="Cubical.Tactics.MonoidSolver.Reflection.html#1032" class="Record">VarInfo</a> <a id="4689" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="4691" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4695" class="Symbol">)</a>
  <a id="4699" href="Cubical.Tactics.MonoidSolver.Reflection.html#4641" class="Function">getVarsAndEquation</a> <a id="4718" href="Cubical.Tactics.MonoidSolver.Reflection.html#4718" class="Bound">t</a> <a id="4720" class="Symbol">=</a>
    <a id="4726" class="Keyword">let</a>
      <a id="4736" class="Symbol">(</a><a id="4737" href="Cubical.Tactics.MonoidSolver.Reflection.html#4737" class="Bound">rawVars</a> <a id="4745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4747" href="Cubical.Tactics.MonoidSolver.Reflection.html#4747" class="Bound">equationTerm</a><a id="4759" class="Symbol">)</a> <a id="4761" class="Symbol">=</a> <a id="4763" href="Cubical.Tactics.MonoidSolver.Reflection.html#4896" class="Function">extractVars</a> <a id="4775" href="Cubical.Tactics.MonoidSolver.Reflection.html#4718" class="Bound">t</a>
      <a id="4783" href="Cubical.Tactics.MonoidSolver.Reflection.html#4783" class="Bound">maybeVars</a> <a id="4793" class="Symbol">=</a> <a id="4795" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="Function">addIndices</a> <a id="4806" class="Symbol">(</a><a id="4807" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="4814" href="Cubical.Tactics.MonoidSolver.Reflection.html#4737" class="Bound">rawVars</a><a id="4821" class="Symbol">)</a> <a id="4823" href="Cubical.Tactics.MonoidSolver.Reflection.html#4737" class="Bound">rawVars</a>
    <a id="4835" class="Keyword">in</a> <a id="4838" href="Cubical.Data.Maybe.Base.html#346" class="Function">map-Maybe</a> <a id="4848" class="Symbol">(</a><a id="4849" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,</a> <a id="4852" href="Cubical.Tactics.MonoidSolver.Reflection.html#4747" class="Bound">equationTerm</a><a id="4864" class="Symbol">)</a> <a id="4866" href="Cubical.Tactics.MonoidSolver.Reflection.html#4783" class="Bound">maybeVars</a>
    <a id="4880" class="Keyword">where</a>
          <a id="4896" href="Cubical.Tactics.MonoidSolver.Reflection.html#4896" class="Function">extractVars</a> <a id="4908" class="Symbol">:</a> <a id="4910" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4915" class="Symbol">→</a> <a id="4917" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4922" class="Symbol">(</a><a id="4923" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4930" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="4932" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4936" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4940" class="Symbol">)</a> <a id="4942" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="4944" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
          <a id="4959" href="Cubical.Tactics.MonoidSolver.Reflection.html#4896" class="Function">extractVars</a> <a id="4971" class="Symbol">(</a><a id="4972" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="4975" href="Cubical.Tactics.MonoidSolver.Reflection.html#4975" class="Bound">argType</a> <a id="4983" class="Symbol">(</a><a id="4984" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="4988" href="Cubical.Tactics.MonoidSolver.Reflection.html#4988" class="Bound">varName</a> <a id="4996" href="Cubical.Tactics.MonoidSolver.Reflection.html#4996" class="Bound">t</a><a id="4997" class="Symbol">))</a> <a id="5000" class="Keyword">with</a> <a id="5005" href="Cubical.Tactics.MonoidSolver.Reflection.html#4896" class="Function">extractVars</a> <a id="5017" href="Cubical.Tactics.MonoidSolver.Reflection.html#4996" class="Bound">t</a>
          <a id="5029" class="Symbol">...</a>                                         <a id="5073" class="Symbol">|</a> <a id="5075" href="Cubical.Tactics.MonoidSolver.Reflection.html#5075" class="Bound">xs</a> <a id="5078" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5080" href="Cubical.Tactics.MonoidSolver.Reflection.html#5080" class="Bound">equation</a>
                                                        <a id="5145" class="Symbol">=</a> <a id="5147" class="Symbol">(</a><a id="5148" class="Bound">varName</a> <a id="5156" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5158" class="Bound">argType</a><a id="5165" class="Symbol">)</a> <a id="5167" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5169" href="Cubical.Tactics.MonoidSolver.Reflection.html#5075" class="Bound">xs</a> <a id="5172" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5174" href="Cubical.Tactics.MonoidSolver.Reflection.html#5080" class="Bound">equation</a>
          <a id="5193" href="Cubical.Tactics.MonoidSolver.Reflection.html#4896" class="CatchallClause Function">extractVars</a><a id="5204" class="CatchallClause"> </a><a id="5205" href="Cubical.Tactics.MonoidSolver.Reflection.html#5205" class="CatchallClause Bound">equation</a> <a id="5214" class="Symbol">=</a> <a id="5216" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5219" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5221" href="Cubical.Tactics.MonoidSolver.Reflection.html#5205" class="Bound">equation</a>

          <a id="5241" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="Function">addIndices</a> <a id="5252" class="Symbol">:</a> <a id="5254" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5256" class="Symbol">→</a> <a id="5258" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5263" class="Symbol">(</a><a id="5264" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5271" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="5273" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="5277" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="5281" class="Symbol">)</a> <a id="5283" class="Symbol">→</a> <a id="5285" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="5291" class="Symbol">(</a><a id="5292" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5297" href="Cubical.Tactics.MonoidSolver.Reflection.html#1032" class="Record">VarInfo</a><a id="5304" class="Symbol">)</a>
          <a id="5316" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="Function">addIndices</a> <a id="5327" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">ℕ.zero</a>         <a id="5342" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>        <a id="5352" class="Symbol">=</a> <a id="5354" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5359" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
          <a id="5372" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="Function">addIndices</a> <a id="5383" class="Symbol">(</a><a id="5384" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">ℕ.suc</a> <a id="5390" href="Cubical.Tactics.MonoidSolver.Reflection.html#5390" class="Bound">countVar</a><a id="5398" class="Symbol">)</a> <a id="5400" class="Symbol">((</a><a id="5402" href="Cubical.Tactics.MonoidSolver.Reflection.html#5402" class="Bound">varName</a> <a id="5410" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5412" href="Cubical.Tactics.MonoidSolver.Reflection.html#5412" class="Bound">argType</a><a id="5419" class="Symbol">)</a> <a id="5421" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5423" href="Cubical.Tactics.MonoidSolver.Reflection.html#5423" class="Bound">list</a><a id="5427" class="Symbol">)</a> <a id="5429" class="Symbol">=</a>
            <a id="5443" href="Cubical.Data.Maybe.Base.html#346" class="Function">map-Maybe</a> <a id="5453" class="Symbol">(λ</a> <a id="5456" href="Cubical.Tactics.MonoidSolver.Reflection.html#5456" class="Bound">varList</a> <a id="5464" class="Symbol">→</a> <a id="5466" class="Keyword">record</a> <a id="5473" class="Symbol">{</a> <a id="5475" href="Cubical.Tactics.MonoidSolver.Reflection.html#1076" class="Field">varName</a> <a id="5483" class="Symbol">=</a> <a id="5485" href="Cubical.Tactics.MonoidSolver.Reflection.html#5402" class="Bound">varName</a> <a id="5493" class="Symbol">;</a> <a id="5495" href="Cubical.Tactics.MonoidSolver.Reflection.html#1099" class="Field">varType</a> <a id="5503" class="Symbol">=</a> <a id="5505" href="Cubical.Tactics.MonoidSolver.Reflection.html#5412" class="Bound">argType</a> <a id="5513" class="Symbol">;</a> <a id="5515" href="Cubical.Tactics.MonoidSolver.Reflection.html#1124" class="Field">index</a> <a id="5521" class="Symbol">=</a> <a id="5523" href="Cubical.Tactics.MonoidSolver.Reflection.html#5390" class="Bound">countVar</a> <a id="5532" class="Symbol">}</a>
                                   <a id="5569" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5571" href="Cubical.Tactics.MonoidSolver.Reflection.html#5456" class="Bound">varList</a><a id="5578" class="Symbol">)</a>
                      <a id="5602" class="Symbol">(</a><a id="5603" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="Function">addIndices</a> <a id="5614" href="Cubical.Tactics.MonoidSolver.Reflection.html#5390" class="Bound">countVar</a> <a id="5623" href="Cubical.Tactics.MonoidSolver.Reflection.html#5423" class="Bound">list</a><a id="5627" class="Symbol">)</a>
          <a id="5639" href="Cubical.Tactics.MonoidSolver.Reflection.html#5241" class="CatchallClause Function">addIndices</a><a id="5649" class="CatchallClause"> </a><a id="5650" class="CatchallClause Symbol">_</a><a id="5651" class="CatchallClause"> </a><a id="5652" class="CatchallClause Symbol">_</a> <a id="5654" class="Symbol">=</a> <a id="5656" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>

  <a id="ReflectionSolver.toListOfTerms"></a><a id="5667" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="5681" class="Symbol">:</a> <a id="5683" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5688" class="Symbol">→</a> <a id="5690" href="Cubical.Data.Maybe.Base.html#176" class="Datatype">Maybe</a> <a id="5696" class="Symbol">(</a><a id="5697" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5702" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="5706" class="Symbol">)</a>
  <a id="5710" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="5724" class="Symbol">(</a><a id="5725" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="5729" href="Cubical.Tactics.MonoidSolver.Reflection.html#5729" class="Bound">c</a> <a id="5731" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5733" class="Symbol">)</a> <a id="5735" class="Symbol">=</a> <a id="5737" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">if</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Cubical.Tactics.MonoidSolver.Reflection.html#5729" class="Bound">c</a> <a id="5743" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">==</a> <a id="5746" class="Symbol">(</a><a id="5747" class="Keyword">quote</a> <a id="5753" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5755" class="Symbol">))</a> <a id="5758" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">then</a> <a id="5763" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5768" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5771" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">else</a> <a id="5776" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
  <a id="5786" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="5800" class="Symbol">(</a><a id="5801" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="5805" href="Cubical.Tactics.MonoidSolver.Reflection.html#5805" class="Bound">c</a> <a id="5807" class="Symbol">(</a><a id="5808" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="5813" href="Cubical.Tactics.MonoidSolver.Reflection.html#5813" class="Bound">t</a> <a id="5815" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5817" href="Cubical.Reflection.Base.html#618" class="InductiveConstructor">varg</a> <a id="5822" href="Cubical.Tactics.MonoidSolver.Reflection.html#5822" class="Bound">s</a> <a id="5824" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5826" href="Cubical.Tactics.MonoidSolver.Reflection.html#5826" class="Bound">args</a><a id="5830" class="Symbol">))</a> <a id="5833" class="Keyword">with</a> <a id="5838" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="5852" href="Cubical.Tactics.MonoidSolver.Reflection.html#5822" class="Bound">s</a>
  <a id="5856" class="Symbol">...</a> <a id="5860" class="Symbol">|</a> <a id="5862" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5867" href="Cubical.Tactics.MonoidSolver.Reflection.html#5867" class="Bound">terms</a> <a id="5873" class="Symbol">=</a> <a id="5875" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">if</a> <a id="5878" class="Symbol">(</a><a id="5879" class="Bound">c</a> <a id="5881" href="Cubical.Tactics.MonoidSolver.Reflection.html#975" class="Function Operator">==</a> <a id="5884" class="Symbol">(</a><a id="5885" class="Keyword">quote</a> <a id="5891" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="5894" class="Symbol">))</a> <a id="5897" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">then</a> <a id="5902" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="5907" class="Symbol">(</a><a id="5908" class="Bound">t</a> <a id="5910" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5912" href="Cubical.Tactics.MonoidSolver.Reflection.html#5867" class="Bound">terms</a><a id="5917" class="Symbol">)</a> <a id="5919" href="Cubical.Data.Bool.Base.html#668" class="Function Operator">else</a> <a id="5924" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
  <a id="5934" class="Symbol">...</a> <a id="5938" class="Symbol">|</a> <a id="5940" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a> <a id="5948" class="Symbol">=</a> <a id="5950" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
  <a id="5960" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="5974" class="Symbol">(</a><a id="5975" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="5979" href="Cubical.Tactics.MonoidSolver.Reflection.html#5979" class="Bound">c</a> <a id="5981" class="Symbol">(</a><a id="5982" href="Cubical.Reflection.Base.html#703" class="InductiveConstructor">harg</a> <a id="5987" href="Cubical.Tactics.MonoidSolver.Reflection.html#5987" class="Bound">t</a> <a id="5989" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5991" href="Cubical.Tactics.MonoidSolver.Reflection.html#5991" class="Bound">args</a><a id="5995" class="Symbol">))</a> <a id="5998" class="Symbol">=</a> <a id="6000" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="Function">toListOfTerms</a> <a id="6014" class="Symbol">(</a><a id="6015" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="6019" href="Cubical.Tactics.MonoidSolver.Reflection.html#5979" class="Bound">c</a> <a id="6021" href="Cubical.Tactics.MonoidSolver.Reflection.html#5991" class="Bound">args</a><a id="6025" class="Symbol">)</a>
  <a id="6029" href="Cubical.Tactics.MonoidSolver.Reflection.html#5667" class="CatchallClause Function">toListOfTerms</a><a id="6042" class="CatchallClause"> </a><a id="6043" class="CatchallClause Symbol">_</a> <a id="6045" class="Symbol">=</a> <a id="6047" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>

  <a id="ReflectionSolver.solve-macro"></a><a id="6058" href="Cubical.Tactics.MonoidSolver.Reflection.html#6058" class="Function">solve-macro</a> <a id="6070" class="Symbol">:</a> <a id="6072" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="6077" class="Symbol">→</a> <a id="6079" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="6084" class="Symbol">→</a> <a id="6086" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="6089" href="Cubical.Data.Unit.Base.html#172" class="Record">Unit</a>
  <a id="6096" href="Cubical.Tactics.MonoidSolver.Reflection.html#6058" class="Function">solve-macro</a> <a id="6108" href="Cubical.Tactics.MonoidSolver.Reflection.html#6108" class="Bound">monoid</a> <a id="6115" href="Cubical.Tactics.MonoidSolver.Reflection.html#6115" class="Bound">hole</a> <a id="6120" class="Symbol">=</a>
    <a id="6126" class="Keyword">do</a>
      <a id="6135" href="Cubical.Tactics.MonoidSolver.Reflection.html#6135" class="Bound">hole′</a> <a id="6141" href="Cubical.Reflection.Base.html#302" class="Function Operator">←</a> <a id="6143" href="Agda.Builtin.Reflection.html#8878" class="Postulate">inferType</a> <a id="6153" href="Cubical.Tactics.MonoidSolver.Reflection.html#6115" class="Bound">hole</a> <a id="6158" href="Cubical.Reflection.Base.html#302" class="Function Operator">&gt;&gt;=</a> <a id="6162" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a>
      <a id="6178" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="6183" class="Symbol">(</a><a id="6184" href="Cubical.Tactics.MonoidSolver.Reflection.html#6184" class="Bound">varInfos</a> <a id="6193" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6195" href="Cubical.Tactics.MonoidSolver.Reflection.html#6195" class="Bound">equation</a><a id="6203" class="Symbol">)</a> <a id="6205" href="Cubical.Reflection.Base.html#302" class="Function Operator">←</a> <a id="6207" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="6216" class="Symbol">(</a><a id="6217" href="Cubical.Tactics.MonoidSolver.Reflection.html#4641" class="Function">getVarsAndEquation</a> <a id="6236" href="Cubical.Tactics.MonoidSolver.Reflection.html#6135" class="Bound">hole′</a><a id="6241" class="Symbol">)</a>
        <a id="6251" class="Keyword">where</a>
          <a id="6267" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
            <a id="6287" class="Symbol">→</a> <a id="6289" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="6299" class="Symbol">(</a><a id="6300" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="6307" class="String">&quot;Something went wrong when getting the variable names in &quot;</a>
                           <a id="6393" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6395" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="6403" href="Cubical.Tactics.MonoidSolver.Reflection.html#6135" class="Bound">hole′</a> <a id="6409" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6411" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6413" class="Symbol">)</a>
      <a id="6421" class="Comment">{-
        The call to the monoid solver will be inside a lamba-expression.
        That means, that we have to adjust the deBruijn-indices of the variables in &#39;monoid&#39;
      -}</a>
      <a id="6605" href="Cubical.Tactics.MonoidSolver.Reflection.html#6605" class="Bound">adjustedMonoid</a> <a id="6620" href="Cubical.Reflection.Base.html#302" class="Function Operator">←</a> <a id="6622" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="6631" class="Symbol">(</a><a id="6632" href="Cubical.Tactics.MonoidSolver.Reflection.html#4221" class="Function">adjustDeBruijnIndex</a> <a id="6652" class="Symbol">(</a><a id="6653" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="6660" href="Cubical.Tactics.MonoidSolver.Reflection.html#6184" class="Bound">varInfos</a><a id="6668" class="Symbol">)</a> <a id="6670" href="Cubical.Tactics.MonoidSolver.Reflection.html#6108" class="Bound">monoid</a><a id="6676" class="Symbol">)</a>
      <a id="6684" href="Cubical.Data.Maybe.Base.html#232" class="InductiveConstructor">just</a> <a id="6689" class="Symbol">(</a><a id="6690" href="Cubical.Tactics.MonoidSolver.Reflection.html#6690" class="Bound">lhs</a> <a id="6694" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6696" href="Cubical.Tactics.MonoidSolver.Reflection.html#6696" class="Bound">rhs</a><a id="6699" class="Symbol">)</a> <a id="6701" href="Cubical.Reflection.Base.html#302" class="Function Operator">←</a> <a id="6703" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="6712" class="Symbol">(</a><a id="6713" href="Cubical.Tactics.MonoidSolver.Reflection.html#4021" class="Function">toMonoidExpression</a> <a id="6732" href="Cubical.Tactics.MonoidSolver.Reflection.html#6605" class="Bound">adjustedMonoid</a> <a id="6747" class="Symbol">(</a><a id="6748" href="Cubical.Tactics.MonoidSolver.Reflection.html#1702" class="Function">getArgs</a> <a id="6756" href="Cubical.Tactics.MonoidSolver.Reflection.html#6195" class="Bound">equation</a><a id="6764" class="Symbol">))</a>
        <a id="6775" class="Keyword">where</a>
          <a id="6791" href="Cubical.Data.Maybe.Base.html#212" class="InductiveConstructor">nothing</a>
            <a id="6811" class="Symbol">→</a> <a id="6813" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a><a id="6822" class="Symbol">(</a>
                <a id="6840" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="6847" class="String">&quot;Error while trying to build ASTs for the equation &quot;</a> <a id="6900" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="6918" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="6926" href="Cubical.Tactics.MonoidSolver.Reflection.html#6195" class="Bound">equation</a> <a id="6935" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6937" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6939" class="Symbol">)</a>
      <a id="6947" class="Keyword">let</a> <a id="6951" href="Cubical.Tactics.MonoidSolver.Reflection.html#6951" class="Bound">solution</a> <a id="6960" class="Symbol">=</a> <a id="6962" href="Cubical.Tactics.MonoidSolver.Reflection.html#2029" class="Function">solverCallWithLambdas</a> <a id="6984" class="Symbol">(</a><a id="6985" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="6992" href="Cubical.Tactics.MonoidSolver.Reflection.html#6184" class="Bound">varInfos</a><a id="7000" class="Symbol">)</a> <a id="7002" href="Cubical.Tactics.MonoidSolver.Reflection.html#6184" class="Bound">varInfos</a> <a id="7011" href="Cubical.Tactics.MonoidSolver.Reflection.html#6605" class="Bound">adjustedMonoid</a> <a id="7026" href="Cubical.Tactics.MonoidSolver.Reflection.html#6690" class="Bound">lhs</a> <a id="7030" href="Cubical.Tactics.MonoidSolver.Reflection.html#6696" class="Bound">rhs</a>
      <a id="7040" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="7046" href="Cubical.Tactics.MonoidSolver.Reflection.html#6115" class="Bound">hole</a> <a id="7051" href="Cubical.Tactics.MonoidSolver.Reflection.html#6951" class="Bound">solution</a>

<a id="7061" class="Keyword">macro</a>
  <a id="solveMonoid"></a><a id="7069" href="Cubical.Tactics.MonoidSolver.Reflection.html#7069" class="Function">solveMonoid</a> <a id="7081" class="Symbol">:</a> <a id="7083" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7088" class="Symbol">→</a> <a id="7090" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7095" class="Symbol">→</a> <a id="7097" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="7100" class="Symbol">_</a>
  <a id="7104" href="Cubical.Tactics.MonoidSolver.Reflection.html#7069" class="Function">solveMonoid</a> <a id="7116" class="Symbol">=</a> <a id="7118" href="Cubical.Tactics.MonoidSolver.Reflection.html#6058" class="Function">ReflectionSolver.solve-macro</a> <a id="7147" class="Symbol">(</a><a id="7148" class="Keyword">quote</a> <a id="7154" href="Cubical.Algebra.Monoid.Base.html#987" class="Field Operator">MonoidStr._·_</a><a id="7167" class="Symbol">)</a> <a id="7169" class="Symbol">(</a><a id="7170" class="Keyword">quote</a> <a id="7176" href="Cubical.Algebra.Monoid.Base.html#970" class="Field">MonoidStr.ε</a><a id="7187" class="Symbol">)</a> <a id="7189" class="Symbol">(</a><a id="7190" class="Keyword">quote</a> <a id="7196" href="Cubical.Tactics.MonoidSolver.Reflection.html#726" class="Function">naiveSolve</a><a id="7206" class="Symbol">)</a>

  <a id="solveCommMonoid"></a><a id="7211" href="Cubical.Tactics.MonoidSolver.Reflection.html#7211" class="Function">solveCommMonoid</a> <a id="7227" class="Symbol">:</a> <a id="7229" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7234" class="Symbol">→</a> <a id="7236" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7241" class="Symbol">→</a> <a id="7243" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="7246" class="Symbol">_</a>
  <a id="7250" href="Cubical.Tactics.MonoidSolver.Reflection.html#7211" class="Function">solveCommMonoid</a> <a id="7266" class="Symbol">=</a> <a id="7268" href="Cubical.Tactics.MonoidSolver.Reflection.html#6058" class="Function">ReflectionSolver.solve-macro</a> <a id="7297" class="Symbol">(</a><a id="7298" class="Keyword">quote</a> <a id="7304" href="Cubical.Algebra.CommMonoid.Base.html#1012" class="Field Operator">CommMonoidStr._·_</a><a id="7321" class="Symbol">)</a> <a id="7323" class="Symbol">(</a><a id="7324" class="Keyword">quote</a> <a id="7330" href="Cubical.Algebra.CommMonoid.Base.html#991" class="Field">CommMonoidStr.ε</a><a id="7345" class="Symbol">)</a> <a id="7347" class="Symbol">(</a><a id="7348" class="Keyword">quote</a> <a id="7354" href="Cubical.Tactics.MonoidSolver.Reflection.html#809" class="Function">naiveCommSolve</a><a id="7368" class="Symbol">)</a>
</pre></body></html>