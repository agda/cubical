<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Algebra.IntegerMatrix.Diagonalization</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-

This file contains a diagonalization procedure simpler than Smith normalization.
For any matrix M, it provides two invertible matrices P, Q, one diagonal matrix D and an equality M = P·D·Q.
The only difference from Smith is, the numbers in D are allowed to be arbitrary, instead of being consecutively divisible.
But it is enough to establish important properties of finitely presented abelian groups.
Also, it can be computed much more efficiently (than Smith, only).

-}</a>
<a id="478" class="Keyword">module</a> <a id="485" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html" class="Module">Cubical.Algebra.IntegerMatrix.Diagonalization</a> <a id="531" class="Keyword">where</a>

<a id="538" class="Keyword">open</a> <a id="543" class="Keyword">import</a> <a id="550" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="578" class="Keyword">open</a> <a id="583" class="Keyword">import</a> <a id="590" href="Cubical.Foundations.Function.html" class="Module">Cubical.Foundations.Function</a>
<a id="619" class="Keyword">open</a> <a id="624" class="Keyword">import</a> <a id="631" href="Cubical.Foundations.HLevels.html" class="Module">Cubical.Foundations.HLevels</a>

<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
  <a id="691" class="Keyword">hiding</a>   <a id="700" class="Symbol">(</a><a id="701" href="Cubical.Data.Nat.Base.html#172" class="Primitive Operator">_·_</a><a id="704" class="Symbol">)</a>
  <a id="708" class="Keyword">renaming</a> <a id="717" class="Symbol">(</a><a id="718" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+_</a> <a id="722" class="Symbol">to</a> <a id="725" class="Primitive Operator">_+ℕ_</a> <a id="730" class="Symbol">;</a> <a id="732" href="Cubical.Data.Nat.Properties.html#4359" class="Function">+-assoc</a> <a id="740" class="Symbol">to</a> <a id="743" class="Function">+Assocℕ</a><a id="750" class="Symbol">)</a>
<a id="752" class="Keyword">open</a> <a id="757" class="Keyword">import</a> <a id="764" href="Cubical.Data.Nat.Order.html" class="Module">Cubical.Data.Nat.Order</a>
<a id="787" class="Keyword">open</a> <a id="792" class="Keyword">import</a> <a id="799" href="Cubical.Data.Nat.Divisibility.html" class="Module">Cubical.Data.Nat.Divisibility</a>
  <a id="831" class="Keyword">using</a>    <a id="840" class="Symbol">(</a><a id="841" href="Cubical.Data.Nat.Divisibility.html#2622" class="Function">m∣n→m≤n</a><a id="848" class="Symbol">)</a>
  <a id="852" class="Keyword">renaming</a> <a id="861" class="Symbol">(</a><a id="862" href="Cubical.Data.Nat.Divisibility.html#1523" class="Function">∣-trans</a> <a id="870" class="Symbol">to</a> <a id="873" class="Function">∣ℕ-trans</a> <a id="882" class="Symbol">;</a> <a id="884" href="Cubical.Data.Nat.Divisibility.html#1466" class="Function">∣-refl</a> <a id="891" class="Symbol">to</a> <a id="894" class="Function">∣-reflℕ</a><a id="901" class="Symbol">)</a>
<a id="903" class="Keyword">open</a> <a id="908" class="Keyword">import</a> <a id="915" href="Cubical.Data.Int.html" class="Module">Cubical.Data.Int</a>
  <a id="934" class="Keyword">hiding</a>   <a id="943" class="Symbol">(</a><a id="944" href="Cubical.Data.Int.Base.html#1207" class="Function Operator">_+_</a> <a id="948" class="Symbol">;</a> <a id="950" href="Cubical.Data.Int.Base.html#1391" class="Function Operator">_·_</a> <a id="954" class="Symbol">;</a> <a id="956" href="Cubical.Data.Int.Base.html#1356" class="Function Operator">_-_</a> <a id="960" class="Symbol">;</a> <a id="962" href="Cubical.Data.Int.Base.html#1272" class="Function Operator">-_</a> <a id="965" class="Symbol">;</a> <a id="967" href="Cubical.Data.Int.Properties.html#23706" class="Function">addEq</a><a id="972" class="Symbol">)</a>
<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Cubical.Data.Int.Divisibility.html" class="Module">Cubical.Data.Int.Divisibility</a>
<a id="1016" class="Keyword">open</a> <a id="1021" class="Keyword">import</a> <a id="1028" href="Cubical.Data.FinData.html" class="Module">Cubical.Data.FinData</a>

<a id="1050" class="Keyword">open</a> <a id="1055" class="Keyword">import</a> <a id="1062" href="Cubical.Data.Empty.html" class="Module">Cubical.Data.Empty</a> <a id="1081" class="Symbol">as</a> <a id="1084" class="Module">Empty</a>
<a id="1090" class="Keyword">open</a> <a id="1095" class="Keyword">import</a> <a id="1102" href="Cubical.Data.Unit.html" class="Module">Cubical.Data.Unit</a>  <a id="1121" class="Symbol">as</a> <a id="1124" class="Module">Unit</a>
<a id="1129" class="Keyword">open</a> <a id="1134" class="Keyword">import</a> <a id="1141" href="Cubical.Data.Sum.html" class="Module">Cubical.Data.Sum</a>
<a id="1158" class="Keyword">open</a> <a id="1163" class="Keyword">import</a> <a id="1170" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a>

<a id="1220" class="Keyword">open</a> <a id="1225" class="Keyword">import</a> <a id="1232" href="Cubical.Algebra.Matrix.html" class="Module">Cubical.Algebra.Matrix</a>
<a id="1255" class="Keyword">open</a> <a id="1260" class="Keyword">import</a> <a id="1267" href="Cubical.Algebra.Matrix.CommRingCoefficient.html" class="Module">Cubical.Algebra.Matrix.CommRingCoefficient</a>
<a id="1310" class="Keyword">open</a> <a id="1315" class="Keyword">import</a> <a id="1322" href="Cubical.Algebra.Matrix.Elementaries.html" class="Module">Cubical.Algebra.Matrix.Elementaries</a>
<a id="1358" class="Keyword">open</a> <a id="1363" class="Keyword">import</a> <a id="1370" href="Cubical.Algebra.IntegerMatrix.Base.html" class="Module">Cubical.Algebra.IntegerMatrix.Base</a>
<a id="1405" class="Keyword">open</a> <a id="1410" class="Keyword">import</a> <a id="1417" href="Cubical.Algebra.IntegerMatrix.Elementaries.html" class="Module">Cubical.Algebra.IntegerMatrix.Elementaries</a>

<a id="1461" class="Keyword">open</a> <a id="1466" class="Keyword">import</a> <a id="1473" href="Cubical.Algebra.CommRing.html" class="Module">Cubical.Algebra.CommRing</a>
<a id="1498" class="Keyword">open</a> <a id="1503" class="Keyword">import</a> <a id="1510" href="Cubical.Algebra.CommRing.Instances.Int.html" class="Module">Cubical.Algebra.CommRing.Instances.Int</a>

<a id="1550" class="Keyword">open</a> <a id="1555" class="Keyword">import</a> <a id="1562" href="Cubical.Relation.Nullary.html" class="Module">Cubical.Relation.Nullary</a>
<a id="1587" class="Keyword">open</a> <a id="1592" class="Keyword">import</a> <a id="1599" href="Cubical.Induction.WellFounded.html" class="Module">Cubical.Induction.WellFounded</a>

<a id="1630" class="Keyword">private</a>
  <a id="1640" class="Keyword">variable</a>
    <a id="1653" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="1655" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a> <a id="1657" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1657" class="Generalizable">k</a> <a id="1659" class="Symbol">:</a> <a id="1661" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="1664" class="Keyword">open</a> <a id="1669" href="Cubical.Algebra.CommRing.Base.html#982" class="Module">CommRingStr</a>      <a id="1686" class="Symbol">(</a><a id="1687" href="Cubical.Algebra.CommRing.Instances.Int.html#292" class="Function">ℤCommRing</a> <a id="1697" class="Symbol">.</a><a id="1698" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a><a id="1701" class="Symbol">)</a>

<a id="1704" class="Keyword">open</a> <a id="1709" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#712" class="Module">Coefficient</a> <a id="1721" href="Cubical.Algebra.CommRing.Instances.Int.html#292" class="Function">ℤCommRing</a>
<a id="1731" class="Keyword">open</a> <a id="1736" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6647" class="Module">Sim</a>

<a id="1741" class="Keyword">open</a> <a id="1746" href="Cubical.Algebra.Matrix.Elementaries.html#803" class="Module">ElemTransformation</a> <a id="1765" href="Cubical.Algebra.CommRing.Instances.Int.html#292" class="Function">ℤCommRing</a>
<a id="1775" class="Keyword">open</a> <a id="1780" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#1103" class="Module">ElemTransformationℤ</a>
<a id="1800" class="Keyword">open</a> <a id="1805" href="Cubical.Algebra.Matrix.Elementaries.html#5435" class="Module">SwapPivot</a>
<a id="1815" class="Keyword">open</a> <a id="1820" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7712" class="Module">RowsImproved</a>
<a id="1833" class="Keyword">open</a> <a id="1838" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7975" class="Module">ColsImproved</a>

<a id="1852" class="Comment">-- Sequence of non-zero integers</a>

<a id="isNonZero"></a><a id="1886" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="1896" class="Symbol">:</a> <a id="1898" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1903" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a> <a id="1905" class="Symbol">→</a> <a id="1907" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1912" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="1922" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1925" class="Symbol">=</a> <a id="1927" href="Cubical.Data.Unit.Base.html#149" class="Record">Unit</a>
<a id="1932" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1943" class="Bound">x</a> <a id="1945" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1947" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1947" class="Bound">xs</a><a id="1949" class="Symbol">)</a> <a id="1951" class="Symbol">=</a> <a id="1953" class="Symbol">(</a><a id="1954" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="1956" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1943" class="Bound">x</a> <a id="1958" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="1960" class="Number">0</a><a id="1961" class="Symbol">)</a> <a id="1963" href="Cubical.Data.Sigma.Base.html#438" class="Function Operator">×</a> <a id="1965" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="1975" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1947" class="Bound">xs</a>

<a id="isPropIsNonZero"></a><a id="1979" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1979" class="Function">isPropIsNonZero</a> <a id="1995" class="Symbol">:</a> <a id="1997" class="Symbol">(</a><a id="1998" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1998" class="Bound">xs</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2008" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="2009" class="Symbol">)</a> <a id="2011" class="Symbol">→</a> <a id="2013" href="Cubical.Foundations.Prelude.html#15524" class="Function">isProp</a> <a id="2020" class="Symbol">(</a><a id="2021" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="2031" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1998" class="Bound">xs</a><a id="2033" class="Symbol">)</a>
<a id="2035" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1979" class="Function">isPropIsNonZero</a> <a id="2051" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2054" class="Symbol">=</a> <a id="2056" href="Cubical.Data.Unit.Properties.html#641" class="Function">isPropUnit</a>
<a id="2067" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1979" class="Function">isPropIsNonZero</a> <a id="2083" class="Symbol">(</a><a id="2084" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2084" class="Bound">x</a> <a id="2086" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2088" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2088" class="Bound">xs</a><a id="2090" class="Symbol">)</a> <a id="2092" class="Symbol">=</a> <a id="2094" href="Cubical.Foundations.HLevels.html#13835" class="Function">isProp×</a> <a id="2102" class="Symbol">(</a><a id="2103" href="Cubical.Foundations.HLevels.html#16883" class="Function">isPropΠ</a> <a id="2111" class="Symbol">(λ</a> <a id="2114" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2114" class="Bound">_</a> <a id="2116" class="Symbol">→</a> <a id="2118" href="Cubical.Data.Empty.Properties.html#205" class="Function">isProp⊥</a><a id="2125" class="Symbol">))</a> <a id="2128" class="Symbol">(</a><a id="2129" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1979" class="Function">isPropIsNonZero</a> <a id="2145" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2088" class="Bound">xs</a><a id="2147" class="Symbol">)</a>

<a id="NonZeroList"></a><a id="2150" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a> <a id="2162" class="Symbol">:</a> <a id="2164" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2169" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a> <a id="2181" class="Symbol">=</a> <a id="2183" href="Cubical.Core.Primitives.html#6245" class="Function">Σ[</a> <a id="2186" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2186" class="Bound">xs</a> <a id="2189" href="Cubical.Core.Primitives.html#6245" class="Function">∈</a> <a id="2191" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2196" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a> <a id="2198" href="Cubical.Core.Primitives.html#6245" class="Function">]</a> <a id="2200" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1886" class="Function">isNonZero</a> <a id="2210" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2186" class="Bound">xs</a>

<a id="cons"></a><a id="2214" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="2219" class="Symbol">:</a> <a id="2221" class="Symbol">(</a><a id="2222" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2222" class="Bound">n</a> <a id="2224" class="Symbol">:</a> <a id="2226" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="2227" class="Symbol">)(</a><a id="2229" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2229" class="Bound">xs</a> <a id="2232" class="Symbol">:</a> <a id="2234" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a><a id="2245" class="Symbol">)</a> <a id="2247" class="Symbol">→</a> <a id="2249" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="2251" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2222" class="Bound">n</a> <a id="2253" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="2255" class="Number">0</a> <a id="2257" class="Symbol">→</a> <a id="2259" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a>
<a id="2271" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="2276" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2276" class="Bound">n</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2279" class="Bound">xs</a> <a id="2282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2284" class="Symbol">_)</a> <a id="2287" class="Symbol">_</a> <a id="2289" class="Symbol">.</a><a id="2290" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="2294" class="Symbol">=</a> <a id="2296" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2276" class="Bound">n</a> <a id="2298" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2300" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2279" class="Bound">xs</a>
<a id="2303" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="2308" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2308" class="Bound">n</a> <a id="2310" class="Symbol">(</a><a id="2311" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2314" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2316" class="Symbol">_)</a> <a id="2319" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2319" class="Bound">p</a> <a id="2321" class="Symbol">.</a><a id="2322" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2326" class="Symbol">=</a> <a id="2328" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2319" class="Bound">p</a> <a id="2330" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2332" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="2335" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="2340" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2340" class="Bound">n</a> <a id="2342" class="Symbol">(</a><a id="2343" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2343" class="Bound">x</a> <a id="2345" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2347" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2347" class="Bound">xs</a> <a id="2350" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2352" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2352" class="Bound">q</a><a id="2353" class="Symbol">)</a> <a id="2355" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2355" class="Bound">p</a> <a id="2357" class="Symbol">.</a><a id="2358" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2355" class="Bound">p</a> <a id="2366" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2368" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2352" class="Bound">q</a>

<a id="2371" class="Comment">-- Smith normal matrix</a>

<a id="_+length_"></a><a id="2395" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">_+length_</a> <a id="2405" class="Symbol">:</a> <a id="2407" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a> <a id="2419" class="Symbol">→</a> <a id="2421" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2423" class="Symbol">→</a> <a id="2425" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2427" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2427" class="Bound">xs</a> <a id="2430" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">+length</a> <a id="2438" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2438" class="Bound">n</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Cubical.Data.List.Base.html#546" class="Function">length</a> <a id="2449" class="Symbol">(</a><a id="2450" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2427" class="Bound">xs</a> <a id="2453" class="Symbol">.</a><a id="2454" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2457" class="Symbol">)</a> <a id="2459" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#725" class="Primitive Operator">+ℕ</a> <a id="2462" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2438" class="Bound">n</a>

<a id="diagMat"></a><a id="2465" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2473" class="Symbol">:</a> <a id="2475" class="Symbol">(</a><a id="2476" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2476" class="Bound">xs</a> <a id="2479" class="Symbol">:</a> <a id="2481" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2486" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="2487" class="Symbol">)(</a><a id="2489" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2489" class="Bound">m</a> <a id="2491" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2491" class="Bound">n</a> <a id="2493" class="Symbol">:</a> <a id="2495" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2496" class="Symbol">)</a> <a id="2498" class="Symbol">→</a> <a id="2500" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="2504" class="Symbol">(</a><a id="2505" href="Cubical.Data.List.Base.html#546" class="Function">length</a> <a id="2512" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2476" class="Bound">xs</a> <a id="2515" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#725" class="Primitive Operator">+ℕ</a> <a id="2518" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2489" class="Bound">m</a><a id="2519" class="Symbol">)</a> <a id="2521" class="Symbol">(</a><a id="2522" href="Cubical.Data.List.Base.html#546" class="Function">length</a> <a id="2529" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2476" class="Bound">xs</a> <a id="2532" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#725" class="Primitive Operator">+ℕ</a> <a id="2535" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2491" class="Bound">n</a><a id="2536" class="Symbol">)</a>
<a id="2538" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2546" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2549" class="Symbol">_</a> <a id="2551" class="Symbol">_</a> <a id="2553" class="Symbol">=</a> <a id="2555" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a>
<a id="2557" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2565" class="Symbol">(</a><a id="2566" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2566" class="Bound">x</a> <a id="2568" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2570" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2570" class="Bound">xs</a><a id="2572" class="Symbol">)</a> <a id="2574" class="Symbol">_</a> <a id="2576" class="Symbol">_</a> <a id="2578" class="Symbol">=</a> <a id="2580" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2566" class="Bound">x</a> <a id="2582" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="2584" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2570" class="Bound">xs</a> <a id="2595" class="Symbol">_</a> <a id="2597" class="Symbol">_</a>

<a id="diagMat⊕"></a><a id="2600" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2600" class="Function">diagMat⊕</a> <a id="2609" class="Symbol">:</a>
    <a id="2615" class="Symbol">(</a><a id="2616" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2616" class="Bound">a</a> <a id="2618" class="Symbol">:</a> <a id="2620" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="2621" class="Symbol">)(</a><a id="2623" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2623" class="Bound">xs</a> <a id="2626" class="Symbol">:</a> <a id="2628" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a><a id="2639" class="Symbol">){</a><a id="2641" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2641" class="Bound">m</a> <a id="2643" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2643" class="Bound">n</a> <a id="2645" class="Symbol">:</a> <a id="2647" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2648" class="Symbol">}</a>
  <a id="2652" class="Symbol">→</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2655" class="Bound">p</a> <a id="2657" class="Symbol">:</a> <a id="2659" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="2661" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2616" class="Bound">a</a> <a id="2663" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="2665" class="Number">0</a><a id="2666" class="Symbol">)</a>
  <a id="2670" class="Symbol">→</a> <a id="2672" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2616" class="Bound">a</a> <a id="2674" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="2676" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2684" class="Symbol">(</a><a id="2685" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2623" class="Bound">xs</a> <a id="2688" class="Symbol">.</a><a id="2689" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2692" class="Symbol">)</a> <a id="2694" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2641" class="Bound">m</a> <a id="2696" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2643" class="Bound">n</a> <a id="2698" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="2700" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="2708" class="Symbol">(</a><a id="2709" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="2714" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2616" class="Bound">a</a> <a id="2716" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2623" class="Bound">xs</a> <a id="2719" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2655" class="Bound">p</a> <a id="2721" class="Symbol">.</a><a id="2722" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="2725" class="Symbol">)</a> <a id="2727" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2641" class="Bound">m</a> <a id="2729" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2643" class="Bound">n</a>
<a id="2731" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2600" class="Function">diagMat⊕</a> <a id="2740" class="Symbol">_</a> <a id="2742" class="Symbol">_</a> <a id="2744" class="Symbol">_</a> <a id="2746" class="Symbol">=</a> <a id="2748" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>

<a id="2754" class="Comment">-- Diagonal matrix with non-zero diagonal elements</a>
<a id="2805" class="Comment">-- Notice that we allow non-square matrices.</a>

<a id="2851" class="Keyword">record</a> <a id="isDiagonal"></a><a id="2858" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="2869" class="Symbol">(</a><a id="2870" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2870" class="Bound">M</a> <a id="2872" class="Symbol">:</a> <a id="2874" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="2878" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="2880" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="2881" class="Symbol">)</a> <a id="2883" class="Symbol">:</a> <a id="2885" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2890" class="Keyword">where</a>
  <a id="2898" class="Keyword">field</a>
    <a id="isDiagonal.divs"></a><a id="2908" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="2913" class="Symbol">:</a> <a id="2915" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2150" class="Function">NonZeroList</a>
    <a id="isDiagonal.rowNull"></a><a id="2931" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="2939" class="Symbol">:</a> <a id="2941" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="isDiagonal.colNull"></a><a id="2947" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="2955" class="Symbol">:</a> <a id="2957" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

    <a id="isDiagonal.rowEq"></a><a id="2964" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="2970" class="Symbol">:</a> <a id="2972" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="2977" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">+length</a> <a id="2985" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="2993" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="2995" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2878" class="Bound">m</a>
    <a id="isDiagonal.colEq"></a><a id="3001" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="3007" class="Symbol">:</a> <a id="3009" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3014" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">+length</a> <a id="3022" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="3030" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="3032" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2880" class="Bound">n</a>
    <a id="isDiagonal.matEq"></a><a id="3038" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="3044" class="Symbol">:</a> <a id="3046" href="Agda.Primitive.Cubical.html#2013" class="Postulate">PathP</a> <a id="3052" class="Symbol">(λ</a> <a id="3055" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3055" class="Bound">t</a> <a id="3057" class="Symbol">→</a> <a id="3059" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="3063" class="Symbol">(</a><a id="3064" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="3070" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3055" class="Bound">t</a><a id="3071" class="Symbol">)</a> <a id="3073" class="Symbol">(</a><a id="3074" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="3080" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3055" class="Bound">t</a><a id="3081" class="Symbol">))</a> <a id="3084" class="Symbol">(</a><a id="3085" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2465" class="Function">diagMat</a> <a id="3093" class="Symbol">(</a><a id="3094" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3099" class="Symbol">.</a><a id="3100" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="3103" class="Symbol">)</a> <a id="3105" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="3113" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a><a id="3120" class="Symbol">)</a> <a id="3122" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2870" class="Bound">M</a>

<a id="3125" class="Keyword">open</a> <a id="3130" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Module">isDiagonal</a>

<a id="row"></a><a id="3142" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3142" class="Function">row</a> <a id="col"></a><a id="3146" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3146" class="Function">col</a> <a id="3150" class="Symbol">:</a> <a id="3152" class="Symbol">{</a><a id="3153" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3153" class="Bound">M</a> <a id="3155" class="Symbol">:</a> <a id="3157" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="3161" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="3163" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="3164" class="Symbol">}</a> <a id="3166" class="Symbol">→</a> <a id="3168" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="3179" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3153" class="Bound">M</a> <a id="3181" class="Symbol">→</a> <a id="3183" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3185" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3142" class="Function">row</a> <a id="3189" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3189" class="Bound">isNorm</a> <a id="3196" class="Symbol">=</a> <a id="3198" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3189" class="Bound">isNorm</a> <a id="3205" class="Symbol">.</a><a id="3206" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3211" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">+length</a> <a id="3219" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3189" class="Bound">isNorm</a> <a id="3226" class="Symbol">.</a><a id="3227" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a>
<a id="3235" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3146" class="Function">col</a> <a id="3239" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3239" class="Bound">isNorm</a> <a id="3246" class="Symbol">=</a> <a id="3248" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3239" class="Bound">isNorm</a> <a id="3255" class="Symbol">.</a><a id="3256" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3261" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2395" class="Function Operator">+length</a> <a id="3269" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3239" class="Bound">isNorm</a> <a id="3276" class="Symbol">.</a><a id="3277" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a>

<a id="isDiagonal𝟘"></a><a id="3286" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3298" class="Symbol">:</a> <a id="3300" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="3311" class="Symbol">(</a><a id="3312" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a> <a id="3314" class="Symbol">{</a><a id="3315" class="Argument">m</a> <a id="3317" class="Symbol">=</a> <a id="3319" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="3320" class="Symbol">}</a> <a id="3322" class="Symbol">{</a><a id="3323" class="Argument">n</a> <a id="3325" class="Symbol">=</a> <a id="3327" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="3328" class="Symbol">})</a>
<a id="3331" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3343" class="Symbol">.</a><a id="3344" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3349" class="Symbol">=</a> <a id="3351" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3354" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3356" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="3359" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3371" class="Symbol">{</a><a id="3372" class="Argument">m</a> <a id="3374" class="Symbol">=</a> <a id="3376" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3376" class="Bound">m</a><a id="3377" class="Symbol">}</a> <a id="3379" class="Symbol">.</a><a id="3380" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="3388" class="Symbol">=</a> <a id="3390" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3376" class="Bound">m</a>
<a id="3392" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3404" class="Symbol">{</a><a id="3405" class="Argument">n</a> <a id="3407" class="Symbol">=</a> <a id="3409" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3409" class="Bound">n</a><a id="3410" class="Symbol">}</a> <a id="3412" class="Symbol">.</a><a id="3413" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="3421" class="Symbol">=</a> <a id="3423" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3409" class="Bound">n</a>
<a id="3425" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3437" class="Symbol">.</a><a id="3438" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="3444" class="Symbol">=</a> <a id="3446" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="3451" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3463" class="Symbol">.</a><a id="3464" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="3470" class="Symbol">=</a> <a id="3472" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="3477" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a> <a id="3489" class="Symbol">.</a><a id="3490" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="3496" class="Symbol">=</a> <a id="3498" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>

<a id="isDiagonalEmpty"></a><a id="3504" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3520" class="Symbol">:</a> <a id="3522" class="Symbol">(</a><a id="3523" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3523" class="Bound">M</a> <a id="3525" class="Symbol">:</a> <a id="3527" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="3531" class="Number">0</a> <a id="3533" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="3534" class="Symbol">)</a> <a id="3536" class="Symbol">→</a> <a id="3538" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="3549" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3523" class="Bound">M</a>
<a id="3551" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3567" class="Symbol">_</a> <a id="3569" class="Symbol">.</a><a id="3570" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3575" class="Symbol">=</a> <a id="3577" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3580" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3582" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="3585" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3601" class="Symbol">_</a> <a id="3603" class="Symbol">.</a><a id="3604" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="3612" class="Symbol">=</a> <a id="3614" class="Number">0</a>
<a id="3616" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3632" class="Symbol">{</a><a id="3633" class="Argument">n</a> <a id="3635" class="Symbol">=</a> <a id="3637" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3637" class="Bound">n</a><a id="3638" class="Symbol">}</a> <a id="3640" class="Symbol">_</a> <a id="3642" class="Symbol">.</a><a id="3643" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="3651" class="Symbol">=</a> <a id="3653" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3637" class="Bound">n</a>
<a id="3655" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3671" class="Symbol">_</a> <a id="3673" class="Symbol">.</a><a id="3674" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="3680" class="Symbol">=</a> <a id="3682" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="3687" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3703" class="Symbol">_</a> <a id="3705" class="Symbol">.</a><a id="3706" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="3712" class="Symbol">=</a> <a id="3714" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="3719" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="3735" class="Symbol">_</a> <a id="3737" class="Symbol">.</a><a id="3738" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="3744" class="Symbol">=</a> <a id="3746" href="Cubical.Foundations.Prelude.html#19748" class="Function">isContr→isProp</a> <a id="3761" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1093" class="Function">isContrEmpty</a> <a id="3774" class="Symbol">_</a> <a id="3776" class="Symbol">_</a>

<a id="isDiagonalEmptyᵗ"></a><a id="3779" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3796" class="Symbol">:</a> <a id="3798" class="Symbol">(</a><a id="3799" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3799" class="Bound">M</a> <a id="3801" class="Symbol">:</a> <a id="3803" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="3807" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="3809" class="Number">0</a><a id="3810" class="Symbol">)</a> <a id="3812" class="Symbol">→</a> <a id="3814" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="3825" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3799" class="Bound">M</a>
<a id="3827" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3844" class="Symbol">_</a> <a id="3846" class="Symbol">.</a><a id="3847" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="3852" class="Symbol">=</a> <a id="3854" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3857" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3859" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="3862" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3879" class="Symbol">{</a><a id="3880" class="Argument">m</a> <a id="3882" class="Symbol">=</a> <a id="3884" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3884" class="Bound">m</a><a id="3885" class="Symbol">}</a> <a id="3887" class="Symbol">_</a> <a id="3889" class="Symbol">.</a><a id="3890" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="3898" class="Symbol">=</a> <a id="3900" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3884" class="Bound">m</a>
<a id="3902" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3919" class="Symbol">_</a> <a id="3921" class="Symbol">.</a><a id="3922" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="3930" class="Symbol">=</a> <a id="3932" class="Number">0</a>
<a id="3934" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3951" class="Symbol">_</a> <a id="3953" class="Symbol">.</a><a id="3954" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="3960" class="Symbol">=</a> <a id="3962" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="3967" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="3984" class="Symbol">_</a> <a id="3986" class="Symbol">.</a><a id="3987" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="3993" class="Symbol">=</a> <a id="3995" href="Cubical.Foundations.Prelude.html#892" class="Function">refl</a>
<a id="4000" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="4017" class="Symbol">_</a> <a id="4019" class="Symbol">.</a><a id="4020" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="4026" class="Symbol">=</a> <a id="4028" href="Cubical.Foundations.Prelude.html#19748" class="Function">isContr→isProp</a> <a id="4043" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1245" class="Function">isContrEmptyᵗ</a> <a id="4057" class="Symbol">_</a> <a id="4059" class="Symbol">_</a>


<a id="4063" class="Comment">-- Induction step towards diagonalization</a>

<a id="4106" class="Keyword">data</a> <a id="DivStatus"></a><a id="4111" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4121" class="Symbol">(</a><a id="4122" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4124" class="Symbol">:</a> <a id="4126" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="4127" class="Symbol">)(</a><a id="4129" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a> <a id="4131" class="Symbol">:</a> <a id="4133" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4142" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="4143" class="Symbol">)</a> <a id="4145" class="Symbol">(</a><a id="4146" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4150" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="4151" class="Symbol">))</a> <a id="4154" class="Symbol">:</a> <a id="4156" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4161" class="Keyword">where</a>
  <a id="DivStatus.badCol"></a><a id="4169" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4169" class="InductiveConstructor">badCol</a>  <a id="4177" class="Symbol">:</a> <a id="4179" class="Symbol">(</a><a id="4180" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4180" class="Bound">i</a> <a id="4182" class="Symbol">:</a> <a id="4184" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="4188" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4142" class="Bound">m</a><a id="4189" class="Symbol">)(</a><a id="4191" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4191" class="Bound">p</a> <a id="4193" class="Symbol">:</a> <a id="4195" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="4197" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4199" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4201" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a> <a id="4203" class="Symbol">(</a><a id="4204" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4208" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4180" class="Bound">i</a><a id="4209" class="Symbol">)</a> <a id="4211" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a><a id="4215" class="Symbol">)</a> <a id="4217" class="Symbol">→</a> <a id="4219" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4229" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4231" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a>
  <a id="DivStatus.badRow"></a><a id="4235" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4235" class="InductiveConstructor">badRow</a>  <a id="4243" class="Symbol">:</a> <a id="4245" class="Symbol">(</a><a id="4246" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4246" class="Bound">j</a> <a id="4248" class="Symbol">:</a> <a id="4250" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="4254" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4150" class="Bound">n</a><a id="4255" class="Symbol">)(</a><a id="4257" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4257" class="Bound">p</a> <a id="4259" class="Symbol">:</a> <a id="4261" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="4263" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4265" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4267" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a> <a id="4269" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="4274" class="Symbol">(</a><a id="4275" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4279" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4246" class="Bound">j</a><a id="4280" class="Symbol">))</a> <a id="4283" class="Symbol">→</a> <a id="4285" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4295" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4297" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a>
  <a id="DivStatus.allDone"></a><a id="4301" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4301" class="InductiveConstructor">allDone</a> <a id="4309" class="Symbol">:</a> <a id="4311" class="Symbol">((</a><a id="4313" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4313" class="Bound">i</a> <a id="4315" class="Symbol">:</a> <a id="4317" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="4321" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4142" class="Bound">m</a><a id="4322" class="Symbol">)</a> <a id="4324" class="Symbol">→</a> <a id="4326" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4328" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4330" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a> <a id="4332" class="Symbol">(</a><a id="4333" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4337" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4313" class="Bound">i</a><a id="4338" class="Symbol">)</a> <a id="4340" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a><a id="4344" class="Symbol">)</a>
          <a id="4356" class="Symbol">→</a> <a id="4358" class="Symbol">((</a><a id="4360" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4360" class="Bound">j</a> <a id="4362" class="Symbol">:</a> <a id="4364" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="4368" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4150" class="Bound">n</a><a id="4369" class="Symbol">)</a> <a id="4371" class="Symbol">→</a> <a id="4373" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4375" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4377" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a> <a id="4379" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="4384" class="Symbol">(</a><a id="4385" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4389" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4360" class="Bound">j</a><a id="4390" class="Symbol">))</a> <a id="4393" class="Symbol">→</a> <a id="4395" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4405" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4122" class="Bound">a</a> <a id="4407" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4129" class="Bound">M</a>

<a id="divStatus"></a><a id="4410" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4410" class="Function">divStatus</a> <a id="4420" class="Symbol">:</a> <a id="4422" class="Symbol">(</a><a id="4423" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4423" class="Bound">a</a> <a id="4425" class="Symbol">:</a> <a id="4427" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="4428" class="Symbol">)(</a><a id="4430" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4430" class="Bound">M</a> <a id="4432" class="Symbol">:</a> <a id="4434" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="4438" class="Symbol">(</a><a id="4439" class="InductiveConstructor">suc</a> <a id="4443" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="4444" class="Symbol">)</a> <a id="4446" class="Symbol">(</a><a id="4447" class="InductiveConstructor">suc</a> <a id="4451" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="4452" class="Symbol">))</a> <a id="4455" class="Symbol">→</a> <a id="4457" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4467" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4423" class="Bound">a</a> <a id="4469" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4430" class="Bound">M</a>
<a id="4471" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4410" class="Function">divStatus</a> <a id="4481" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4481" class="Bound">a</a> <a id="4483" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4483" class="Bound">M</a> <a id="4485" class="Symbol">=</a>
  <a id="4489" class="Keyword">let</a>  <a id="4494" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4494" class="Bound">col?</a> <a id="4499" class="Symbol">=</a> <a id="4501" href="Cubical.Data.FinData.Properties.html#13086" class="Function">∀Dec</a> <a id="4506" class="Symbol">(λ</a> <a id="4509" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4509" class="Bound">i</a> <a id="4511" class="Symbol">→</a> <a id="4513" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4481" class="Bound">a</a> <a id="4515" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4517" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4483" class="Bound">M</a> <a id="4519" class="Symbol">(</a><a id="4520" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4524" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4509" class="Bound">i</a><a id="4525" class="Symbol">)</a> <a id="4527" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a><a id="4531" class="Symbol">)</a> <a id="4533" class="Symbol">(λ</a> <a id="4536" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4536" class="Bound">_</a> <a id="4538" class="Symbol">→</a> <a id="4540" href="Cubical.Data.Int.Divisibility.html#14066" class="Function">dec∣</a> <a id="4545" class="Symbol">_</a> <a id="4547" class="Symbol">_)</a>
       <a id="4557" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4557" class="Bound">row?</a> <a id="4562" class="Symbol">=</a> <a id="4564" href="Cubical.Data.FinData.Properties.html#13086" class="Function">∀Dec</a> <a id="4569" class="Symbol">(λ</a> <a id="4572" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4572" class="Bound">j</a> <a id="4574" class="Symbol">→</a> <a id="4576" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4481" class="Bound">a</a> <a id="4578" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="4580" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4483" class="Bound">M</a> <a id="4582" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="4587" class="Symbol">(</a><a id="4588" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4572" class="Bound">j</a><a id="4593" class="Symbol">))</a> <a id="4596" class="Symbol">(λ</a> <a id="4599" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4599" class="Bound">_</a> <a id="4601" class="Symbol">→</a> <a id="4603" href="Cubical.Data.Int.Divisibility.html#14066" class="Function">dec∣</a> <a id="4608" class="Symbol">_</a> <a id="4610" class="Symbol">_)</a> <a id="4613" class="Keyword">in</a>
  <a id="4618" href="Cubical.Foundations.Function.html#1796" class="Function Operator">case</a> <a id="4623" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4494" class="Bound">col?</a>
  <a id="4630" href="Cubical.Foundations.Function.html#1796" class="Function Operator">return</a> <a id="4637" class="Symbol">(λ</a> <a id="4640" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4640" class="Bound">_</a> <a id="4642" class="Symbol">→</a> <a id="4644" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4654" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4481" class="Bound">a</a> <a id="4656" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4483" class="Bound">M</a><a id="4657" class="Symbol">)</a> <a id="4659" href="Cubical.Foundations.Function.html#1796" class="Function Operator">of</a> <a id="4662" class="Symbol">λ</a>
  <a id="4666" class="Symbol">{</a> <a id="4668" class="Symbol">(</a><a id="4669" href="Cubical.Data.Sum.Base.html#260" class="InductiveConstructor">inr</a> <a id="4673" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4673" class="Bound">p</a><a id="4674" class="Symbol">)</a> <a id="4676" class="Symbol">→</a> <a id="4678" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4169" class="InductiveConstructor">badCol</a> <a id="4685" class="Symbol">(</a><a id="4686" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4673" class="Bound">p</a> <a id="4688" class="Symbol">.</a><a id="4689" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="4692" class="Symbol">)</a> <a id="4694" class="Symbol">(</a><a id="4695" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4673" class="Bound">p</a> <a id="4697" class="Symbol">.</a><a id="4698" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a><a id="4701" class="Symbol">)</a>
  <a id="4705" class="Symbol">;</a> <a id="4707" class="Symbol">(</a><a id="4708" href="Cubical.Data.Sum.Base.html#242" class="InductiveConstructor">inl</a> <a id="4712" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4712" class="Bound">p</a><a id="4713" class="Symbol">)</a> <a id="4715" class="Symbol">→</a>
      <a id="4723" href="Cubical.Foundations.Function.html#1796" class="Function Operator">case</a> <a id="4728" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4557" class="Bound">row?</a>
      <a id="4739" href="Cubical.Foundations.Function.html#1796" class="Function Operator">return</a> <a id="4746" class="Symbol">(λ</a> <a id="4749" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4749" class="Bound">_</a> <a id="4751" class="Symbol">→</a> <a id="4753" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="4763" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4481" class="Bound">a</a> <a id="4765" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4483" class="Bound">M</a><a id="4766" class="Symbol">)</a> <a id="4768" href="Cubical.Foundations.Function.html#1796" class="Function Operator">of</a> <a id="4771" class="Symbol">λ</a>
      <a id="4779" class="Symbol">{</a> <a id="4781" class="Symbol">(</a><a id="4782" href="Cubical.Data.Sum.Base.html#260" class="InductiveConstructor">inr</a> <a id="4786" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4786" class="Bound">q</a><a id="4787" class="Symbol">)</a> <a id="4789" class="Symbol">→</a> <a id="4791" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4235" class="InductiveConstructor">badRow</a> <a id="4798" class="Symbol">(</a><a id="4799" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4786" class="Bound">q</a> <a id="4801" class="Symbol">.</a><a id="4802" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a><a id="4805" class="Symbol">)</a> <a id="4807" class="Symbol">(</a><a id="4808" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4786" class="Bound">q</a> <a id="4810" class="Symbol">.</a><a id="4811" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a><a id="4814" class="Symbol">)</a>
      <a id="4822" class="Symbol">;</a> <a id="4824" class="Symbol">(</a><a id="4825" href="Cubical.Data.Sum.Base.html#242" class="InductiveConstructor">inl</a> <a id="4829" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4829" class="Bound">q</a><a id="4830" class="Symbol">)</a> <a id="4832" class="Symbol">→</a> <a id="4834" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4301" class="InductiveConstructor">allDone</a> <a id="4842" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4712" class="Bound">p</a> <a id="4844" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4829" class="Bound">q</a> <a id="4846" class="Symbol">}}</a>

<a id="4850" class="Keyword">record</a> <a id="DiagStep"></a><a id="4857" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="4866" class="Symbol">(</a><a id="4867" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4867" class="Bound">M</a> <a id="4869" class="Symbol">:</a> <a id="4871" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="4875" class="Symbol">(</a><a id="4876" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4880" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="4881" class="Symbol">)</a> <a id="4883" class="Symbol">(</a><a id="4884" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4888" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="4889" class="Symbol">))</a> <a id="4892" class="Symbol">:</a> <a id="4894" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4899" class="Keyword">where</a>
  <a id="4907" class="Keyword">field</a>
    <a id="DiagStep.sim"></a><a id="4917" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="4921" class="Symbol">:</a> <a id="4923" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6647" class="Record">Sim</a> <a id="4927" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4867" class="Bound">M</a>

    <a id="DiagStep.firstColClean"></a><a id="4934" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4934" class="Field">firstColClean</a> <a id="4948" class="Symbol">:</a> <a id="4950" class="Symbol">(</a><a id="4951" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4951" class="Bound">i</a> <a id="4953" class="Symbol">:</a> <a id="4955" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="4959" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4880" class="Bound">m</a><a id="4960" class="Symbol">)</a> <a id="4962" class="Symbol">→</a> <a id="4964" class="Field">sim</a> <a id="4968" class="Symbol">.</a><a id="4969" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="4976" class="Symbol">(</a><a id="4977" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="4981" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4951" class="Bound">i</a><a id="4982" class="Symbol">)</a> <a id="4984" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="4989" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="4991" class="Number">0</a>
    <a id="DiagStep.firstRowClean"></a><a id="4997" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4997" class="Field">firstRowClean</a> <a id="5011" class="Symbol">:</a> <a id="5013" class="Symbol">(</a><a id="5014" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5014" class="Bound">j</a> <a id="5016" class="Symbol">:</a> <a id="5018" href="Cubical.Data.FinData.Base.html#352" class="Datatype">Fin</a> <a id="5022" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4888" class="Bound">n</a><a id="5023" class="Symbol">)</a> <a id="5025" class="Symbol">→</a> <a id="5027" class="Field">sim</a> <a id="5031" class="Symbol">.</a><a id="5032" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="5039" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="5044" class="Symbol">(</a><a id="5045" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="5049" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5014" class="Bound">j</a><a id="5050" class="Symbol">)</a> <a id="5052" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="5054" class="Number">0</a>

    <a id="DiagStep.nonZero"></a><a id="5061" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5061" class="Field">nonZero</a> <a id="5069" class="Symbol">:</a> <a id="5071" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="5073" class="Field">sim</a> <a id="5077" class="Symbol">.</a><a id="5078" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="5085" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="5090" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="5095" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="5097" class="Number">0</a>

<a id="5100" class="Keyword">open</a> <a id="5105" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Module">DiagStep</a>

<a id="simDiagStep"></a><a id="5115" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5127" class="Symbol">:</a> <a id="5129" class="Symbol">{</a><a id="5130" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5130" class="Bound">M</a> <a id="5132" class="Symbol">:</a> <a id="5134" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="5138" class="Symbol">(</a><a id="5139" class="InductiveConstructor">suc</a> <a id="5143" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="5144" class="Symbol">)</a> <a id="5146" class="Symbol">(</a><a id="5147" class="InductiveConstructor">suc</a> <a id="5151" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="5152" class="Symbol">)}(</a><a id="5155" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5155" class="Bound">sim</a> <a id="5159" class="Symbol">:</a> <a id="5161" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6647" class="Record">Sim</a> <a id="5165" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5130" class="Bound">M</a><a id="5166" class="Symbol">)</a> <a id="5168" class="Symbol">→</a> <a id="5170" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="5179" class="Symbol">(</a><a id="5180" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5155" class="Bound">sim</a> <a id="5184" class="Symbol">.</a><a id="5185" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="5191" class="Symbol">)</a> <a id="5193" class="Symbol">→</a> <a id="5195" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="5204" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5130" class="Bound">M</a>
<a id="5206" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5218" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5218" class="Bound">simM</a> <a id="5223" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5223" class="Bound">diag</a> <a id="5228" class="Symbol">.</a><a id="5229" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="5233" class="Symbol">=</a> <a id="5235" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8264" class="Function">compSim</a> <a id="5243" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5218" class="Bound">simM</a> <a id="5248" class="Symbol">(</a><a id="5249" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5223" class="Bound">diag</a> <a id="5254" class="Symbol">.</a><a id="5255" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a><a id="5258" class="Symbol">)</a>
<a id="5260" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5272" class="Symbol">_</a>    <a id="5277" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5277" class="Bound">diag</a> <a id="5282" class="Symbol">.</a><a id="5283" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4934" class="Field">firstColClean</a> <a id="5297" class="Symbol">=</a> <a id="5299" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5277" class="Bound">diag</a> <a id="5304" class="Symbol">.</a><a id="5305" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4934" class="Field">firstColClean</a>
<a id="5319" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5331" class="Symbol">_</a>    <a id="5336" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5336" class="Bound">diag</a> <a id="5341" class="Symbol">.</a><a id="5342" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4997" class="Field">firstRowClean</a> <a id="5356" class="Symbol">=</a> <a id="5358" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5336" class="Bound">diag</a> <a id="5363" class="Symbol">.</a><a id="5364" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4997" class="Field">firstRowClean</a>
<a id="5378" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5390" class="Symbol">_</a>    <a id="5395" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5395" class="Bound">diag</a> <a id="5400" class="Symbol">.</a><a id="5401" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5061" class="Field">nonZero</a> <a id="5409" class="Symbol">=</a> <a id="5411" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5395" class="Bound">diag</a> <a id="5416" class="Symbol">.</a><a id="5417" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5061" class="Field">nonZero</a>

<a id="5426" class="Keyword">private</a>
  <a id="diagStep-helper"></a><a id="5436" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="5452" class="Symbol">:</a>
      <a id="5460" class="Symbol">(</a><a id="5461" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a> <a id="5463" class="Symbol">:</a> <a id="5465" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="5469" class="Symbol">(</a><a id="5470" class="InductiveConstructor">suc</a> <a id="5474" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="5475" class="Symbol">)</a> <a id="5477" class="Symbol">(</a><a id="5478" class="InductiveConstructor">suc</a> <a id="5482" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="5483" class="Symbol">))</a>
    <a id="5490" class="Symbol">→</a> <a id="5492" class="Symbol">(</a><a id="5493" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5493" class="Bound">p</a> <a id="5495" class="Symbol">:</a> <a id="5497" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="5499" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a> <a id="5501" class="InductiveConstructor">zero</a> <a id="5506" class="InductiveConstructor">zero</a> <a id="5511" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="5513" class="Number">0</a><a id="5514" class="Symbol">)(</a><a id="5516" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5516" class="Bound">h</a> <a id="5518" class="Symbol">:</a> <a id="5520" href="Cubical.Algebra.IntegerMatrix.Base.html#1131" class="Function">Norm</a> <a id="5525" class="Symbol">(</a><a id="5526" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a> <a id="5528" class="InductiveConstructor">zero</a> <a id="5533" class="InductiveConstructor">zero</a><a id="5537" class="Symbol">))</a>
    <a id="5544" class="Symbol">→</a> <a id="5546" class="Symbol">(</a><a id="5547" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5547" class="Bound">div?</a> <a id="5552" class="Symbol">:</a> <a id="5554" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4111" class="Datatype">DivStatus</a> <a id="5564" class="Symbol">(</a><a id="5565" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a> <a id="5567" class="InductiveConstructor">zero</a> <a id="5572" class="InductiveConstructor">zero</a><a id="5576" class="Symbol">)</a> <a id="5578" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a><a id="5579" class="Symbol">)</a>
    <a id="5585" class="Symbol">→</a> <a id="5587" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="5596" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5461" class="Bound">M</a>
  <a id="5600" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="5616" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5616" class="Bound">M</a> <a id="5618" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5618" class="Bound">p</a> <a id="5620" class="Symbol">(</a><a id="5621" href="Cubical.Induction.WellFounded.html#312" class="InductiveConstructor">acc</a> <a id="5625" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5625" class="Bound">ind</a><a id="5628" class="Symbol">)</a> <a id="5630" class="Symbol">(</a><a id="5631" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4169" class="InductiveConstructor">badCol</a> <a id="5638" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5638" class="Bound">i</a> <a id="5640" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5640" class="Bound">q</a><a id="5641" class="Symbol">)</a> <a id="5643" class="Symbol">=</a>
    <a id="5649" class="Keyword">let</a> <a id="5653" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">improved</a> <a id="5662" class="Symbol">=</a> <a id="5664" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8272" class="Function">improveRows</a> <a id="5676" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5616" class="Bound">M</a> <a id="5678" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5618" class="Bound">p</a>
        <a id="5688" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">normIneq</a> <a id="5697" class="Symbol">=</a>
          <a id="5709" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5625" class="Bound">ind</a> <a id="5713" class="Symbol">_</a> <a id="5715" class="Symbol">(</a><a id="5716" href="Cubical.Data.Int.Divisibility.html#5045" class="Function">stDivIneq</a> <a id="5726" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5618" class="Bound">p</a> <a id="5728" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5640" class="Bound">q</a> <a id="5730" class="Symbol">(</a><a id="5731" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">improved</a> <a id="5740" class="Symbol">.</a><a id="5741" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7799" class="Field">div</a> <a id="5745" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a><a id="5749" class="Symbol">)</a> <a id="5751" class="Symbol">(</a><a id="5752" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">improved</a> <a id="5761" class="Symbol">.</a><a id="5762" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7799" class="Field">div</a> <a id="5766" class="Symbol">(</a><a id="5767" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="5771" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5638" class="Bound">i</a><a id="5772" class="Symbol">)))</a>
    <a id="5780" class="Keyword">in</a>  <a id="5784" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="5796" class="Symbol">(</a><a id="5797" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">improved</a> <a id="5806" class="Symbol">.</a><a id="5807" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7780" class="Field">sim</a><a id="5810" class="Symbol">)</a>
                    <a id="5832" class="Symbol">(</a><a id="5833" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="5849" class="Symbol">_</a> <a id="5851" class="Symbol">(</a><a id="5852" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">improved</a> <a id="5861" class="Symbol">.</a><a id="5862" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7927" class="Field">nonZero</a><a id="5869" class="Symbol">)</a> <a id="5871" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">normIneq</a> <a id="5880" class="Symbol">(</a><a id="5881" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4410" class="Function">divStatus</a> <a id="5891" class="Symbol">_</a> <a id="5893" class="Symbol">_))</a>
  <a id="5899" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="5915" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5915" class="Bound">M</a> <a id="5917" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5917" class="Bound">p</a> <a id="5919" class="Symbol">(</a><a id="5920" href="Cubical.Induction.WellFounded.html#312" class="InductiveConstructor">acc</a> <a id="5924" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5924" class="Bound">ind</a><a id="5927" class="Symbol">)</a> <a id="5929" class="Symbol">(</a><a id="5930" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4235" class="InductiveConstructor">badRow</a> <a id="5937" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5937" class="Bound">j</a> <a id="5939" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5939" class="Bound">q</a><a id="5940" class="Symbol">)</a> <a id="5942" class="Symbol">=</a>
    <a id="5948" class="Keyword">let</a> <a id="5952" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">improved</a> <a id="5961" class="Symbol">=</a> <a id="5963" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8887" class="Function">improveCols</a> <a id="5975" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5915" class="Bound">M</a> <a id="5977" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5917" class="Bound">p</a>
        <a id="5987" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">normIneq</a> <a id="5996" class="Symbol">=</a>
          <a id="6008" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5924" class="Bound">ind</a> <a id="6012" class="Symbol">_</a> <a id="6014" class="Symbol">(</a><a id="6015" href="Cubical.Data.Int.Divisibility.html#5045" class="Function">stDivIneq</a> <a id="6025" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5917" class="Bound">p</a> <a id="6027" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5939" class="Bound">q</a> <a id="6029" class="Symbol">(</a><a id="6030" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">improved</a> <a id="6039" class="Symbol">.</a><a id="6040" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8062" class="Field">div</a> <a id="6044" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a><a id="6048" class="Symbol">)</a> <a id="6050" class="Symbol">(</a><a id="6051" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">improved</a> <a id="6060" class="Symbol">.</a><a id="6061" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8062" class="Field">div</a> <a id="6065" class="Symbol">(</a><a id="6066" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="6070" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5937" class="Bound">j</a><a id="6071" class="Symbol">)))</a>
    <a id="6079" class="Keyword">in</a>  <a id="6083" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="6095" class="Symbol">(</a><a id="6096" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">improved</a> <a id="6105" class="Symbol">.</a><a id="6106" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8043" class="Field">sim</a><a id="6109" class="Symbol">)</a>
                    <a id="6131" class="Symbol">(</a><a id="6132" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="6148" class="Symbol">_</a> <a id="6150" class="Symbol">(</a><a id="6151" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">improved</a> <a id="6160" class="Symbol">.</a><a id="6161" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8190" class="Field">nonZero</a><a id="6168" class="Symbol">)</a> <a id="6170" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">normIneq</a> <a id="6179" class="Symbol">(</a><a id="6180" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4410" class="Function">divStatus</a> <a id="6190" class="Symbol">_</a> <a id="6192" class="Symbol">_))</a>
  <a id="6198" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="6214" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6214" class="Bound">M</a> <a id="6216" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6216" class="Bound">p</a> <a id="6218" class="Symbol">(</a><a id="6219" href="Cubical.Induction.WellFounded.html#312" class="InductiveConstructor">acc</a> <a id="6223" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6223" class="Bound">ind</a><a id="6226" class="Symbol">)</a> <a id="6228" class="Symbol">(</a><a id="6229" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4301" class="InductiveConstructor">allDone</a> <a id="6237" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6237" class="Bound">div₁</a> <a id="6242" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6242" class="Bound">div₂</a><a id="6246" class="Symbol">)</a> <a id="6248" class="Symbol">=</a>
    <a id="6254" class="Keyword">let</a> <a id="6258" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6270" class="Symbol">=</a> <a id="6272" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8887" class="Function">improveCols</a> <a id="6284" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6214" class="Bound">M</a> <a id="6286" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6216" class="Bound">p</a>
        <a id="6296" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6296" class="Bound">invCol</a> <a id="6303" class="Symbol">=</a> <a id="6305" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#5053" class="Function">bézoutRows-inv</a> <a id="6320" class="Symbol">_</a> <a id="6322" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6216" class="Bound">p</a> <a id="6324" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6242" class="Bound">div₂</a>
        <a id="6337" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6337" class="Bound">divCol</a> <a id="6344" class="Symbol">=</a> <a id="6346" class="Symbol">(λ</a> <a id="6349" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6349" class="Bound">i</a> <a id="6351" class="Symbol">→</a> <a id="6353" href="Cubical.Foundations.Prelude.html#9674" class="Function">transport</a> <a id="6363" class="Symbol">(λ</a> <a id="6366" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6366" class="Bound">t</a> <a id="6368" class="Symbol">→</a> <a id="6370" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6296" class="Bound">invCol</a> <a id="6377" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6366" class="Bound">t</a> <a id="6379" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="6384" href="Cubical.Data.Int.Divisibility.html#1774" class="Function Operator">∣</a> <a id="6386" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6296" class="Bound">invCol</a> <a id="6393" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6366" class="Bound">t</a> <a id="6395" class="Symbol">(</a><a id="6396" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="6400" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6349" class="Bound">i</a><a id="6401" class="Symbol">))</a> <a id="6404" class="Symbol">(</a><a id="6405" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6237" class="Bound">div₁</a> <a id="6410" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6349" class="Bound">i</a><a id="6411" class="Symbol">))</a>
        <a id="6422" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6422" class="Bound">improveRowM</a> <a id="6434" class="Symbol">=</a> <a id="6436" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8272" class="Function">improveRows</a> <a id="6448" class="Symbol">(</a><a id="6449" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6461" class="Symbol">.</a><a id="6462" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8043" class="Field">sim</a> <a id="6466" class="Symbol">.</a><a id="6467" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="6473" class="Symbol">)</a> <a id="6475" class="Symbol">(</a><a id="6476" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6488" class="Symbol">.</a><a id="6489" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8190" class="Field">nonZero</a><a id="6496" class="Symbol">)</a>
        <a id="6506" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6506" class="Bound">invCol</a> <a id="6513" class="Symbol">=</a> <a id="6515" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#5053" class="Function">bézoutRows-inv</a> <a id="6530" class="Symbol">_</a> <a id="6532" class="Symbol">(</a><a id="6533" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6545" class="Symbol">.</a><a id="6546" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8190" class="Field">nonZero</a><a id="6553" class="Symbol">)</a> <a id="6555" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6337" class="Bound">divCol</a>
    <a id="6566" class="Keyword">in</a>  <a id="6570" class="Keyword">record</a>
        <a id="6585" class="Symbol">{</a> <a id="6587" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="6591" class="Symbol">=</a> <a id="6593" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8264" class="Function">compSim</a> <a id="6601" class="Symbol">(</a><a id="6602" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6614" class="Symbol">.</a><a id="6615" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8043" class="Field">sim</a><a id="6618" class="Symbol">)</a> <a id="6620" class="Symbol">(</a><a id="6621" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6422" class="Bound">improveRowM</a> <a id="6633" class="Symbol">.</a><a id="6634" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7780" class="Field">sim</a><a id="6637" class="Symbol">)</a>
        <a id="6647" class="Symbol">;</a> <a id="6649" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4934" class="Field">firstColClean</a> <a id="6663" class="Symbol">=</a> <a id="6665" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6422" class="Bound">improveRowM</a> <a id="6677" class="Symbol">.</a><a id="6678" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7868" class="Field">vanish</a>
        <a id="6693" class="Symbol">;</a> <a id="6695" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4997" class="Field">firstRowClean</a> <a id="6709" class="Symbol">=</a> <a id="6711" class="Symbol">(λ</a> <a id="6714" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6714" class="Bound">j</a> <a id="6716" class="Symbol">→</a> <a id="6718" class="Symbol">(λ</a> <a id="6721" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6721" class="Bound">t</a> <a id="6723" class="Symbol">→</a> <a id="6725" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6506" class="Bound">invCol</a> <a id="6732" class="Symbol">(</a><a id="6733" href="Cubical.Core.Primitives.html#478" class="Primitive Operator">~</a> <a id="6735" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6721" class="Bound">t</a><a id="6736" class="Symbol">)</a> <a id="6738" class="Symbol">(</a><a id="6739" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="6743" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6714" class="Bound">j</a><a id="6744" class="Symbol">))</a> <a id="6747" href="Cubical.Foundations.Prelude.html#5184" class="Function Operator">∙</a> <a id="6749" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">improveColM</a> <a id="6761" class="Symbol">.</a><a id="6762" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8131" class="Field">vanish</a> <a id="6769" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6714" class="Bound">j</a><a id="6770" class="Symbol">)</a>
        <a id="6780" class="Symbol">;</a> <a id="6782" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5061" class="Field">nonZero</a> <a id="6790" class="Symbol">=</a> <a id="6792" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6422" class="Bound">improveRowM</a> <a id="6804" class="Symbol">.</a><a id="6805" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7927" class="Field">nonZero</a> <a id="6813" class="Symbol">}</a>

  <a id="diagStep-getStart"></a><a id="6818" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6818" class="Function">diagStep-getStart</a> <a id="6836" class="Symbol">:</a> <a id="6838" class="Symbol">(</a><a id="6839" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6839" class="Bound">M</a> <a id="6841" class="Symbol">:</a> <a id="6843" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="6847" class="Symbol">(</a><a id="6848" class="InductiveConstructor">suc</a> <a id="6852" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="6853" class="Symbol">)</a> <a id="6855" class="Symbol">(</a><a id="6856" class="InductiveConstructor">suc</a> <a id="6860" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="6861" class="Symbol">))</a> <a id="6864" class="Symbol">→</a> <a id="6866" href="Cubical.Algebra.IntegerMatrix.Base.html#2737" class="Datatype">NonZeroOrNot</a> <a id="6879" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6839" class="Bound">M</a> <a id="6881" class="Symbol">→</a> <a id="6883" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="6892" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6839" class="Bound">M</a> <a id="6894" href="Cubical.Data.Sum.Base.html#184" class="Datatype Operator">⊎</a> <a id="6896" class="Symbol">(</a><a id="6897" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6839" class="Bound">M</a> <a id="6899" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="6901" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a><a id="6902" class="Symbol">)</a>
  <a id="6906" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6818" class="Function">diagStep-getStart</a> <a id="6924" class="Symbol">_</a> <a id="6926" class="Symbol">(</a><a id="6927" href="Cubical.Algebra.IntegerMatrix.Base.html#2872" class="InductiveConstructor">allZero</a> <a id="6935" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6935" class="Bound">p</a><a id="6936" class="Symbol">)</a> <a id="6938" class="Symbol">=</a> <a id="6940" href="Cubical.Data.Sum.Base.html#260" class="InductiveConstructor">inr</a> <a id="6944" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6935" class="Bound">p</a>
  <a id="6948" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6818" class="Function">diagStep-getStart</a> <a id="6966" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6966" class="Bound">M</a> <a id="6968" class="Symbol">(</a><a id="6969" href="Cubical.Algebra.IntegerMatrix.Base.html#2791" class="InductiveConstructor">hereIs</a> <a id="6976" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6976" class="Bound">i</a> <a id="6978" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6978" class="Bound">j</a> <a id="6980" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6980" class="Bound">p</a><a id="6981" class="Symbol">)</a> <a id="6983" class="Symbol">=</a>
    <a id="6989" class="Keyword">let</a> <a id="6993" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6993" class="Bound">swapM</a> <a id="6999" class="Symbol">=</a> <a id="7001" href="Cubical.Algebra.Matrix.Elementaries.html#6854" class="Function">swapPivot</a> <a id="7011" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6976" class="Bound">i</a> <a id="7013" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6978" class="Bound">j</a> <a id="7015" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6966" class="Bound">M</a>
        <a id="7025" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7025" class="Bound">swapNonZero</a> <a id="7037" class="Symbol">=</a> <a id="7039" class="Symbol">(λ</a> <a id="7042" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7042" class="Bound">r</a> <a id="7044" class="Symbol">→</a> <a id="7046" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6980" class="Bound">p</a> <a id="7048" class="Symbol">(</a><a id="7049" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6993" class="Bound">swapM</a> <a id="7055" class="Symbol">.</a><a id="7056" href="Cubical.Algebra.Matrix.Elementaries.html#5554" class="Field">swapEq</a> <a id="7063" href="Cubical.Foundations.Prelude.html#5184" class="Function Operator">∙</a> <a id="7065" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7042" class="Bound">r</a><a id="7066" class="Symbol">))</a>
        <a id="7077" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7077" class="Bound">diagM</a> <a id="7083" class="Symbol">=</a> <a id="7085" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5436" class="Function">diagStep-helper</a> <a id="7101" class="Symbol">_</a> <a id="7103" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7025" class="Bound">swapNonZero</a> <a id="7115" class="Symbol">(</a><a id="7116" href="Cubical.Data.Nat.Order.html#9881" class="Function">&lt;-wellfounded</a> <a id="7130" class="Symbol">_)</a> <a id="7133" class="Symbol">(</a><a id="7134" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4410" class="Function">divStatus</a> <a id="7144" class="Symbol">_</a> <a id="7146" class="Symbol">_)</a>
    <a id="7153" class="Keyword">in</a>  <a id="7157" href="Cubical.Data.Sum.Base.html#242" class="InductiveConstructor">inl</a> <a id="7161" class="Symbol">(</a><a id="7162" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5115" class="Function">simDiagStep</a> <a id="7174" class="Symbol">(</a><a id="7175" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6993" class="Bound">swapM</a> <a id="7181" class="Symbol">.</a><a id="7182" href="Cubical.Algebra.Matrix.Elementaries.html#5536" class="Field">sim</a><a id="7185" class="Symbol">)</a> <a id="7187" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7077" class="Bound">diagM</a><a id="7192" class="Symbol">)</a>

<a id="diagStep"></a><a id="7195" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7195" class="Function">diagStep</a> <a id="7204" class="Symbol">:</a> <a id="7206" class="Symbol">(</a><a id="7207" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7207" class="Bound">M</a> <a id="7209" class="Symbol">:</a> <a id="7211" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7215" class="Symbol">(</a><a id="7216" class="InductiveConstructor">suc</a> <a id="7220" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="7221" class="Symbol">)</a> <a id="7223" class="Symbol">(</a><a id="7224" class="InductiveConstructor">suc</a> <a id="7228" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7229" class="Symbol">))</a> <a id="7232" class="Symbol">→</a> <a id="7234" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="7243" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7207" class="Bound">M</a> <a id="7245" href="Cubical.Data.Sum.Base.html#184" class="Datatype Operator">⊎</a> <a id="7247" class="Symbol">(</a><a id="7248" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7207" class="Bound">M</a> <a id="7250" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="7252" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a><a id="7253" class="Symbol">)</a>
<a id="7255" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7195" class="Function">diagStep</a> <a id="7264" class="Symbol">_</a> <a id="7266" class="Symbol">=</a> <a id="7268" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6818" class="Function">diagStep-getStart</a> <a id="7286" class="Symbol">_</a> <a id="7288" class="Symbol">(</a><a id="7289" href="Cubical.Algebra.IntegerMatrix.Base.html#2906" class="Function">findNonZero</a> <a id="7301" class="Symbol">_)</a>


<a id="7306" class="Comment">-- The diagonalization</a>

<a id="7330" class="Keyword">record</a> <a id="Diag"></a><a id="7337" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7342" class="Symbol">(</a><a id="7343" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7343" class="Bound">M</a> <a id="7345" class="Symbol">:</a> <a id="7347" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7351" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="7353" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7354" class="Symbol">)</a> <a id="7356" class="Symbol">:</a> <a id="7358" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="7363" class="Keyword">where</a>
  <a id="7371" class="Keyword">field</a>
    <a id="Diag.sim"></a><a id="7381" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a> <a id="7385" class="Symbol">:</a> <a id="7387" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6647" class="Record">Sim</a> <a id="7391" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7343" class="Bound">M</a>
    <a id="Diag.isdiag"></a><a id="7397" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="7404" class="Symbol">:</a> <a id="7406" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="7417" class="Symbol">(</a><a id="7418" class="Field">sim</a> <a id="7422" class="Symbol">.</a><a id="7423" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="7429" class="Symbol">)</a>

<a id="7432" class="Keyword">open</a> <a id="7437" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Module">Diag</a>

<a id="simDiag"></a><a id="7443" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7443" class="Function">simDiag</a> <a id="7451" class="Symbol">:</a> <a id="7453" class="Symbol">{</a><a id="7454" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7454" class="Bound">M</a> <a id="7456" class="Symbol">:</a> <a id="7458" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7462" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="7464" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7465" class="Symbol">}(</a><a id="7467" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7467" class="Bound">sim</a> <a id="7471" class="Symbol">:</a> <a id="7473" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6647" class="Record">Sim</a> <a id="7477" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7454" class="Bound">M</a><a id="7478" class="Symbol">)</a> <a id="7480" class="Symbol">→</a> <a id="7482" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7487" class="Symbol">(</a><a id="7488" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7467" class="Bound">sim</a> <a id="7492" class="Symbol">.</a><a id="7493" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="7499" class="Symbol">)</a> <a id="7501" class="Symbol">→</a> <a id="7503" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7508" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7454" class="Bound">M</a>
<a id="7510" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7443" class="Function">simDiag</a> <a id="7518" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7518" class="Bound">simM</a> <a id="7523" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7523" class="Bound">diag</a> <a id="7528" class="Symbol">.</a><a id="7529" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a> <a id="7533" class="Symbol">=</a> <a id="7535" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8264" class="Function">compSim</a> <a id="7543" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7518" class="Bound">simM</a> <a id="7548" class="Symbol">(</a><a id="7549" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7523" class="Bound">diag</a> <a id="7554" class="Symbol">.</a><a id="7555" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a><a id="7558" class="Symbol">)</a>
<a id="7560" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7443" class="Function">simDiag</a> <a id="7568" class="Symbol">_</a> <a id="7570" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7570" class="Bound">diag</a> <a id="7575" class="Symbol">.</a><a id="7576" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="7583" class="Symbol">=</a> <a id="7585" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7570" class="Bound">diag</a> <a id="7590" class="Symbol">.</a><a id="7591" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a>

<a id="diag𝟘"></a><a id="7599" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7599" class="Function">diag𝟘</a> <a id="7605" class="Symbol">:</a> <a id="7607" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7612" class="Symbol">(</a><a id="7613" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a> <a id="7615" class="Symbol">{</a><a id="7616" class="Argument">m</a> <a id="7618" class="Symbol">=</a> <a id="7620" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="7621" class="Symbol">}</a> <a id="7623" class="Symbol">{</a><a id="7624" class="Argument">n</a> <a id="7626" class="Symbol">=</a> <a id="7628" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7629" class="Symbol">})</a>
<a id="7632" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7599" class="Function">diag𝟘</a> <a id="7638" class="Symbol">.</a><a id="7639" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a>    <a id="7646" class="Symbol">=</a> <a id="7648" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6990" class="Function">idSim</a> <a id="7654" class="Symbol">_</a>
<a id="7656" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7599" class="Function">diag𝟘</a> <a id="7662" class="Symbol">.</a><a id="7663" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="7670" class="Symbol">=</a> <a id="7672" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3286" class="Function">isDiagonal𝟘</a>

<a id="diagEmpty"></a><a id="7685" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7685" class="Function">diagEmpty</a> <a id="7695" class="Symbol">:</a> <a id="7697" class="Symbol">(</a><a id="7698" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7698" class="Bound">M</a> <a id="7700" class="Symbol">:</a> <a id="7702" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7706" class="Number">0</a> <a id="7708" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7709" class="Symbol">)</a> <a id="7711" class="Symbol">→</a> <a id="7713" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7718" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7698" class="Bound">M</a>
<a id="7720" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7685" class="Function">diagEmpty</a> <a id="7730" class="Symbol">_</a> <a id="7732" class="Symbol">.</a><a id="7733" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a>    <a id="7740" class="Symbol">=</a> <a id="7742" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6990" class="Function">idSim</a> <a id="7748" class="Symbol">_</a>
<a id="7750" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7685" class="Function">diagEmpty</a> <a id="7760" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7760" class="Bound">M</a> <a id="7762" class="Symbol">.</a><a id="7763" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="7770" class="Symbol">=</a> <a id="7772" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3504" class="Function">isDiagonalEmpty</a> <a id="7788" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7760" class="Bound">M</a>

<a id="diagEmptyᵗ"></a><a id="7791" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7791" class="Function">diagEmptyᵗ</a> <a id="7802" class="Symbol">:</a> <a id="7804" class="Symbol">(</a><a id="7805" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7805" class="Bound">M</a> <a id="7807" class="Symbol">:</a> <a id="7809" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7813" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="7815" class="Number">0</a><a id="7816" class="Symbol">)</a> <a id="7818" class="Symbol">→</a> <a id="7820" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="7825" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7805" class="Bound">M</a>
<a id="7827" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7791" class="Function">diagEmptyᵗ</a> <a id="7838" class="Symbol">_</a> <a id="7840" class="Symbol">.</a><a id="7841" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a>    <a id="7848" class="Symbol">=</a> <a id="7850" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6990" class="Function">idSim</a> <a id="7856" class="Symbol">_</a>
<a id="7858" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7791" class="Function">diagEmptyᵗ</a> <a id="7869" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7869" class="Bound">M</a> <a id="7871" class="Symbol">.</a><a id="7872" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="7879" class="Symbol">=</a> <a id="7881" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3779" class="Function">isDiagonalEmptyᵗ</a> <a id="7898" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7869" class="Bound">M</a>

<a id="decompDiagStep"></a><a id="7901" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="7916" class="Symbol">:</a>
    <a id="7922" class="Symbol">(</a><a id="7923" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7923" class="Bound">M</a> <a id="7925" class="Symbol">:</a> <a id="7927" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="7931" class="Symbol">(</a><a id="7932" class="InductiveConstructor">suc</a> <a id="7936" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a><a id="7937" class="Symbol">)</a> <a id="7939" class="Symbol">(</a><a id="7940" class="InductiveConstructor">suc</a> <a id="7944" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="7945" class="Symbol">))(</a><a id="7948" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7948" class="Bound">step</a> <a id="7953" class="Symbol">:</a> <a id="7955" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="7964" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7923" class="Bound">M</a><a id="7965" class="Symbol">)</a>
  <a id="7969" class="Symbol">→</a> <a id="7971" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7948" class="Bound">step</a> <a id="7976" class="Symbol">.</a><a id="7977" class="Field">sim</a> <a id="7981" class="Symbol">.</a><a id="7982" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="7989" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="7991" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7948" class="Bound">step</a> <a id="7996" class="Symbol">.</a><a id="7997" class="Field">sim</a> <a id="8001" class="Symbol">.</a><a id="8002" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="8009" class="InductiveConstructor">zero</a> <a id="8014" class="InductiveConstructor">zero</a> <a id="8019" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="8021" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8654" class="Function">sucMat</a> <a id="8028" class="Symbol">(</a><a id="8029" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7948" class="Bound">step</a> <a id="8034" class="Symbol">.</a><a id="8035" class="Field">sim</a> <a id="8039" class="Symbol">.</a><a id="8040" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="8046" class="Symbol">)</a>
<a id="8048" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="8063" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8063" class="Bound">M</a> <a id="8065" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8065" class="Bound">step</a> <a id="8070" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8070" class="Bound">t</a> <a id="8072" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="8077" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="8082" class="Symbol">=</a> <a id="8084" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8065" class="Bound">step</a> <a id="8089" class="Symbol">.</a><a id="8090" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="8094" class="Symbol">.</a><a id="8095" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="8102" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="8107" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a>
<a id="8112" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="8127" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8127" class="Bound">M</a> <a id="8129" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8129" class="Bound">step</a> <a id="8134" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8134" class="Bound">t</a> <a id="8136" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="8141" class="Symbol">(</a><a id="8142" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8146" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8146" class="Bound">j</a><a id="8147" class="Symbol">)</a> <a id="8149" class="Symbol">=</a> <a id="8151" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8129" class="Bound">step</a> <a id="8156" class="Symbol">.</a><a id="8157" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4997" class="Field">firstRowClean</a> <a id="8171" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8146" class="Bound">j</a> <a id="8173" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8134" class="Bound">t</a>
<a id="8175" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="8190" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8190" class="Bound">M</a> <a id="8192" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8192" class="Bound">step</a> <a id="8197" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8197" class="Bound">t</a> <a id="8199" class="Symbol">(</a><a id="8200" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8204" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8204" class="Bound">i</a><a id="8205" class="Symbol">)</a> <a id="8207" href="Cubical.Data.FinData.Base.html#376" class="InductiveConstructor">zero</a> <a id="8212" class="Symbol">=</a> <a id="8214" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8192" class="Bound">step</a> <a id="8219" class="Symbol">.</a><a id="8220" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4934" class="Field">firstColClean</a> <a id="8234" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8204" class="Bound">i</a> <a id="8236" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8197" class="Bound">t</a>
<a id="8238" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="8253" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8253" class="Bound">M</a> <a id="8255" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8255" class="Bound">step</a> <a id="8260" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8260" class="Bound">t</a> <a id="8262" class="Symbol">(</a><a id="8263" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8267" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8267" class="Bound">i</a><a id="8268" class="Symbol">)</a> <a id="8270" class="Symbol">(</a><a id="8271" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8275" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8275" class="Bound">j</a><a id="8276" class="Symbol">)</a> <a id="8278" class="Symbol">=</a> <a id="8280" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8255" class="Bound">step</a> <a id="8285" class="Symbol">.</a><a id="8286" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="8290" class="Symbol">.</a><a id="8291" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a> <a id="8298" class="Symbol">(</a><a id="8299" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8303" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8267" class="Bound">i</a><a id="8304" class="Symbol">)</a> <a id="8306" class="Symbol">(</a><a id="8307" href="Cubical.Data.FinData.Base.html#407" class="InductiveConstructor">suc</a> <a id="8311" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8275" class="Bound">j</a><a id="8312" class="Symbol">)</a>

<a id="consIsDiagonal"></a><a id="8315" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8330" class="Symbol">:</a>
    <a id="8336" class="Symbol">(</a><a id="8337" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8337" class="Bound">a</a> <a id="8339" class="Symbol">:</a> <a id="8341" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="8342" class="Symbol">)(</a><a id="8344" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8344" class="Bound">M</a> <a id="8346" class="Symbol">:</a> <a id="8348" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="8352" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="8354" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="8355" class="Symbol">)</a>
  <a id="8359" class="Symbol">→</a> <a id="8361" class="Symbol">(</a><a id="8362" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8362" class="Bound">p</a> <a id="8364" class="Symbol">:</a> <a id="8366" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="8368" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8337" class="Bound">a</a> <a id="8370" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="8372" class="Number">0</a><a id="8373" class="Symbol">)</a>
  <a id="8377" class="Symbol">→</a> <a id="8379" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="8390" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8344" class="Bound">M</a> <a id="8392" class="Symbol">→</a> <a id="8394" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2858" class="Record">isDiagonal</a> <a id="8405" class="Symbol">(</a><a id="8406" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8337" class="Bound">a</a> <a id="8408" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="8410" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8344" class="Bound">M</a><a id="8411" class="Symbol">)</a>
<a id="8413" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8428" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8428" class="Bound">a</a> <a id="8430" class="Symbol">_</a> <a id="8432" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8432" class="Bound">p</a> <a id="8434" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8434" class="Bound">diag</a> <a id="8439" class="Symbol">.</a><a id="8440" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a> <a id="8445" class="Symbol">=</a> <a id="8447" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2214" class="Function">cons</a> <a id="8452" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8428" class="Bound">a</a> <a id="8454" class="Symbol">(</a><a id="8455" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8434" class="Bound">diag</a> <a id="8460" class="Symbol">.</a><a id="8461" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2908" class="Field">divs</a><a id="8465" class="Symbol">)</a> <a id="8467" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8432" class="Bound">p</a>
<a id="8469" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8484" class="Symbol">_</a> <a id="8486" class="Symbol">_</a> <a id="8488" class="Symbol">_</a> <a id="8490" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8490" class="Bound">diag</a> <a id="8495" class="Symbol">.</a><a id="8496" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a> <a id="8504" class="Symbol">=</a> <a id="8506" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8490" class="Bound">diag</a> <a id="8511" class="Symbol">.</a><a id="8512" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2931" class="Field">rowNull</a>
<a id="8520" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8535" class="Symbol">_</a> <a id="8537" class="Symbol">_</a> <a id="8539" class="Symbol">_</a> <a id="8541" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8541" class="Bound">diag</a> <a id="8546" class="Symbol">.</a><a id="8547" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a> <a id="8555" class="Symbol">=</a> <a id="8557" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8541" class="Bound">diag</a> <a id="8562" class="Symbol">.</a><a id="8563" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2947" class="Field">colNull</a>
<a id="8571" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8586" class="Symbol">_</a> <a id="8588" class="Symbol">_</a> <a id="8590" class="Symbol">_</a> <a id="8592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8592" class="Bound">diag</a> <a id="8597" class="Symbol">.</a><a id="8598" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="8604" class="Symbol">=</a> <a id="8606" class="Symbol">(λ</a> <a id="8609" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8609" class="Bound">t</a> <a id="8611" class="Symbol">→</a> <a id="8613" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8617" class="Symbol">(</a><a id="8618" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8592" class="Bound">diag</a> <a id="8623" class="Symbol">.</a><a id="8624" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2964" class="Field">rowEq</a> <a id="8630" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8609" class="Bound">t</a><a id="8631" class="Symbol">))</a>
<a id="8634" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8649" class="Symbol">_</a> <a id="8651" class="Symbol">_</a> <a id="8653" class="Symbol">_</a> <a id="8655" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8655" class="Bound">diag</a> <a id="8660" class="Symbol">.</a><a id="8661" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="8667" class="Symbol">=</a> <a id="8669" class="Symbol">(λ</a> <a id="8672" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8672" class="Bound">t</a> <a id="8674" class="Symbol">→</a> <a id="8676" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8680" class="Symbol">(</a><a id="8681" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8655" class="Bound">diag</a> <a id="8686" class="Symbol">.</a><a id="8687" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3001" class="Field">colEq</a> <a id="8693" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8672" class="Bound">t</a><a id="8694" class="Symbol">))</a>
<a id="8697" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8712" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8712" class="Bound">a</a> <a id="8714" class="Symbol">_</a> <a id="8716" class="Symbol">_</a> <a id="8718" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8718" class="Bound">diag</a> <a id="8723" class="Symbol">.</a><a id="8724" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="8730" class="Symbol">=</a> <a id="8732" class="Symbol">(λ</a> <a id="8735" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8735" class="Bound">t</a> <a id="8737" class="Symbol">→</a> <a id="8739" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8712" class="Bound">a</a> <a id="8741" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="8743" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8718" class="Bound">diag</a> <a id="8748" class="Symbol">.</a><a id="8749" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3038" class="Field">matEq</a> <a id="8755" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8735" class="Bound">t</a><a id="8756" class="Symbol">)</a>

<a id="diagReduction"></a><a id="8759" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8759" class="Function">diagReduction</a> <a id="8773" class="Symbol">:</a>
    <a id="8779" class="Symbol">(</a><a id="8780" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8780" class="Bound">a</a> <a id="8782" class="Symbol">:</a> <a id="8784" href="Cubical.Data.Int.Base.html#419" class="Datatype">ℤ</a><a id="8785" class="Symbol">)(</a><a id="8787" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8787" class="Bound">M</a> <a id="8789" class="Symbol">:</a> <a id="8791" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="8795" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="8797" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="8798" class="Symbol">)</a>
  <a id="8802" class="Symbol">→</a> <a id="8804" class="Symbol">(</a><a id="8805" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8805" class="Bound">p</a> <a id="8807" class="Symbol">:</a> <a id="8809" href="Cubical.Relation.Nullary.Base.html#332" class="Function Operator">¬</a> <a id="8811" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8780" class="Bound">a</a> <a id="8813" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="8815" class="Number">0</a><a id="8816" class="Symbol">)</a>
  <a id="8820" class="Symbol">→</a> <a id="8822" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="8827" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8787" class="Bound">M</a> <a id="8829" class="Symbol">→</a> <a id="8831" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="8836" class="Symbol">(</a><a id="8837" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8780" class="Bound">a</a> <a id="8839" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8469" class="Function Operator">⊕</a> <a id="8841" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8787" class="Bound">M</a><a id="8842" class="Symbol">)</a>
<a id="8844" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8759" class="Function">diagReduction</a> <a id="8858" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8858" class="Bound">a</a> <a id="8860" class="Symbol">_</a> <a id="8862" class="Symbol">_</a> <a id="8864" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8864" class="Bound">diag</a> <a id="8869" class="Symbol">.</a><a id="8870" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a> <a id="8874" class="Symbol">=</a> <a id="8876" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#10602" class="Function">⊕Sim</a> <a id="8881" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8858" class="Bound">a</a> <a id="8883" class="Symbol">(</a><a id="8884" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8864" class="Bound">diag</a> <a id="8889" class="Symbol">.</a><a id="8890" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7381" class="Field">sim</a><a id="8893" class="Symbol">)</a>
<a id="8895" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8759" class="Function">diagReduction</a> <a id="8909" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8909" class="Bound">a</a> <a id="8911" class="Symbol">_</a> <a id="8913" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8913" class="Bound">p</a> <a id="8915" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8915" class="Bound">diag</a> <a id="8920" class="Symbol">.</a><a id="8921" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a> <a id="8928" class="Symbol">=</a> <a id="8930" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8315" class="Function">consIsDiagonal</a> <a id="8945" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8909" class="Bound">a</a> <a id="8947" class="Symbol">_</a> <a id="8949" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8913" class="Bound">p</a> <a id="8951" class="Symbol">(</a><a id="8952" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8915" class="Bound">diag</a> <a id="8957" class="Symbol">.</a><a id="8958" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7397" class="Field">isdiag</a><a id="8964" class="Symbol">)</a>


<a id="8968" class="Comment">-- The Existence of Diagonalization</a>

<a id="diagonalize"></a><a id="9005" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9005" class="Function">diagonalize</a> <a id="9017" class="Symbol">:</a> <a id="9019" class="Symbol">(</a><a id="9020" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9020" class="Bound">M</a> <a id="9022" class="Symbol">:</a> <a id="9024" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#969" class="Function">Mat</a> <a id="9028" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1653" class="Generalizable">m</a> <a id="9030" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1655" class="Generalizable">n</a><a id="9031" class="Symbol">)</a> <a id="9033" class="Symbol">→</a> <a id="9035" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="9040" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9020" class="Bound">M</a>
<a id="9042" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9005" class="Function">diagonalize</a> <a id="9054" class="Symbol">{</a><a id="9055" class="Argument">m</a> <a id="9057" class="Symbol">=</a> <a id="9059" class="Number">0</a><a id="9060" class="Symbol">}</a> <a id="9062" class="Symbol">=</a> <a id="9064" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7685" class="Function">diagEmpty</a>
<a id="9074" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9005" class="Function">diagonalize</a> <a id="9086" class="Symbol">{</a><a id="9087" class="Argument">m</a> <a id="9089" class="Symbol">=</a> <a id="9091" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="9095" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9095" class="Bound">m</a><a id="9096" class="Symbol">}</a> <a id="9098" class="Symbol">{</a><a id="9099" class="Argument">n</a> <a id="9101" class="Symbol">=</a> <a id="9103" class="Number">0</a><a id="9104" class="Symbol">}</a> <a id="9106" class="Symbol">=</a> <a id="9108" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7791" class="Function">diagEmptyᵗ</a>
<a id="9119" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9005" class="Function">diagonalize</a> <a id="9131" class="Symbol">{</a><a id="9132" class="Argument">m</a> <a id="9134" class="Symbol">=</a> <a id="9136" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="9140" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9140" class="Bound">m</a><a id="9141" class="Symbol">}</a> <a id="9143" class="Symbol">{</a><a id="9144" class="Argument">n</a> <a id="9146" class="Symbol">=</a> <a id="9148" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="9152" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9152" class="Bound">n</a><a id="9153" class="Symbol">}</a> <a id="9155" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9155" class="Bound">M</a> <a id="9157" class="Symbol">=</a> <a id="9159" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9189" class="Function">helper</a> <a id="9166" class="Symbol">(</a><a id="9167" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7195" class="Function">diagStep</a> <a id="9176" class="Symbol">_)</a>
  <a id="9181" class="Keyword">where</a>
  <a id="9189" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9189" class="Function">helper</a> <a id="9196" class="Symbol">:</a> <a id="9198" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4857" class="Record">DiagStep</a> <a id="9207" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9155" class="Bound">M</a> <a id="9209" href="Cubical.Data.Sum.Base.html#184" class="Datatype Operator">⊎</a> <a id="9211" class="Symbol">(</a><a id="9212" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9155" class="Bound">M</a> <a id="9214" href="Agda.Builtin.Cubical.Path.html#272" class="Function Operator">≡</a> <a id="9216" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1452" class="Function">𝟘</a><a id="9217" class="Symbol">)</a> <a id="9219" class="Symbol">→</a> <a id="9221" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="9226" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9155" class="Bound">M</a>
  <a id="9230" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9189" class="Function">helper</a> <a id="9237" class="Symbol">(</a><a id="9238" href="Cubical.Data.Sum.Base.html#260" class="InductiveConstructor">inr</a> <a id="9242" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9242" class="Bound">p</a><a id="9243" class="Symbol">)</a> <a id="9245" class="Symbol">=</a> <a id="9247" href="Cubical.Foundations.Prelude.html#10205" class="Function">subst</a> <a id="9253" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7337" class="Record">Diag</a> <a id="9258" class="Symbol">(</a><a id="9259" href="Cubical.Foundations.Prelude.html#945" class="Function">sym</a> <a id="9263" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9242" class="Bound">p</a><a id="9264" class="Symbol">)</a> <a id="9266" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7599" class="Function">diag𝟘</a>
  <a id="9274" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9189" class="Function">helper</a> <a id="9281" class="Symbol">(</a><a id="9282" href="Cubical.Data.Sum.Base.html#242" class="InductiveConstructor">inl</a> <a id="9286" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9286" class="Bound">stepM</a><a id="9291" class="Symbol">)</a> <a id="9293" class="Symbol">=</a>
    <a id="9299" class="Keyword">let</a> <a id="9303" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9303" class="Bound">sucM</a> <a id="9308" class="Symbol">=</a> <a id="9310" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8654" class="Function">sucMat</a> <a id="9317" class="Symbol">(</a><a id="9318" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9286" class="Bound">stepM</a> <a id="9324" class="Symbol">.</a><a id="9325" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a> <a id="9329" class="Symbol">.</a><a id="9330" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6696" class="Field">result</a><a id="9336" class="Symbol">)</a>
        <a id="9346" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9346" class="Bound">diagM</a> <a id="9352" class="Symbol">=</a> <a id="9354" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8759" class="Function">diagReduction</a> <a id="9368" class="Symbol">_</a> <a id="9370" class="Symbol">_</a> <a id="9372" class="Symbol">(</a><a id="9373" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9286" class="Bound">stepM</a> <a id="9379" class="Symbol">.</a><a id="9380" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5061" class="Field">nonZero</a><a id="9387" class="Symbol">)</a> <a id="9389" class="Symbol">(</a><a id="9390" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9005" class="Function">diagonalize</a> <a id="9402" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9303" class="Bound">sucM</a><a id="9406" class="Symbol">)</a>
    <a id="9412" class="Keyword">in</a>  <a id="9416" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7443" class="Function">simDiag</a> <a id="9424" class="Symbol">(</a><a id="9425" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8264" class="Function">compSim</a> <a id="9433" class="Symbol">(</a><a id="9434" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9286" class="Bound">stepM</a> <a id="9440" class="Symbol">.</a><a id="9441" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4917" class="Field">sim</a><a id="9444" class="Symbol">)</a> <a id="9446" class="Symbol">(</a><a id="9447" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#7327" class="Function">≡Sim</a> <a id="9452" class="Symbol">(</a><a id="9453" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7901" class="Function">decompDiagStep</a> <a id="9468" class="Symbol">_</a> <a id="9470" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9286" class="Bound">stepM</a><a id="9475" class="Symbol">)))</a> <a id="9479" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9346" class="Bound">diagM</a>
</pre></body></html>